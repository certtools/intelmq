<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Isn't it sad to see all public and private feeds available and not use them
properly because it's too much " monkey&quot; work? thanks to intelmq you can collect and process all of them automatically and without effort. &quot;><meta name=author content=Gethvi><link href=https://docs.intelmq.org/develop/user/bots/ rel=canonical><link href=../event/ rel=prev><link href=../feeds/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.33"><title>Bots - IntelMQ</title><link rel=stylesheet href=../../assets/stylesheets/main.3cba04c6.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#bots-inventory class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest version. <a href=../../.. style="color: black"> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=IntelMQ class="md-header__button md-logo" aria-label=IntelMQ data-md-component=logo> <img src=../../static/images/Logo_Intel_MQ.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> IntelMQ </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Bots </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=white data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/certtools/intelmq title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> certtools/intelmq </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=IntelMQ class="md-nav__button md-logo" aria-label=IntelMQ data-md-component=logo> <img src=../../static/images/Logo_Intel_MQ.svg alt=logo> </a> IntelMQ </label> <div class=md-nav__source> <a href=https://github.com/certtools/intelmq title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> certtools/intelmq </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/intelmq-manager/ class=md-nav__link> <span class=md-ellipsis> Using IntelMQ Manager </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../intro/ class=md-nav__link> <span class=md-ellipsis> Intro </span> </a> </li> <li class=md-nav__item> <a href=../event/ class=md-nav__link> <span class=md-ellipsis> Event </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Bots </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Bots </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#individual-bot-configuration class=md-nav__link> <span class=md-ellipsis> Individual Bot Configuration </span> </a> </li> <li class=md-nav__item> <a href=#generic-parameters class=md-nav__link> <span class=md-ellipsis> Generic Parameters </span> </a> <nav class=md-nav aria-label="Generic Parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#id class=md-nav__link> <span class=md-ellipsis> id </span> </a> </li> <li class=md-nav__item> <a href=#name class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> <li class=md-nav__item> <a href=#description class=md-nav__link> <span class=md-ellipsis> description </span> </a> </li> <li class=md-nav__item> <a href=#module class=md-nav__link> <span class=md-ellipsis> module </span> </a> </li> <li class=md-nav__item> <a href=#group class=md-nav__link> <span class=md-ellipsis> group </span> </a> </li> <li class=md-nav__item> <a href=#enabled class=md-nav__link> <span class=md-ellipsis> enabled </span> </a> </li> <li class=md-nav__item> <a href=#run_mode class=md-nav__link> <span class=md-ellipsis> run_mode </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#http-parameters class=md-nav__link> <span class=md-ellipsis> HTTP Parameters </span> </a> <nav class=md-nav aria-label="HTTP Parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#http_timeout_sec class=md-nav__link> <span class=md-ellipsis> http_timeout_sec </span> </a> </li> <li class=md-nav__item> <a href=#http_timeout_max_tries class=md-nav__link> <span class=md-ellipsis> http_timeout_max_tries </span> </a> </li> <li class=md-nav__item> <a href=#http_username class=md-nav__link> <span class=md-ellipsis> http_username </span> </a> </li> <li class=md-nav__item> <a href=#http_password class=md-nav__link> <span class=md-ellipsis> http_password </span> </a> </li> <li class=md-nav__item> <a href=#http_proxy class=md-nav__link> <span class=md-ellipsis> http_proxy </span> </a> </li> <li class=md-nav__item> <a href=#https_proxy class=md-nav__link> <span class=md-ellipsis> https_proxy </span> </a> </li> <li class=md-nav__item> <a href=#http_user_agent class=md-nav__link> <span class=md-ellipsis> http_user_agent </span> </a> </li> <li class=md-nav__item> <a href=#http_verify_cert class=md-nav__link> <span class=md-ellipsis> http_verify_cert </span> </a> </li> <li class=md-nav__item> <a href=#ssl_client_certificate class=md-nav__link> <span class=md-ellipsis> ssl_client_certificate </span> </a> </li> <li class=md-nav__item> <a href=#ssl_ca_certificate class=md-nav__link> <span class=md-ellipsis> ssl_ca_certificate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cache-parameters class=md-nav__link> <span class=md-ellipsis> Cache Parameters </span> </a> <nav class=md-nav aria-label="Cache Parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#redis_cache_host class=md-nav__link> <span class=md-ellipsis> redis_cache_host </span> </a> </li> <li class=md-nav__item> <a href=#redis_cache_port class=md-nav__link> <span class=md-ellipsis> redis_cache_port </span> </a> </li> <li class=md-nav__item> <a href=#redis_cache_db class=md-nav__link> <span class=md-ellipsis> redis_cache_db </span> </a> </li> <li class=md-nav__item> <a href=#redis_cache_ttl class=md-nav__link> <span class=md-ellipsis> redis_cache_ttl </span> </a> </li> <li class=md-nav__item> <a href=#redis_cache_password class=md-nav__link> <span class=md-ellipsis> redis_cache_password </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#collector-bots class=md-nav__link> <span class=md-ellipsis> Collector Bots </span> </a> <nav class=md-nav aria-label="Collector Bots"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#feed-parameters class=md-nav__link> <span class=md-ellipsis> Feed Parameters </span> </a> <nav class=md-nav aria-label="Feed Parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#name_1 class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> <li class=md-nav__item> <a href=#accuracy class=md-nav__link> <span class=md-ellipsis> accuracy </span> </a> </li> <li class=md-nav__item> <a href=#code class=md-nav__link> <span class=md-ellipsis> code </span> </a> </li> <li class=md-nav__item> <a href=#documentation class=md-nav__link> <span class=md-ellipsis> documentation </span> </a> </li> <li class=md-nav__item> <a href=#provider class=md-nav__link> <span class=md-ellipsis> provider </span> </a> </li> <li class=md-nav__item> <a href=#rate_limit class=md-nav__link> <span class=md-ellipsis> rate_limit </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#alien-vault-otx class=md-nav__link> <span class=md-ellipsis> Alien Vault OTX </span> </a> </li> <li class=md-nav__item> <a href=#amqp class=md-nav__link> <span class=md-ellipsis> AMQP </span> </a> </li> <li class=md-nav__item> <a href=#api class=md-nav__link> <span class=md-ellipsis> API </span> </a> </li> <li class=md-nav__item> <a href=#generic-url-fetcher class=md-nav__link> <span class=md-ellipsis> Generic URL Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#generic-url-stream-fetcher class=md-nav__link> <span class=md-ellipsis> Generic URL Stream Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#generic-mail-url-fetcher class=md-nav__link> <span class=md-ellipsis> Generic Mail URL Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#generic-mail-attachment-fetcher class=md-nav__link> <span class=md-ellipsis> Generic Mail Attachment Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#generic-mail-body-fetcher class=md-nav__link> <span class=md-ellipsis> Generic Mail Body Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#github-api class=md-nav__link> <span class=md-ellipsis> Github API </span> </a> </li> <li class=md-nav__item> <a href=#file class=md-nav__link> <span class=md-ellipsis> File </span> </a> </li> <li class=md-nav__item> <a href=#fireeye class=md-nav__link> <span class=md-ellipsis> FireEye </span> </a> </li> <li class=md-nav__item> <a href=#kafka class=md-nav__link> <span class=md-ellipsis> Kafka </span> </a> </li> <li class=md-nav__item> <a href=#misp-generic class=md-nav__link> <span class=md-ellipsis> MISP Generic </span> </a> </li> <li class=md-nav__item> <a href=#request-tracker class=md-nav__link> <span class=md-ellipsis> Request Tracker </span> </a> </li> <li class=md-nav__item> <a href=#rsync class=md-nav__link> <span class=md-ellipsis> Rsync </span> </a> </li> <li class=md-nav__item> <a href=#shadowserver-reports-api class=md-nav__link> <span class=md-ellipsis> Shadowserver Reports API </span> </a> </li> <li class=md-nav__item> <a href=#shodan-stream class=md-nav__link> <span class=md-ellipsis> Shodan Stream </span> </a> </li> <li class=md-nav__item> <a href=#tcp class=md-nav__link> <span class=md-ellipsis> TCP </span> </a> </li> <li class=md-nav__item> <a href=#blueliv-crimeserver class=md-nav__link> <span class=md-ellipsis> Blueliv Crimeserver </span> </a> </li> <li class=md-nav__item> <a href=#calidog-certstream class=md-nav__link> <span class=md-ellipsis> Calidog Certstream </span> </a> </li> <li class=md-nav__item> <a href=#eset-eti class=md-nav__link> <span class=md-ellipsis> ESET ETI </span> </a> </li> <li class=md-nav__item> <a href=#mcafee-opendxl class=md-nav__link> <span class=md-ellipsis> McAfee openDXL </span> </a> </li> <li class=md-nav__item> <a href=#microsoft-azure class=md-nav__link> <span class=md-ellipsis> Microsoft Azure </span> </a> </li> <li class=md-nav__item> <a href=#microsoft-interflow class=md-nav__link> <span class=md-ellipsis> Microsoft Interflow </span> </a> </li> <li class=md-nav__item> <a href=#stomp class=md-nav__link> <span class=md-ellipsis> STOMP </span> </a> </li> <li class=md-nav__item> <a href=#twitter-remove class=md-nav__link> <span class=md-ellipsis> Twitter (REMOVE?) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#parser-bots class=md-nav__link> <span class=md-ellipsis> Parser Bots </span> </a> <nav class=md-nav aria-label="Parser Bots"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-parameters class=md-nav__link> <span class=md-ellipsis> Common parameters </span> </a> <nav class=md-nav aria-label="Common parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default_fields class=md-nav__link> <span class=md-ellipsis> default_fields </span> </a> </li> <li class=md-nav__item> <a href=#copy_collector_provided_fields class=md-nav__link> <span class=md-ellipsis> copy_collector_provided_fields </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#abusech-feodo-tracker class=md-nav__link> <span class=md-ellipsis> Abuse.ch Feodo Tracker </span> </a> </li> <li class=md-nav__item> <a href=#alienvault-api class=md-nav__link> <span class=md-ellipsis> AlienVault API </span> </a> </li> <li class=md-nav__item> <a href=#alienvault-otx class=md-nav__link> <span class=md-ellipsis> AlienVault OTX </span> </a> </li> <li class=md-nav__item> <a href=#anubisnetworks-cyberfeed-stream class=md-nav__link> <span class=md-ellipsis> AnubisNetworks Cyberfeed Stream </span> </a> </li> <li class=md-nav__item> <a href=#bambenek class=md-nav__link> <span class=md-ellipsis> Bambenek </span> </a> </li> <li class=md-nav__item> <a href=#blocklistde class=md-nav__link> <span class=md-ellipsis> Blocklist.de </span> </a> </li> <li class=md-nav__item> <a href=#blueliv-crimeserver_1 class=md-nav__link> <span class=md-ellipsis> Blueliv Crimeserver </span> </a> </li> <li class=md-nav__item> <a href=#calidog-certstream_1 class=md-nav__link> <span class=md-ellipsis> Calidog Certstream </span> </a> </li> <li class=md-nav__item> <a href=#cert-eu class=md-nav__link> <span class=md-ellipsis> CERT-EU </span> </a> </li> <li class=md-nav__item> <a href=#ci-army class=md-nav__link> <span class=md-ellipsis> CI Army </span> </a> </li> <li class=md-nav__item> <a href=#cleanmx class=md-nav__link> <span class=md-ellipsis> CleanMX </span> </a> </li> <li class=md-nav__item> <a href=#team-cymru-cap class=md-nav__link> <span class=md-ellipsis> Team Cymru CAP </span> </a> </li> <li class=md-nav__item> <a href=#team-cymru-full-bogons class=md-nav__link> <span class=md-ellipsis> Team Cymru Full Bogons </span> </a> </li> <li class=md-nav__item> <a href=#cznic-haas class=md-nav__link> <span class=md-ellipsis> CZ.NIC HaaS </span> </a> </li> <li class=md-nav__item> <a href=#cznic-proki class=md-nav__link> <span class=md-ellipsis> CZ.NIC PROKI </span> </a> </li> <li class=md-nav__item> <a href=#danger-rulez class=md-nav__link> <span class=md-ellipsis> Danger Rulez </span> </a> </li> <li class=md-nav__item> <a href=#dataplane class=md-nav__link> <span class=md-ellipsis> Dataplane </span> </a> </li> <li class=md-nav__item> <a href=#dshield-asn class=md-nav__link> <span class=md-ellipsis> DShield ASN </span> </a> </li> <li class=md-nav__item> <a href=#dshield-block class=md-nav__link> <span class=md-ellipsis> DShield Block </span> </a> </li> <li class=md-nav__item> <a href=#eset class=md-nav__link> <span class=md-ellipsis> ESET </span> </a> </li> <li class=md-nav__item> <a href=#dyn-todo class=md-nav__link> <span class=md-ellipsis> Dyn (TODO) </span> </a> </li> <li class=md-nav__item> <a href=#fireeye_1 class=md-nav__link> <span class=md-ellipsis> FireEye </span> </a> </li> <li class=md-nav__item> <a href=#fraunhofer-dga class=md-nav__link> <span class=md-ellipsis> Fraunhofer DGA </span> </a> </li> <li class=md-nav__item> <a href=#generic-csv class=md-nav__link> <span class=md-ellipsis> Generic CSV </span> </a> </li> <li class=md-nav__item> <a href=#github-feed class=md-nav__link> <span class=md-ellipsis> Github Feed </span> </a> </li> <li class=md-nav__item> <a href=#have-i-been-pwned-callback class=md-nav__link> <span class=md-ellipsis> Have I Been Pwned Callback </span> </a> </li> <li class=md-nav__item> <a href=#html-table class=md-nav__link> <span class=md-ellipsis> HTML Table </span> </a> </li> <li class=md-nav__item> <a href=#json-todo class=md-nav__link> <span class=md-ellipsis> JSON (TODO) </span> </a> </li> <li class=md-nav__item> <a href=#keyvalue-parser class=md-nav__link> <span class=md-ellipsis> Key=Value Parser </span> </a> </li> <li class=md-nav__item> <a href=#malwarepatrol class=md-nav__link> <span class=md-ellipsis> MalwarePatrol </span> </a> </li> <li class=md-nav__item> <a href=#malwareurl class=md-nav__link> <span class=md-ellipsis> MalwareURL </span> </a> </li> <li class=md-nav__item> <a href=#mcafee-advanced-threat-defense-file class=md-nav__link> <span class=md-ellipsis> McAfee Advanced Threat Defense File </span> </a> </li> <li class=md-nav__item> <a href=#microsoft-ctip class=md-nav__link> <span class=md-ellipsis> Microsoft CTIP </span> </a> </li> <li class=md-nav__item> <a href=#misp class=md-nav__link> <span class=md-ellipsis> MISP </span> </a> </li> <li class=md-nav__item> <a href=#n6 class=md-nav__link> <span class=md-ellipsis> N6 </span> </a> </li> <li class=md-nav__item> <a href=#openphish-free class=md-nav__link> <span class=md-ellipsis> OpenPhish Free </span> </a> </li> <li class=md-nav__item> <a href=#openphish-premium class=md-nav__link> <span class=md-ellipsis> OpenPhish Premium </span> </a> </li> <li class=md-nav__item> <a href=#phishtank class=md-nav__link> <span class=md-ellipsis> Phishtank </span> </a> </li> <li class=md-nav__item> <a href=#shadowserver class=md-nav__link> <span class=md-ellipsis> Shadowserver </span> </a> </li> <li class=md-nav__item> <a href=#shodan class=md-nav__link> <span class=md-ellipsis> Shodan </span> </a> </li> <li class=md-nav__item> <a href=#spamhaus-drop class=md-nav__link> <span class=md-ellipsis> Spamhaus DROP </span> </a> </li> <li class=md-nav__item> <a href=#spamhaus-cert class=md-nav__link> <span class=md-ellipsis> Spamhaus CERT </span> </a> </li> <li class=md-nav__item> <a href=#surbl class=md-nav__link> <span class=md-ellipsis> Surbl </span> </a> </li> <li class=md-nav__item> <a href=#threatminer class=md-nav__link> <span class=md-ellipsis> Threatminer </span> </a> </li> <li class=md-nav__item> <a href=#turris class=md-nav__link> <span class=md-ellipsis> Turris </span> </a> </li> <li class=md-nav__item> <a href=#twitter class=md-nav__link> <span class=md-ellipsis> Twitter </span> </a> </li> <li class=md-nav__item> <a href=#vxvault class=md-nav__link> <span class=md-ellipsis> VxVault </span> </a> </li> <li class=md-nav__item> <a href=#zoneh class=md-nav__link> <span class=md-ellipsis> ZoneH </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#expert-bots class=md-nav__link> <span class=md-ellipsis> Expert Bots </span> </a> <nav class=md-nav aria-label="Expert Bots"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#abusix class=md-nav__link> <span class=md-ellipsis> Abusix </span> </a> </li> <li class=md-nav__item> <a href=#aggregate class=md-nav__link> <span class=md-ellipsis> Aggregate </span> </a> </li> <li class=md-nav__item> <a href=#asn-lookup class=md-nav__link> <span class=md-ellipsis> ASN Lookup </span> </a> </li> <li class=md-nav__item> <a href=#csv-converter class=md-nav__link> <span class=md-ellipsis> CSV Converter </span> </a> </li> <li class=md-nav__item> <a href=#team-cymru-whois class=md-nav__link> <span class=md-ellipsis> Team Cymru Whois </span> </a> </li> <li class=md-nav__item> <a href=#remove-affix class=md-nav__link> <span class=md-ellipsis> Remove Affix </span> </a> </li> <li class=md-nav__item> <a href=#domain-suffix class=md-nav__link> <span class=md-ellipsis> Domain Suffix </span> </a> </li> <li class=md-nav__item> <a href=#domain-valid class=md-nav__link> <span class=md-ellipsis> Domain Valid </span> </a> </li> <li class=md-nav__item> <a href=#deduplicator class=md-nav__link> <span class=md-ellipsis> Deduplicator </span> </a> </li> <li class=md-nav__item> <a href=#do-portal class=md-nav__link> <span class=md-ellipsis> DO Portal </span> </a> </li> <li class=md-nav__item> <a href=#field-reducer class=md-nav__link> <span class=md-ellipsis> Field Reducer </span> </a> </li> <li class=md-nav__item> <a href=#filter class=md-nav__link> <span class=md-ellipsis> Filter </span> </a> </li> <li class=md-nav__item> <a href=#format-field class=md-nav__link> <span class=md-ellipsis> Format Field </span> </a> </li> <li class=md-nav__item> <a href=#generic-db-lookup class=md-nav__link> <span class=md-ellipsis> Generic DB Lookup </span> </a> </li> <li class=md-nav__item> <a href=#gethostbyname class=md-nav__link> <span class=md-ellipsis> Gethostbyname </span> </a> </li> <li class=md-nav__item> <a href=#http-status class=md-nav__link> <span class=md-ellipsis> HTTP Status </span> </a> </li> <li class=md-nav__item> <a href=#http-content class=md-nav__link> <span class=md-ellipsis> HTTP Content </span> </a> </li> <li class=md-nav__item> <a href=#idea-converter class=md-nav__link> <span class=md-ellipsis> IDEA Converter </span> </a> </li> <li class=md-nav__item> <a href=#jinja2-template class=md-nav__link> <span class=md-ellipsis> Jinja2 Template </span> </a> </li> <li class=md-nav__item> <a href=#lookyloo class=md-nav__link> <span class=md-ellipsis> Lookyloo </span> </a> </li> <li class=md-nav__item> <a href=#maxmind-geoip class=md-nav__link> <span class=md-ellipsis> MaxMind GeoIP </span> </a> </li> <li class=md-nav__item> <a href=#misp_1 class=md-nav__link> <span class=md-ellipsis> MISP </span> </a> </li> <li class=md-nav__item> <a href=#mcafee-active-response-lookup class=md-nav__link> <span class=md-ellipsis> McAfee Active Response Lookup </span> </a> </li> <li class=md-nav__item> <a href=#modify class=md-nav__link> <span class=md-ellipsis> Modify </span> </a> </li> <li class=md-nav__item> <a href=#national-cert-contact-lookup-by-certat class=md-nav__link> <span class=md-ellipsis> National CERT Contact Lookup by CERT.AT </span> </a> </li> <li class=md-nav__item> <a href=#rdap class=md-nav__link> <span class=md-ellipsis> RDAP </span> </a> </li> <li class=md-nav__item> <a href=#recordedfuture-ip-risk class=md-nav__link> <span class=md-ellipsis> RecordedFuture IP Risk </span> </a> </li> <li class=md-nav__item> <a href=#reverse-dns class=md-nav__link> <span class=md-ellipsis> Reverse DNS </span> </a> </li> <li class=md-nav__item> <a href=#rfc1918 class=md-nav__link> <span class=md-ellipsis> RFC1918 </span> </a> </li> <li class=md-nav__item> <a href=#ripe class=md-nav__link> <span class=md-ellipsis> RIPE </span> </a> </li> <li class=md-nav__item> <a href=#sieve class=md-nav__link> <span class=md-ellipsis> Sieve </span> </a> </li> <li class=md-nav__item> <a href=#splunk-saved-search-lookup class=md-nav__link> <span class=md-ellipsis> Splunk Saved Search Lookup </span> </a> </li> <li class=md-nav__item> <a href=#taxonomy class=md-nav__link> <span class=md-ellipsis> Taxonomy </span> </a> </li> <li class=md-nav__item> <a href=#threshold class=md-nav__link> <span class=md-ellipsis> Threshold </span> </a> </li> <li class=md-nav__item> <a href=#tor-exit-node class=md-nav__link> <span class=md-ellipsis> Tor Exit Node </span> </a> </li> <li class=md-nav__item> <a href=#trusted-introducer-lookup class=md-nav__link> <span class=md-ellipsis> Trusted Introducer Lookup </span> </a> </li> <li class=md-nav__item> <a href=#tuency class=md-nav__link> <span class=md-ellipsis> Tuency </span> </a> </li> <li class=md-nav__item> <a href=#truncate-by-delimiter class=md-nav__link> <span class=md-ellipsis> Truncate By Delimiter </span> </a> </li> <li class=md-nav__item> <a href=#url class=md-nav__link> <span class=md-ellipsis> URL </span> </a> </li> <li class=md-nav__item> <a href=#url2fqdn class=md-nav__link> <span class=md-ellipsis> Url2FQDN </span> </a> </li> <li class=md-nav__item> <a href=#uwhoisd class=md-nav__link> <span class=md-ellipsis> uWhoisd </span> </a> </li> <li class=md-nav__item> <a href=#wait class=md-nav__link> <span class=md-ellipsis> Wait </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#output-bots class=md-nav__link> <span class=md-ellipsis> Output Bots </span> </a> <nav class=md-nav aria-label="Output Bots"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#amqp-topic class=md-nav__link> <span class=md-ellipsis> AMQP Topic </span> </a> </li> <li class=md-nav__item> <a href=#blackhole class=md-nav__link> <span class=md-ellipsis> Blackhole </span> </a> </li> <li class=md-nav__item> <a href=#bro-file class=md-nav__link> <span class=md-ellipsis> Bro File </span> </a> </li> <li class=md-nav__item> <a href=#cifv3-api class=md-nav__link> <span class=md-ellipsis> CIFv3 API </span> </a> </li> <li class=md-nav__item> <a href=#elasticsearch class=md-nav__link> <span class=md-ellipsis> Elasticsearch </span> </a> </li> <li class=md-nav__item> <a href=#file_1 class=md-nav__link> <span class=md-ellipsis> File </span> </a> </li> <li class=md-nav__item> <a href=#files class=md-nav__link> <span class=md-ellipsis> Files </span> </a> </li> <li class=md-nav__item> <a href=#mcafee-enterprise-security-manager class=md-nav__link> <span class=md-ellipsis> McAfee Enterprise Security Manager </span> </a> </li> <li class=md-nav__item> <a href=#misp-feed class=md-nav__link> <span class=md-ellipsis> MISP Feed </span> </a> </li> <li class=md-nav__item> <a href=#misp-api class=md-nav__link> <span class=md-ellipsis> MISP API </span> </a> </li> <li class=md-nav__item> <a href=#mongodb class=md-nav__link> <span class=md-ellipsis> MongoDB </span> </a> </li> <li class=md-nav__item> <a href=#redis class=md-nav__link> <span class=md-ellipsis> Redis </span> </a> </li> <li class=md-nav__item> <a href=#request-tracker_1 class=md-nav__link> <span class=md-ellipsis> Request Tracker </span> </a> </li> <li class=md-nav__item> <a href=#rest-api class=md-nav__link> <span class=md-ellipsis> REST API </span> </a> </li> <li class=md-nav__item> <a href=#rpz-file class=md-nav__link> <span class=md-ellipsis> RPZ File </span> </a> </li> <li class=md-nav__item> <a href=#smtp-batch class=md-nav__link> <span class=md-ellipsis> SMTP Batch </span> </a> </li> <li class=md-nav__item> <a href=#smtp class=md-nav__link> <span class=md-ellipsis> SMTP </span> </a> </li> <li class=md-nav__item> <a href=#sql class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=#stomp_1 class=md-nav__link> <span class=md-ellipsis> STOMP </span> </a> </li> <li class=md-nav__item> <a href=#tcp_1 class=md-nav__link> <span class=md-ellipsis> TCP </span> </a> </li> <li class=md-nav__item> <a href=#templated-smtp class=md-nav__link> <span class=md-ellipsis> Templated SMTP </span> </a> </li> <li class=md-nav__item> <a href=#touch class=md-nav__link> <span class=md-ellipsis> Touch </span> </a> </li> <li class=md-nav__item> <a href=#udp class=md-nav__link> <span class=md-ellipsis> UDP </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../feeds/ class=md-nav__link> <span class=md-ellipsis> Feeds </span> </a> </li> <li class=md-nav__item> <a href=../abuse-contacts/ class=md-nav__link> <span class=md-ellipsis> Abuse Contacts </span> </a> </li> <li class=md-nav__item> <a href=../manager/ class=md-nav__link> <span class=md-ellipsis> Manager </span> </a> </li> <li class=md-nav__item> <a href=../api/ class=md-nav__link> <span class=md-ellipsis> API </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Administrator Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Administrator Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin/intro/ class=md-nav__link> <span class=md-ellipsis> Intro </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Installation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin/installation/linux-packages/ class=md-nav__link> <span class=md-ellipsis> Linux Package </span> </a> </li> <li class=md-nav__item> <a href=../../admin/installation/pypi/ class=md-nav__link> <span class=md-ellipsis> PyPI </span> </a> </li> <li class=md-nav__item> <a href=../../admin/installation/dockerhub/ class=md-nav__link> <span class=md-ellipsis> DockerHub </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../admin/upgrade/ class=md-nav__link> <span class=md-ellipsis> Upgrade </span> </a> </li> <li class=md-nav__item> <a href=../../admin/hardware-requirements/ class=md-nav__link> <span class=md-ellipsis> Hardware Requirements </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex=0> <span class=md-ellipsis> Configuration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin/configuration/intelmq/ class=md-nav__link> <span class=md-ellipsis> IntelMQ </span> </a> </li> <li class=md-nav__item> <a href=../../admin/configuration/intelmq-api/ class=md-nav__link> <span class=md-ellipsis> IntelMQ API </span> </a> </li> <li class=md-nav__item> <a href=../../admin/configuration/intelmq-manager/ class=md-nav__link> <span class=md-ellipsis> IntelMQ Manager </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_6> <label class=md-nav__link for=__nav_5_6 id=__nav_5_6_label tabindex=0> <span class=md-ellipsis> Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_6_label aria-expanded=false> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin/management/intelmq/ class=md-nav__link> <span class=md-ellipsis> IntelMQ </span> </a> </li> <li class=md-nav__item> <a href=../../admin/management/intelmq-api/ class=md-nav__link> <span class=md-ellipsis> IntelMQ API </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_7> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0> <span class=md-ellipsis> Database </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_7_label aria-expanded=false> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> Database </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin/database/postgresql/ class=md-nav__link> <span class=md-ellipsis> PostgreSQL </span> </a> </li> <li class=md-nav__item> <a href=../../admin/database/elasticsearch/ class=md-nav__link> <span class=md-ellipsis> Elasticsearch </span> </a> </li> <li class=md-nav__item> <a href=../../admin/database/splunk/ class=md-nav__link> <span class=md-ellipsis> Splunk </span> </a> </li> <li class=md-nav__item> <a href=../../admin/database/sqlite/ class=md-nav__link> <span class=md-ellipsis> SQLite </span> </a> </li> <li class=md-nav__item> <a href=../../admin/database/mssql/ class=md-nav__link> <span class=md-ellipsis> MSSQL </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_8> <label class=md-nav__link for=__nav_5_8 id=__nav_5_8_label tabindex=0> <span class=md-ellipsis> Utilities </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_8_label aria-expanded=false> <label class=md-nav__title for=__nav_5_8> <span class="md-nav__icon md-icon"></span> Utilities </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin/utilities/bash-completion/ class=md-nav__link> <span class=md-ellipsis> Bash Completion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_9> <label class=md-nav__link for=__nav_5_9 id=__nav_5_9_label tabindex=0> <span class=md-ellipsis> Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_9_label aria-expanded=false> <label class=md-nav__title for=__nav_5_9> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin/integrations/misp/ class=md-nav__link> <span class=md-ellipsis> MISP </span> </a> </li> <li class=md-nav__item> <a href=../../admin/integrations/n6/ class=md-nav__link> <span class=md-ellipsis> N6 </span> </a> </li> <li class=md-nav__item> <a href=../../admin/integrations/cifv3/ class=md-nav__link> <span class=md-ellipsis> CIFv3 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../admin/beta-features/ class=md-nav__link> <span class=md-ellipsis> Beta Features </span> </a> </li> <li class=md-nav__item> <a href=../../admin/common-problems/ class=md-nav__link> <span class=md-ellipsis> Common Problems </span> </a> </li> <li class=md-nav__item> <a href=../../admin/faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Developer Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Developer Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dev/intro/ class=md-nav__link> <span class=md-ellipsis> Intro </span> </a> </li> <li class=md-nav__item> <a href=../../dev/guidelines/ class=md-nav__link> <span class=md-ellipsis> Guidelines </span> </a> </li> <li class=md-nav__item> <a href=../../dev/structure/ class=md-nav__link> <span class=md-ellipsis> Structure </span> </a> </li> <li class=md-nav__item> <a href=../../dev/environment/ class=md-nav__link> <span class=md-ellipsis> Environment </span> </a> </li> <li class=md-nav__item> <a href=../../dev/data-format/ class=md-nav__link> <span class=md-ellipsis> Data Format </span> </a> </li> <li class=md-nav__item> <a href=../../dev/adding-feeds/ class=md-nav__link> <span class=md-ellipsis> Adding Feeds </span> </a> </li> <li class=md-nav__item> <a href=../../dev/bot-development/ class=md-nav__link> <span class=md-ellipsis> Bot Development </span> </a> </li> <li class=md-nav__item> <a href=../../dev/extensions-packages/ class=md-nav__link> <span class=md-ellipsis> Extensions Packages </span> </a> </li> <li class=md-nav__item> <a href=../../dev/testing/ class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> <li class=md-nav__item> <a href=../../dev/documentation/ class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class=md-nav__item> <a href=../../dev/library/ class=md-nav__link> <span class=md-ellipsis> Use as Library </span> </a> </li> <li class=md-nav__item> <a href=../../dev/release/ class=md-nav__link> <span class=md-ellipsis> Release </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../../community/ class=md-nav__link> <span class=md-ellipsis> Community </span> </a> </li> <li class=md-nav__item> <a href=../../help/ class=md-nav__link> <span class=md-ellipsis> Help </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#individual-bot-configuration class=md-nav__link> <span class=md-ellipsis> Individual Bot Configuration </span> </a> </li> <li class=md-nav__item> <a href=#generic-parameters class=md-nav__link> <span class=md-ellipsis> Generic Parameters </span> </a> <nav class=md-nav aria-label="Generic Parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#id class=md-nav__link> <span class=md-ellipsis> id </span> </a> </li> <li class=md-nav__item> <a href=#name class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> <li class=md-nav__item> <a href=#description class=md-nav__link> <span class=md-ellipsis> description </span> </a> </li> <li class=md-nav__item> <a href=#module class=md-nav__link> <span class=md-ellipsis> module </span> </a> </li> <li class=md-nav__item> <a href=#group class=md-nav__link> <span class=md-ellipsis> group </span> </a> </li> <li class=md-nav__item> <a href=#enabled class=md-nav__link> <span class=md-ellipsis> enabled </span> </a> </li> <li class=md-nav__item> <a href=#run_mode class=md-nav__link> <span class=md-ellipsis> run_mode </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#http-parameters class=md-nav__link> <span class=md-ellipsis> HTTP Parameters </span> </a> <nav class=md-nav aria-label="HTTP Parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#http_timeout_sec class=md-nav__link> <span class=md-ellipsis> http_timeout_sec </span> </a> </li> <li class=md-nav__item> <a href=#http_timeout_max_tries class=md-nav__link> <span class=md-ellipsis> http_timeout_max_tries </span> </a> </li> <li class=md-nav__item> <a href=#http_username class=md-nav__link> <span class=md-ellipsis> http_username </span> </a> </li> <li class=md-nav__item> <a href=#http_password class=md-nav__link> <span class=md-ellipsis> http_password </span> </a> </li> <li class=md-nav__item> <a href=#http_proxy class=md-nav__link> <span class=md-ellipsis> http_proxy </span> </a> </li> <li class=md-nav__item> <a href=#https_proxy class=md-nav__link> <span class=md-ellipsis> https_proxy </span> </a> </li> <li class=md-nav__item> <a href=#http_user_agent class=md-nav__link> <span class=md-ellipsis> http_user_agent </span> </a> </li> <li class=md-nav__item> <a href=#http_verify_cert class=md-nav__link> <span class=md-ellipsis> http_verify_cert </span> </a> </li> <li class=md-nav__item> <a href=#ssl_client_certificate class=md-nav__link> <span class=md-ellipsis> ssl_client_certificate </span> </a> </li> <li class=md-nav__item> <a href=#ssl_ca_certificate class=md-nav__link> <span class=md-ellipsis> ssl_ca_certificate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cache-parameters class=md-nav__link> <span class=md-ellipsis> Cache Parameters </span> </a> <nav class=md-nav aria-label="Cache Parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#redis_cache_host class=md-nav__link> <span class=md-ellipsis> redis_cache_host </span> </a> </li> <li class=md-nav__item> <a href=#redis_cache_port class=md-nav__link> <span class=md-ellipsis> redis_cache_port </span> </a> </li> <li class=md-nav__item> <a href=#redis_cache_db class=md-nav__link> <span class=md-ellipsis> redis_cache_db </span> </a> </li> <li class=md-nav__item> <a href=#redis_cache_ttl class=md-nav__link> <span class=md-ellipsis> redis_cache_ttl </span> </a> </li> <li class=md-nav__item> <a href=#redis_cache_password class=md-nav__link> <span class=md-ellipsis> redis_cache_password </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#collector-bots class=md-nav__link> <span class=md-ellipsis> Collector Bots </span> </a> <nav class=md-nav aria-label="Collector Bots"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#feed-parameters class=md-nav__link> <span class=md-ellipsis> Feed Parameters </span> </a> <nav class=md-nav aria-label="Feed Parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#name_1 class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> <li class=md-nav__item> <a href=#accuracy class=md-nav__link> <span class=md-ellipsis> accuracy </span> </a> </li> <li class=md-nav__item> <a href=#code class=md-nav__link> <span class=md-ellipsis> code </span> </a> </li> <li class=md-nav__item> <a href=#documentation class=md-nav__link> <span class=md-ellipsis> documentation </span> </a> </li> <li class=md-nav__item> <a href=#provider class=md-nav__link> <span class=md-ellipsis> provider </span> </a> </li> <li class=md-nav__item> <a href=#rate_limit class=md-nav__link> <span class=md-ellipsis> rate_limit </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#alien-vault-otx class=md-nav__link> <span class=md-ellipsis> Alien Vault OTX </span> </a> </li> <li class=md-nav__item> <a href=#amqp class=md-nav__link> <span class=md-ellipsis> AMQP </span> </a> </li> <li class=md-nav__item> <a href=#api class=md-nav__link> <span class=md-ellipsis> API </span> </a> </li> <li class=md-nav__item> <a href=#generic-url-fetcher class=md-nav__link> <span class=md-ellipsis> Generic URL Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#generic-url-stream-fetcher class=md-nav__link> <span class=md-ellipsis> Generic URL Stream Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#generic-mail-url-fetcher class=md-nav__link> <span class=md-ellipsis> Generic Mail URL Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#generic-mail-attachment-fetcher class=md-nav__link> <span class=md-ellipsis> Generic Mail Attachment Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#generic-mail-body-fetcher class=md-nav__link> <span class=md-ellipsis> Generic Mail Body Fetcher </span> </a> </li> <li class=md-nav__item> <a href=#github-api class=md-nav__link> <span class=md-ellipsis> Github API </span> </a> </li> <li class=md-nav__item> <a href=#file class=md-nav__link> <span class=md-ellipsis> File </span> </a> </li> <li class=md-nav__item> <a href=#fireeye class=md-nav__link> <span class=md-ellipsis> FireEye </span> </a> </li> <li class=md-nav__item> <a href=#kafka class=md-nav__link> <span class=md-ellipsis> Kafka </span> </a> </li> <li class=md-nav__item> <a href=#misp-generic class=md-nav__link> <span class=md-ellipsis> MISP Generic </span> </a> </li> <li class=md-nav__item> <a href=#request-tracker class=md-nav__link> <span class=md-ellipsis> Request Tracker </span> </a> </li> <li class=md-nav__item> <a href=#rsync class=md-nav__link> <span class=md-ellipsis> Rsync </span> </a> </li> <li class=md-nav__item> <a href=#shadowserver-reports-api class=md-nav__link> <span class=md-ellipsis> Shadowserver Reports API </span> </a> </li> <li class=md-nav__item> <a href=#shodan-stream class=md-nav__link> <span class=md-ellipsis> Shodan Stream </span> </a> </li> <li class=md-nav__item> <a href=#tcp class=md-nav__link> <span class=md-ellipsis> TCP </span> </a> </li> <li class=md-nav__item> <a href=#blueliv-crimeserver class=md-nav__link> <span class=md-ellipsis> Blueliv Crimeserver </span> </a> </li> <li class=md-nav__item> <a href=#calidog-certstream class=md-nav__link> <span class=md-ellipsis> Calidog Certstream </span> </a> </li> <li class=md-nav__item> <a href=#eset-eti class=md-nav__link> <span class=md-ellipsis> ESET ETI </span> </a> </li> <li class=md-nav__item> <a href=#mcafee-opendxl class=md-nav__link> <span class=md-ellipsis> McAfee openDXL </span> </a> </li> <li class=md-nav__item> <a href=#microsoft-azure class=md-nav__link> <span class=md-ellipsis> Microsoft Azure </span> </a> </li> <li class=md-nav__item> <a href=#microsoft-interflow class=md-nav__link> <span class=md-ellipsis> Microsoft Interflow </span> </a> </li> <li class=md-nav__item> <a href=#stomp class=md-nav__link> <span class=md-ellipsis> STOMP </span> </a> </li> <li class=md-nav__item> <a href=#twitter-remove class=md-nav__link> <span class=md-ellipsis> Twitter (REMOVE?) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#parser-bots class=md-nav__link> <span class=md-ellipsis> Parser Bots </span> </a> <nav class=md-nav aria-label="Parser Bots"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-parameters class=md-nav__link> <span class=md-ellipsis> Common parameters </span> </a> <nav class=md-nav aria-label="Common parameters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default_fields class=md-nav__link> <span class=md-ellipsis> default_fields </span> </a> </li> <li class=md-nav__item> <a href=#copy_collector_provided_fields class=md-nav__link> <span class=md-ellipsis> copy_collector_provided_fields </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#abusech-feodo-tracker class=md-nav__link> <span class=md-ellipsis> Abuse.ch Feodo Tracker </span> </a> </li> <li class=md-nav__item> <a href=#alienvault-api class=md-nav__link> <span class=md-ellipsis> AlienVault API </span> </a> </li> <li class=md-nav__item> <a href=#alienvault-otx class=md-nav__link> <span class=md-ellipsis> AlienVault OTX </span> </a> </li> <li class=md-nav__item> <a href=#anubisnetworks-cyberfeed-stream class=md-nav__link> <span class=md-ellipsis> AnubisNetworks Cyberfeed Stream </span> </a> </li> <li class=md-nav__item> <a href=#bambenek class=md-nav__link> <span class=md-ellipsis> Bambenek </span> </a> </li> <li class=md-nav__item> <a href=#blocklistde class=md-nav__link> <span class=md-ellipsis> Blocklist.de </span> </a> </li> <li class=md-nav__item> <a href=#blueliv-crimeserver_1 class=md-nav__link> <span class=md-ellipsis> Blueliv Crimeserver </span> </a> </li> <li class=md-nav__item> <a href=#calidog-certstream_1 class=md-nav__link> <span class=md-ellipsis> Calidog Certstream </span> </a> </li> <li class=md-nav__item> <a href=#cert-eu class=md-nav__link> <span class=md-ellipsis> CERT-EU </span> </a> </li> <li class=md-nav__item> <a href=#ci-army class=md-nav__link> <span class=md-ellipsis> CI Army </span> </a> </li> <li class=md-nav__item> <a href=#cleanmx class=md-nav__link> <span class=md-ellipsis> CleanMX </span> </a> </li> <li class=md-nav__item> <a href=#team-cymru-cap class=md-nav__link> <span class=md-ellipsis> Team Cymru CAP </span> </a> </li> <li class=md-nav__item> <a href=#team-cymru-full-bogons class=md-nav__link> <span class=md-ellipsis> Team Cymru Full Bogons </span> </a> </li> <li class=md-nav__item> <a href=#cznic-haas class=md-nav__link> <span class=md-ellipsis> CZ.NIC HaaS </span> </a> </li> <li class=md-nav__item> <a href=#cznic-proki class=md-nav__link> <span class=md-ellipsis> CZ.NIC PROKI </span> </a> </li> <li class=md-nav__item> <a href=#danger-rulez class=md-nav__link> <span class=md-ellipsis> Danger Rulez </span> </a> </li> <li class=md-nav__item> <a href=#dataplane class=md-nav__link> <span class=md-ellipsis> Dataplane </span> </a> </li> <li class=md-nav__item> <a href=#dshield-asn class=md-nav__link> <span class=md-ellipsis> DShield ASN </span> </a> </li> <li class=md-nav__item> <a href=#dshield-block class=md-nav__link> <span class=md-ellipsis> DShield Block </span> </a> </li> <li class=md-nav__item> <a href=#eset class=md-nav__link> <span class=md-ellipsis> ESET </span> </a> </li> <li class=md-nav__item> <a href=#dyn-todo class=md-nav__link> <span class=md-ellipsis> Dyn (TODO) </span> </a> </li> <li class=md-nav__item> <a href=#fireeye_1 class=md-nav__link> <span class=md-ellipsis> FireEye </span> </a> </li> <li class=md-nav__item> <a href=#fraunhofer-dga class=md-nav__link> <span class=md-ellipsis> Fraunhofer DGA </span> </a> </li> <li class=md-nav__item> <a href=#generic-csv class=md-nav__link> <span class=md-ellipsis> Generic CSV </span> </a> </li> <li class=md-nav__item> <a href=#github-feed class=md-nav__link> <span class=md-ellipsis> Github Feed </span> </a> </li> <li class=md-nav__item> <a href=#have-i-been-pwned-callback class=md-nav__link> <span class=md-ellipsis> Have I Been Pwned Callback </span> </a> </li> <li class=md-nav__item> <a href=#html-table class=md-nav__link> <span class=md-ellipsis> HTML Table </span> </a> </li> <li class=md-nav__item> <a href=#json-todo class=md-nav__link> <span class=md-ellipsis> JSON (TODO) </span> </a> </li> <li class=md-nav__item> <a href=#keyvalue-parser class=md-nav__link> <span class=md-ellipsis> Key=Value Parser </span> </a> </li> <li class=md-nav__item> <a href=#malwarepatrol class=md-nav__link> <span class=md-ellipsis> MalwarePatrol </span> </a> </li> <li class=md-nav__item> <a href=#malwareurl class=md-nav__link> <span class=md-ellipsis> MalwareURL </span> </a> </li> <li class=md-nav__item> <a href=#mcafee-advanced-threat-defense-file class=md-nav__link> <span class=md-ellipsis> McAfee Advanced Threat Defense File </span> </a> </li> <li class=md-nav__item> <a href=#microsoft-ctip class=md-nav__link> <span class=md-ellipsis> Microsoft CTIP </span> </a> </li> <li class=md-nav__item> <a href=#misp class=md-nav__link> <span class=md-ellipsis> MISP </span> </a> </li> <li class=md-nav__item> <a href=#n6 class=md-nav__link> <span class=md-ellipsis> N6 </span> </a> </li> <li class=md-nav__item> <a href=#openphish-free class=md-nav__link> <span class=md-ellipsis> OpenPhish Free </span> </a> </li> <li class=md-nav__item> <a href=#openphish-premium class=md-nav__link> <span class=md-ellipsis> OpenPhish Premium </span> </a> </li> <li class=md-nav__item> <a href=#phishtank class=md-nav__link> <span class=md-ellipsis> Phishtank </span> </a> </li> <li class=md-nav__item> <a href=#shadowserver class=md-nav__link> <span class=md-ellipsis> Shadowserver </span> </a> </li> <li class=md-nav__item> <a href=#shodan class=md-nav__link> <span class=md-ellipsis> Shodan </span> </a> </li> <li class=md-nav__item> <a href=#spamhaus-drop class=md-nav__link> <span class=md-ellipsis> Spamhaus DROP </span> </a> </li> <li class=md-nav__item> <a href=#spamhaus-cert class=md-nav__link> <span class=md-ellipsis> Spamhaus CERT </span> </a> </li> <li class=md-nav__item> <a href=#surbl class=md-nav__link> <span class=md-ellipsis> Surbl </span> </a> </li> <li class=md-nav__item> <a href=#threatminer class=md-nav__link> <span class=md-ellipsis> Threatminer </span> </a> </li> <li class=md-nav__item> <a href=#turris class=md-nav__link> <span class=md-ellipsis> Turris </span> </a> </li> <li class=md-nav__item> <a href=#twitter class=md-nav__link> <span class=md-ellipsis> Twitter </span> </a> </li> <li class=md-nav__item> <a href=#vxvault class=md-nav__link> <span class=md-ellipsis> VxVault </span> </a> </li> <li class=md-nav__item> <a href=#zoneh class=md-nav__link> <span class=md-ellipsis> ZoneH </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#expert-bots class=md-nav__link> <span class=md-ellipsis> Expert Bots </span> </a> <nav class=md-nav aria-label="Expert Bots"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#abusix class=md-nav__link> <span class=md-ellipsis> Abusix </span> </a> </li> <li class=md-nav__item> <a href=#aggregate class=md-nav__link> <span class=md-ellipsis> Aggregate </span> </a> </li> <li class=md-nav__item> <a href=#asn-lookup class=md-nav__link> <span class=md-ellipsis> ASN Lookup </span> </a> </li> <li class=md-nav__item> <a href=#csv-converter class=md-nav__link> <span class=md-ellipsis> CSV Converter </span> </a> </li> <li class=md-nav__item> <a href=#team-cymru-whois class=md-nav__link> <span class=md-ellipsis> Team Cymru Whois </span> </a> </li> <li class=md-nav__item> <a href=#remove-affix class=md-nav__link> <span class=md-ellipsis> Remove Affix </span> </a> </li> <li class=md-nav__item> <a href=#domain-suffix class=md-nav__link> <span class=md-ellipsis> Domain Suffix </span> </a> </li> <li class=md-nav__item> <a href=#domain-valid class=md-nav__link> <span class=md-ellipsis> Domain Valid </span> </a> </li> <li class=md-nav__item> <a href=#deduplicator class=md-nav__link> <span class=md-ellipsis> Deduplicator </span> </a> </li> <li class=md-nav__item> <a href=#do-portal class=md-nav__link> <span class=md-ellipsis> DO Portal </span> </a> </li> <li class=md-nav__item> <a href=#field-reducer class=md-nav__link> <span class=md-ellipsis> Field Reducer </span> </a> </li> <li class=md-nav__item> <a href=#filter class=md-nav__link> <span class=md-ellipsis> Filter </span> </a> </li> <li class=md-nav__item> <a href=#format-field class=md-nav__link> <span class=md-ellipsis> Format Field </span> </a> </li> <li class=md-nav__item> <a href=#generic-db-lookup class=md-nav__link> <span class=md-ellipsis> Generic DB Lookup </span> </a> </li> <li class=md-nav__item> <a href=#gethostbyname class=md-nav__link> <span class=md-ellipsis> Gethostbyname </span> </a> </li> <li class=md-nav__item> <a href=#http-status class=md-nav__link> <span class=md-ellipsis> HTTP Status </span> </a> </li> <li class=md-nav__item> <a href=#http-content class=md-nav__link> <span class=md-ellipsis> HTTP Content </span> </a> </li> <li class=md-nav__item> <a href=#idea-converter class=md-nav__link> <span class=md-ellipsis> IDEA Converter </span> </a> </li> <li class=md-nav__item> <a href=#jinja2-template class=md-nav__link> <span class=md-ellipsis> Jinja2 Template </span> </a> </li> <li class=md-nav__item> <a href=#lookyloo class=md-nav__link> <span class=md-ellipsis> Lookyloo </span> </a> </li> <li class=md-nav__item> <a href=#maxmind-geoip class=md-nav__link> <span class=md-ellipsis> MaxMind GeoIP </span> </a> </li> <li class=md-nav__item> <a href=#misp_1 class=md-nav__link> <span class=md-ellipsis> MISP </span> </a> </li> <li class=md-nav__item> <a href=#mcafee-active-response-lookup class=md-nav__link> <span class=md-ellipsis> McAfee Active Response Lookup </span> </a> </li> <li class=md-nav__item> <a href=#modify class=md-nav__link> <span class=md-ellipsis> Modify </span> </a> </li> <li class=md-nav__item> <a href=#national-cert-contact-lookup-by-certat class=md-nav__link> <span class=md-ellipsis> National CERT Contact Lookup by CERT.AT </span> </a> </li> <li class=md-nav__item> <a href=#rdap class=md-nav__link> <span class=md-ellipsis> RDAP </span> </a> </li> <li class=md-nav__item> <a href=#recordedfuture-ip-risk class=md-nav__link> <span class=md-ellipsis> RecordedFuture IP Risk </span> </a> </li> <li class=md-nav__item> <a href=#reverse-dns class=md-nav__link> <span class=md-ellipsis> Reverse DNS </span> </a> </li> <li class=md-nav__item> <a href=#rfc1918 class=md-nav__link> <span class=md-ellipsis> RFC1918 </span> </a> </li> <li class=md-nav__item> <a href=#ripe class=md-nav__link> <span class=md-ellipsis> RIPE </span> </a> </li> <li class=md-nav__item> <a href=#sieve class=md-nav__link> <span class=md-ellipsis> Sieve </span> </a> </li> <li class=md-nav__item> <a href=#splunk-saved-search-lookup class=md-nav__link> <span class=md-ellipsis> Splunk Saved Search Lookup </span> </a> </li> <li class=md-nav__item> <a href=#taxonomy class=md-nav__link> <span class=md-ellipsis> Taxonomy </span> </a> </li> <li class=md-nav__item> <a href=#threshold class=md-nav__link> <span class=md-ellipsis> Threshold </span> </a> </li> <li class=md-nav__item> <a href=#tor-exit-node class=md-nav__link> <span class=md-ellipsis> Tor Exit Node </span> </a> </li> <li class=md-nav__item> <a href=#trusted-introducer-lookup class=md-nav__link> <span class=md-ellipsis> Trusted Introducer Lookup </span> </a> </li> <li class=md-nav__item> <a href=#tuency class=md-nav__link> <span class=md-ellipsis> Tuency </span> </a> </li> <li class=md-nav__item> <a href=#truncate-by-delimiter class=md-nav__link> <span class=md-ellipsis> Truncate By Delimiter </span> </a> </li> <li class=md-nav__item> <a href=#url class=md-nav__link> <span class=md-ellipsis> URL </span> </a> </li> <li class=md-nav__item> <a href=#url2fqdn class=md-nav__link> <span class=md-ellipsis> Url2FQDN </span> </a> </li> <li class=md-nav__item> <a href=#uwhoisd class=md-nav__link> <span class=md-ellipsis> uWhoisd </span> </a> </li> <li class=md-nav__item> <a href=#wait class=md-nav__link> <span class=md-ellipsis> Wait </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#output-bots class=md-nav__link> <span class=md-ellipsis> Output Bots </span> </a> <nav class=md-nav aria-label="Output Bots"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#amqp-topic class=md-nav__link> <span class=md-ellipsis> AMQP Topic </span> </a> </li> <li class=md-nav__item> <a href=#blackhole class=md-nav__link> <span class=md-ellipsis> Blackhole </span> </a> </li> <li class=md-nav__item> <a href=#bro-file class=md-nav__link> <span class=md-ellipsis> Bro File </span> </a> </li> <li class=md-nav__item> <a href=#cifv3-api class=md-nav__link> <span class=md-ellipsis> CIFv3 API </span> </a> </li> <li class=md-nav__item> <a href=#elasticsearch class=md-nav__link> <span class=md-ellipsis> Elasticsearch </span> </a> </li> <li class=md-nav__item> <a href=#file_1 class=md-nav__link> <span class=md-ellipsis> File </span> </a> </li> <li class=md-nav__item> <a href=#files class=md-nav__link> <span class=md-ellipsis> Files </span> </a> </li> <li class=md-nav__item> <a href=#mcafee-enterprise-security-manager class=md-nav__link> <span class=md-ellipsis> McAfee Enterprise Security Manager </span> </a> </li> <li class=md-nav__item> <a href=#misp-feed class=md-nav__link> <span class=md-ellipsis> MISP Feed </span> </a> </li> <li class=md-nav__item> <a href=#misp-api class=md-nav__link> <span class=md-ellipsis> MISP API </span> </a> </li> <li class=md-nav__item> <a href=#mongodb class=md-nav__link> <span class=md-ellipsis> MongoDB </span> </a> </li> <li class=md-nav__item> <a href=#redis class=md-nav__link> <span class=md-ellipsis> Redis </span> </a> </li> <li class=md-nav__item> <a href=#request-tracker_1 class=md-nav__link> <span class=md-ellipsis> Request Tracker </span> </a> </li> <li class=md-nav__item> <a href=#rest-api class=md-nav__link> <span class=md-ellipsis> REST API </span> </a> </li> <li class=md-nav__item> <a href=#rpz-file class=md-nav__link> <span class=md-ellipsis> RPZ File </span> </a> </li> <li class=md-nav__item> <a href=#smtp-batch class=md-nav__link> <span class=md-ellipsis> SMTP Batch </span> </a> </li> <li class=md-nav__item> <a href=#smtp class=md-nav__link> <span class=md-ellipsis> SMTP </span> </a> </li> <li class=md-nav__item> <a href=#sql class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=#stomp_1 class=md-nav__link> <span class=md-ellipsis> STOMP </span> </a> </li> <li class=md-nav__item> <a href=#tcp_1 class=md-nav__link> <span class=md-ellipsis> TCP </span> </a> </li> <li class=md-nav__item> <a href=#templated-smtp class=md-nav__link> <span class=md-ellipsis> Templated SMTP </span> </a> </li> <li class=md-nav__item> <a href=#touch class=md-nav__link> <span class=md-ellipsis> Touch </span> </a> </li> <li class=md-nav__item> <a href=#udp class=md-nav__link> <span class=md-ellipsis> UDP </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <!-- comment
   SPDX-FileCopyrightText: 2015-2023 Sebastian Wagner, Filip Pokorný
   SPDX-License-Identifier: AGPL-3.0-or-later
--> <h1 id=bots-inventory>Bots Inventory</h1> <p>This document contains complete reference of bots implemented by IntelMQ and how to configure them from the users perspective (meaning via IntelMQ Manager). Some of the bots are intended for general use and some of them are for processing particular data sources.</p> <h2 id=individual-bot-configuration>Individual Bot Configuration</h2> <p>Each bot has it's own configuration. The configuration consists of two types of parameters:</p> <ul> <li> <p><strong>Generic parameters</strong> that are common to all the bots and need to be set for each bot.</p> </li> <li> <p><strong>Runtime parameters</strong> are needed by the bot itself during runtime. Some of these parameters can be inherited from the <a href=../../admin/configuration/intelmq/#runtimeyaml>global configuration</a> (which is applied to all the bots), but can be overridden in the individual bot configuration.</p> </li> </ul> <h2 id=generic-parameters>Generic Parameters</h2> <p>These parameters must be set for each bot (at least the required ones).</p> <h3 id=id><code>id</code></h3> <p>(required, string) This must be a unique identifier. Commonly it looks something like this: <code>abusech-feodo-tracker-collector</code>. It is safer to avoid using spaces.</p> <h3 id=name><code>name</code></h3> <p>(required, string) Human readable name of the bot.</p> <h3 id=description><code>description</code></h3> <p>(required, string) The description of the bot.</p> <h3 id=module><code>module</code></h3> <p>(required, string) The executable (should be in <code>PATH</code> environment variable) which will be started.</p> <h3 id=group><code>group</code></h3> <p>(optional, string) The group of the bot. Can be <code>Collector</code>, <code>Parser</code>, <code>Expert</code> or <code>Output</code>. Only used for visualization by other tools.</p> <h3 id=enabled><code>enabled</code></h3> <p>(optional, boolean) Whether the bot will start when the whole botnet is started. You can still start a disabled bot explicitly. Defaults to <code>true</code>.</p> <h3 id=run_mode><code>run_mode</code></h3> <p>(optional, string) There are two run modes, <code>continuous</code> or <code>scheduled</code>. In the first case, the bot will be running forever until stopped or exits because of errors (depending on the configuration). In the latter case, the bot will stop after one successful run. This is especially useful when scheduling bots via cron or systemd. Check <a href=../../admin/configuration/intelmq/ >Configuration</a> section for more details. Defaults to <code>continuous</code>.</p> <h2 id=http-parameters>HTTP Parameters</h2> <p>Common HTTP runtime parameters used in multiple bots.</p> <h3 id=http_timeout_sec><code>http_timeout_sec</code></h3> <p>(optional, float) A tuple of floats or only one float describing the timeout (seconds) of the HTTP connection. Can be a tuple of two floats (read and connect timeout) or just one float (applies for both timeouts). See also <a href=https://requests.readthedocs.io/en/master/user/advanced/#timeouts>https://requests.readthedocs.io/en/master/user/advanced/#timeouts</a>. Defaults to 30.</p> <h3 id=http_timeout_max_tries><code>http_timeout_max_tries</code></h3> <p>(optional, integer) An integer depicting how many times a connection is retried, when a timeout occurred. Defaults to 3.</p> <h3 id=http_username><code>http_username</code></h3> <p>(optional, string) Username for basic HTTP authentication.</p> <h3 id=http_password><code>http_password</code></h3> <p>(optional, string) Password for basic HTTP authentication.</p> <h3 id=http_proxy><code>http_proxy</code></h3> <p>(optional, string) Proxy to use for HTTP.</p> <h3 id=https_proxy><code>https_proxy</code></h3> <p>(optional, string) Proxy to use for HTTPS.</p> <h3 id=http_user_agent><code>http_user_agent</code></h3> <p>(optional, string) User-Agent to be used for HTTP requests.</p> <h3 id=http_verify_cert><code>http_verify_cert</code></h3> <p>(optional, boolean/string) Path to trusted CA bundle or directory, <code>false</code> to ignore verifying SSL certificates, or <code>true</code> to verify SSL certificates. Defaults to <code>true</code>.</p> <h3 id=ssl_client_certificate><code>ssl_client_certificate</code></h3> <p>(optional, string) Path to client certificate to use for TLS connections.</p> <h3 id=ssl_ca_certificate><code>ssl_ca_certificate</code></h3> <p>(optional, string) Path to trusted CA certificate. Only used by some bots.</p> <h2 id=cache-parameters>Cache Parameters</h2> <p>Common Redis cache runtime parameters used in multiple bots (mainly lookup experts).</p> <h3 id=redis_cache_host><code>redis_cache_host</code></h3> <p>(required, string) Hostname of the Redis database.</p> <h3 id=redis_cache_port><code>redis_cache_port</code></h3> <p>(required, string) Port of the Redis database.</p> <h3 id=redis_cache_db><code>redis_cache_db</code></h3> <p>(required, integer) Database number.</p> <h3 id=redis_cache_ttl><code>redis_cache_ttl</code></h3> <p>(required, integer) TTL used for caching.</p> <h3 id=redis_cache_password><code>redis_cache_password</code></h3> <p>(optional, string) Password for the Redis database.</p> <h2 id=collector-bots>Collector Bots</h2> <p>Multihreading is disabled for all Collectors, as this would lead to duplicated data.</p> <h3 id=feed-parameters>Feed Parameters</h3> <p>These runtime parameters must be set for each collector bot (at least the required ones).</p> <h4 id=name_1><code>name</code></h4> <p>(required, string) Name of the feed (<a href>feed.name</a>).</p> <h4 id=accuracy><code>accuracy</code></h4> <p>(optional, float) Accuracy of the data from the feed (<a href>feed.accuracy</a>).</p> <h4 id=code><code>code</code></h4> <p>(optional, string) Code for the feed (<a href>feed.code</a>).</p> <h4 id=documentation><code>documentation</code></h4> <p>(optional, string) Link to documentation for the feed (<a href>feed.documentation</a>).</p> <h4 id=provider><code>provider</code></h4> <p>(optional, string) Name of the provider of the feed (<a href>feed.provider</a>).</p> <h4 id=rate_limit><code>rate_limit</code></h4> <p>(optional, integer) Time interval (in seconds) between fetching data if applicable. Defaults to 0.</p> <h3 id=alien-vault-otx>Alien Vault OTX <div id=intelmq.bots.collectors.alienvault_otx.collector /></h3> <p>Collects report messages from Alien Vault OTX.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.alienvault_otx.collector</code></p> <p><strong>Requirements</strong></p> <p>Install the library from GitHub, as there is no package in PyPi:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>pip3<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>intelmq/bots/collectors/alienvault_otx/REQUIREMENTS.txt
</code></pre></div> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>api_key</code></strong></p> <p>(required, string) API Key</p> <p><strong><code>modified_pulses_only</code></strong></p> <p>(optional, boolean) Whether to get only modified pulses instead of all. Defaults to false.</p> <p><strong><code>interval</code></strong></p> <p>(optional, integer) When <code>modified_pulses_only</code> is set, define the time in hours (integer value) to get modified pulses since then. Defaults to 24 (hours).</p> <hr> <h3 id=amqp>AMQP <div id=intelmq.bots.collectors.amqp.collector_amqp /></h3> <p>This bot collects data from (remote) AMQP servers, for both IntelMQ as well as external data. Currently only fetching from a queue is supported can be extended in the future. Messages will be acknowledge at AMQP after it is sent to the pipeline. Requires the <a href=https://pypi.org/project/pika/ >pika</a> library, minimum version 1.0.0.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.amqp.collector_amqp</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>connection_host</code></strong></p> <p>(optional, string) Hostname of the AMQP server. Defaults to 127.0.0.1.</p> <p><strong><code>connection_port</code></strong></p> <p>(optional, integer) Port of the AMQP server. Defaults to 5672.</p> <p><strong><code>connection_attempts</code></strong></p> <p>(optional, integer) The number of connection attempts to the defined server. Defaults to 3.</p> <p><strong><code>connection_heartbeat</code></strong></p> <p>(optional, integer) Heartbeat to server (seconds). Defaults to 3600.</p> <p><strong><code>connection_vhost</code></strong></p> <p>(optional, string) Virtual host to connect, on an HTTP(S) connection would be <http: ip /><your virtual host>.</p> <p><strong><code>expect_intelmq_message</code></strong></p> <p>(optional, boolean) This parameter denotes whether the the data is from IntelMQ or not. If true, then the data can be any Report or Event and will be passed to the next bot as is. Otherwise a new Report is created with the raw data. Defaults to false.</p> <p><strong><code>queue_name</code></strong></p> <p>(optional, string) The name of the queue to fetch the data from.</p> <p><strong><code>username</code></strong></p> <p>(optional, string) Username for authentication to the AMQP server.</p> <p><strong><code>password</code></strong></p> <p>(optional, string) Password for authentication to the AMQP server.</p> <p><strong><code>use_ssl</code></strong></p> <p>(optional, boolean) Use of TLS for the connection. Make sure to also set the correct port. Defaults to false.</p> <hr> <h3 id=api>API <div id=intelmq.bots.collectors.api.collector /></h3> <p>This bot collects data from HTTP or Socket REST API. The API is available at <code>/intelmq/push</code> when the HTTP interface is used. Requires the <a href=https://pypi.org/project/tornado/ >tornado</a> library.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.api.collector</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>port</code></strong></p> <p>(optional, integer) The local port at which the API is available. Defaults to 5000.</p> <p><strong><code>use_socket</code></strong></p> <p>(optional, boolean) If true, the socket will be opened at the location given with <code>socket_path</code>. Defaults to false.</p> <p><strong><code>socket_path</code></strong></p> <p>(optional, string) Location of the socket. Defaults to <code>/tmp/imq_api_default_socket</code>.</p> <p><strong><code>socket_perms</code></strong></p> <p>(optional, octal integer) Unix permissions to grant to the socket file. Default: <code>600</code></p> <p><strong><code>socket_group</code></strong></p> <p>(optional, string) Name of group to change group ownership of socket file to.</p> <hr> <h3 id=generic-url-fetcher>Generic URL Fetcher <div id=intelmq.bots.collectors.http.collector_http /></h3> <p>This bot collects data from remote hosts using HTTP protocol. If the HTTP response' status code is not 2xx, this is treated as error. In Debug logging level, the request's and response's headers and body are logged for further inspection.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.http.collector_http</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a> and <a href=#http-parameters>HTTP parameters</a>):</strong></p> <p><strong><code>http_url</code></strong></p> <p>(required, string) Location of the resource to download.</p> <p><strong><code>http_url_formatting</code></strong></p> <p>(optional, boolean/object) When true, <code>{time[format]}</code> will be replaced by the current time in local timezone formatted by the given format. E.g. if the URL is <code>http://localhost/{time[%Y]}</code>, then the resulting URL is <code>http://localhost/2019</code> for the year 2019. ( Python's <a href=https://docs.python.org/3/library/string.html#formatspec>Format Specification Mini-Language</a> is used for this.). You may use a JSON specifying <a href=https://docs.python.org/3/library/datetime.html#datetime.timedelta>time-delta</a> parameters to shift the current time accordingly. For example use <code>days: -1</code> for the yesterday's date; the URL <code>http://localhost/{time[%Y-%m-%d]}</code> will get translated to <code>http://localhost/2018-12-31</code> for the 1st Jan of 2019. Defaults to false.</p> <p><strong><code>extract_files</code></strong></p> <p>(optional, boolean/array of strings) If true, the retrieved (compressed) file or archived will be uncompressed/unpacked and the files are extracted. If the parameter is a list of strings, only the files matching the filenames are extracted. Extraction handles gzipped files and both compressed and uncompressed tar-archives as well as zip archives. For extracted files, every extracted file is sent in it's own report. Every report has a field named <code>extra.file_name</code> with the file name in the archive the content was extracted from. Defaults to false.</p> <p><strong><code>verify_pgp_signatures</code></strong></p> <p>(optional, boolean) When true, signature file is downloaded and report file is checked. On error (missing signature, mismatch, ...), the error is logged and the report is not processed. Public key has to be imported in local keyring. This requires the <a href=https://pypi.org/project/python-gnupg/ >python-gnupg</a> library. Defaults to false.</p> <p><strong><code>signature_url</code></strong></p> <p>(optional, string) Location of the signature file for the downloaded content.</p> <p><strong><code>signature_url_formatting</code></strong></p> <p>(optional, boolean/object) Same as <code>http_url_formatting</code>. Defaults to false.</p> <p><strong><code>gpg_keyring</code></strong></p> <p>(optional, string) If specified, the string represents path to keyring file. Otherwise the PGP keyring file of the current <code>intelmq</code> user is used.</p> <hr> <h3 id=generic-url-stream-fetcher>Generic URL Stream Fetcher <div id=intelmq.bots.collectors.http.collector_http_stream /></h3> <p>Opens a streaming connection to the URL and collects the received lines.</p> <p>If the stream is interrupted, the connection will be aborted using the timeout parameter. No error will be logged if the number of consecutive connection fails does not reach the parameter <code>error_max_retries</code>. Instead of errors, an INFO message is logged. This is a measurement against too frequent ERROR logging messages. The consecutive connection fails are reset if a data line has been successfully transferred. If the consecutive connection fails reaches the parameter <code>error_max_retries</code>, an exception will be thrown and <code>rate_limit</code> applies, if not null.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.http.collector_http_stream</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a> and <a href=#http-parameters>HTTP parameters</a>):</strong></p> <p>Uses the same parameters as <a href=#intelmq.bots.collectors.http.collector_http>Generic URL Fetcher</a>. The parameter <code>http_timeout_max_tries</code> is of no use in this collector.</p> <p><strong><code>strip_lines</code></strong></p> <p>(optional, boolean) Whether the single lines should be stripped (removing whitespace from the beginning and the end of the line) or not. Defaults to true.</p> <hr> <h3 id=generic-mail-url-fetcher>Generic Mail URL Fetcher <div id=intelmq.bots.collectors.mail.collector_mail_url /></h3> <p>Extracts URLs from e-mail messages and downloads the content from the URLs. It uses the <a href=https://github.com/martinrusev/imbox><code>imbox</code></a> library.</p> <p>The resulting reports contain the following special fields:</p> <ul> <li><code>feed.url</code>: The URL the data was downloaded from.</li> <li><code>extra.email_date</code>: The content of the email's <code>Date</code> header.</li> <li><code>extra.email_subject</code>: The subject of the email.</li> <li><code>extra.email_from</code>: The email's from address.</li> <li><code>extra.email_message_id</code>: The email's message ID.</li> <li><code>extra.file_name</code>: The file name of the downloaded file (extracted from the HTTP Response Headers if possible).</li> </ul> <p>The fields can be used by parsers to identify the feed and are not automatically passed on to events.</p> <p><strong>Chunking</strong></p> <p>For line-based inputs the bot can split up large reports into smaller chunks. This is particularly important for setups that use Redis as a message queue which has a per-message size limitation of 512 MB. To configure chunking, set <code>chunk_size</code> to a value in bytes. <code>chunk_replicate_header</code> determines whether the header line should be repeated for each chunk that is passed on to a parser bot. Specifically, to configure a large file input to work around Redis size limitation set <code>chunk_size</code> to something like 384000000 (~384 MB).</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.mail.collector_mail_url</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a> and <a href=#http-parameters>HTTP parameters</a>):</strong></p> <p><strong><code>mail_host</code></strong></p> <p>(required, string) Hostname of the mail server.</p> <p><strong><code>mail_port</code></strong></p> <p>(optional, integer) IMAP server port: 143 without TLS, 993 with TLS. Defaults to 143.</p> <p><strong><code>mail_user</code></strong></p> <p>(required, string) Username of the email account.</p> <p><strong><code>mail_password</code></strong></p> <p>(required, string) Password associated with the user account.</p> <p><strong><code>mail_ssl</code></strong></p> <p>(optional, boolean) Whether the mail server uses TLS or not. Defaults to true.</p> <p><strong><code>mail_starttls</code></strong></p> <p>(optional, boolean) Whether the mail server uses STARTTLS or not. Defaults to false.</p> <p><strong><code>folder</code></strong></p> <p>(optional, string) Folder in which to look for e-mail messages. Defaults to INBOX.</p> <p><strong><code>subject_regex</code></strong></p> <p>(optional, string) Regular expression to look for in the e-mail subject.</p> <p><strong><code>url_regex</code></strong></p> <p>(optional, string) Regular expression of the feed URL to look for in the e-mail body.</p> <p><strong><code>sent_from</code></strong></p> <p>(optional, string) Filter messages by the sender.</p> <p><strong><code>sent_to</code></strong></p> <p>(optional, string) Filter messages by the recipient.</p> <p><strong><code>ssl_ca_certificate</code></strong></p> <p>(optional, string) Path to trusted CA certificate. Applies only to IMAP connections, not HTTP. If the provided certificate is not found, the IMAP connection will fail on handshake. Defaults to no certificate.</p> <hr> <h3 id=generic-mail-attachment-fetcher>Generic Mail Attachment Fetcher <div id=intelmq.bots.collectors.mail.collector_mail_attach /></h3> <p>This bot collects messages from mailboxes and downloads the attachments. It uses the <a href=https://github.com/martinrusev/imbox><code>imbox</code></a> library.</p> <p>The resulting reports contains the following special fields:</p> <ul> <li><code>extra.email_date</code>: The content of the email's <code>Date</code> header</li> <li><code>extra.email_subject</code>: The subject of the email</li> <li><code>extra.email_from</code>: The email's from address</li> <li><code>extra.email_message_id</code>: The email's message ID</li> <li><code>extra.file_name</code>: The file name of the attachment or the file name in the attached archive if attachment is to uncompress.</li> </ul> <p>The fields can be used by parsers to identify the feed and are not automatically passed on to events.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.mail.collector_mail_attach</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>mail_host</code></strong></p> <p>(required, string) Hostname of the mail server.</p> <p><strong><code>mail_port</code></strong></p> <p>(optional, integer) IMAP server port: 143 without TLS, 993 with TLS. Default depends on SSL setting.</p> <p><strong><code>mail_user</code></strong></p> <p>(required, string) Username of the email account.</p> <p><strong><code>mail_password</code></strong></p> <p>(required, string) Password associated with the user account.</p> <p><strong><code>mail_ssl</code></strong></p> <p>(optional, boolean) Whether the mail server uses TLS or not. Defaults to true.</p> <p><strong><code>mail_starttls</code></strong></p> <p>(optional, boolean) Whether to use STARTTLS before authenticating to the server. Defaults to false.</p> <p><strong><code>folder</code></strong></p> <p>(optional, string) Folder in which to look for e-mail messages. Defaults to INBOX.</p> <p><strong><code>subject_regex</code></strong></p> <p>(optional, string) Regular expression to look for in the e-mail subject.</p> <p><strong><code>attach_regex</code></strong></p> <p>(optional, string) All attachments which match this <a href=https://docs.python.org/3/library/re.html#re.search>regular expression</a> will be processed. Defaults to <code>csv.zip</code>.</p> <p><strong><code>extract_files</code></strong></p> <p>(optional, boolean) Whether to extract compress files from the attachment. Defaults to true.</p> <p><strong><code>sent_from</code></strong></p> <p>(optional, string) Only process messages sent from this address. Defaults to null (any sender).</p> <p><strong><code>sent_to</code></strong></p> <p>(optional, string) Only process messages sent to this address. Defaults to null (any recipient).</p> <p><strong><code>ssl_ca_certificate</code></strong></p> <p>(optional, string) Path to trusted CA certificate. Applies only to IMAP connections, not HTTP. If the provided certificate is not found, the IMAP connection will fail on handshake. By default, no certificate is used.</p> <hr> <h3 id=generic-mail-body-fetcher>Generic Mail Body Fetcher <div id=intelmq.bots.collectors.mail.collector_mail_body /></h3> <p>This bot collect messages from mailboxes, forwards the bodies as reports. Each non-empty body with the matching content type is sent as individual report.</p> <p>The resulting reports contains the following special fields:</p> <ul> <li><code>extra.email_date</code>: The content of the email's <code>Date</code> header</li> <li><code>extra.email_subject</code>: The subject of the email</li> <li><code>extra.email_from</code>: The email's from address</li> <li><code>extra.email_message_id</code>: The email's message ID</li> </ul> <p><strong>Module:</strong> <code>intelmq.bots.collectors.mail.collector_mail_body</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>mail_host</code></strong></p> <p>(required, string) Hostname of the mail server.</p> <p><strong><code>mail_port</code></strong></p> <p>(optional, integer) IMAP server port: 143 without TLS, 993 with TLS. Defaults to 143.</p> <p><strong><code>mail_user</code></strong></p> <p>(required, string) Username of the email account.</p> <p><strong><code>mail_password</code></strong></p> <p>(required, string) Password associated with the user account.</p> <p><strong><code>mail_ssl</code></strong></p> <p>(optional, boolean) Whether the mail server uses TLS or not. Defaults to true.</p> <p><strong><code>folder</code></strong></p> <p>(optional, string) Folder in which to look for e-mail messages. Defaults to INBOX.</p> <p><strong><code>subject_regex</code></strong></p> <p>(optional, string) Regular expression to look for in the e-mail subject.</p> <p><strong><code>url_regex</code></strong></p> <p>(optional, string) Regular expression of the feed URL to look for in the e-mail body.</p> <p><strong><code>sent_from</code></strong></p> <p>(optional, string) Filter messages by the sender.</p> <p><strong><code>sent_to</code></strong></p> <p>(optional, string) Filter messages by the recipient.</p> <p><strong><code>ssl_ca_certificate</code></strong></p> <p>(optional, string) Path to trusted CA certificate. Applies only to IMAP connections, not HTTP. If the provided certificate is not found, the IMAP connection will fail on handshake. Defaults to no certificate.</p> <p><strong><code>content_types</code></strong></p> <p>(optional, boolean/array of strings) Which bodies to use based on the content_type. Defaults to <code>true</code> (same as <code>['html', 'plain']</code>) for all:</p> <ul> <li>string with comma separated values, e.g. <code>['html', 'plain']</code></li> <li><code>true</code>, <code>false</code>, <code>null</code>: Same as default value - <code>string</code>, e.g. <code>plain</code></li> </ul> <hr> <h3 id=github-api>Github API <div id=intelmq.bots.collectors.github_api.collector_github_contents_api /></h3> <p>Collects files matched by regular expression from GitHub repository via the GitHub API. Optionally with GitHub credentials, which are used as the Basic HTTP authentication.</p> <p><strong>Workflow</strong></p> <p>The optional authentication parameters provide a high limit of the GitHub API requests. With the git hub user authentication, the requests are rate limited to 5000 per hour, otherwise to 60 requests per hour.</p> <p>The collector recursively searches for <code>regex</code>-defined files in the provided <code>repository</code>. Additionally it adds extra file metadata defined by the <code>extra_fields</code>.</p> <p>The bot always sets the url, from which downloaded the file, as <code>feed.url</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.github_api.collector_github_contents_api</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>personal_access_token</code></strong></p> <p>(required, string) GitHub account personal access token <a href=https://developer.github.com/changes/2020-02-14-deprecating-password-auth/#removal>GitHub documentation: Creating a personal access token</a></p> <p><strong><code>repository</code></strong></p> <p>(required, string) GitHub target repository (<code>&lt;USER&gt;/&lt;REPOSITORY&gt;</code>)</p> <p><strong><code>regex</code></strong></p> <p>(optional, string) Valid regular expression of target files within the repository. Defaults to <code>.*.json</code>.</p> <p><strong><code>extra_fields</code></strong></p> <p>(optional, array of strings) Comma-separated list of extra fields from <a href=https://developer.github.com/v3/repos/contents/ >GitHub contents API</a>.</p> <hr> <h3 id=file>File <div id=intelmq.bots.collectors.file.collector_file /></h3> <p>This bot is capable of reading files from the local file-system. This is handy for testing purposes, or when you need to react to spontaneous events. In combination with the Generic CSV parser this should work great.</p> <p>The resulting reports contains the following special fields:</p> <ul> <li><code>feed.url</code>: The URI using the <code>file://</code> scheme and localhost, with the full path to the processed file.</li> <li><code>extra.file_name</code>: The file name (without path) of the processed file.</li> </ul> <p><strong>Chunking</strong></p> <p>Additionally, for line-based inputs the bot can split up large reports into smaller chunks.</p> <p>This is particularly important for setups that use Redis as a message queue which has a per-message size limitation of 512 MB.</p> <p>To configure chunking, set <code>chunk_size</code> to a value in bytes. <code>chunk_replicate_header</code> determines whether the header line should be repeated for each chunk that is passed on to a parser bot.</p> <p>Specifically, to configure a large file input to work around Redis' size limitation set <code>chunk_size</code> to something like 384000, i.e., ~384 MB.</p> <p><strong>Workflow</strong></p> <p>The bot loops over all files in <code>path</code> and tests if their file name matches *postfix, e.g. <code>*.csv</code>. If yes, the file will be read and inserted into the queue.</p> <p>If <code>delete_file</code> is set, the file will be deleted after processing. If deletion is not possible, the bot will stop.</p> <p>To prevent data loss, the bot also stops when no <code>postfix</code> is set and <code>delete_file</code> was set. This cannot be overridden.</p> <p>The bot always sets the file name as <code>feed.url</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.file.collector_file</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>path</code></strong></p> <p>(required, string) Path to file.</p> <p><strong><code>postfix</code></strong></p> <p>(required, string) The postfix (file ending) of the files to look for. For example [.csv].</p> <p><strong><code>delete_file</code></strong></p> <p>(optional, boolean) Whether to delete the file after reading. Defaults to false.</p> <hr> <h3 id=fireeye>FireEye <div id=intelmq.bots.collectors.fireeye.collector_mas /></h3> <p>This bot is capable of collecting hashes and URLs from a FireEye MAS appliance.</p> <p>The Python library <code>xmltodict</code> is required to run this bot.</p> <p><strong>Workflow</strong></p> <p>The bot collects all alerts which occurred during specified duration. After this we make a second call and check if there is additional information like domains and hashes available. After collecting the openioc data we send this information to the Fireeye parser.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.fireeye.collector_fireeye</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>host</code></strong></p> <p>(required, string) DNS name of the target appliance.</p> <p><strong><code>request_duration</code></strong></p> <p>(required, string) Allowed values: <code>24_hours</code> or <code>48_hours</code>. Length of the query in past eg. collect alerts from last 24hours/48hours.</p> <p><strong><code>http_username</code></strong></p> <p>(required, string) Password for authentication.</p> <p><strong><code>http_password</code></strong></p> <p>(required, string) Username for authentication.</p> <hr> <h3 id=kafka>Kafka <div id=intelmq.bots.collectors.kafka.collector /></h3> <p>Requires the <a href=https://pypi.org/project/kafka/ >kafka python library</a>.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.kafka.collector</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>topic</code></strong></p> <p>(required, string) Kafka topic the collector should get messages from.</p> <p><strong><code>bootstrap_servers</code></strong></p> <p>(required, string) Kafka server(s) and port the collector should connect to. Defaults to <code>localhost:9092</code></p> <p><strong><code>ssl_check_hostname</code></strong></p> <p>(optional, boolean) Whether to verify TLS certificates. Defaults to true.</p> <p><strong><code>ssl_client_certificate</code></strong></p> <p>(optional, string) Path to client certificate to use for TLS connections.</p> <p><strong><code>ssl_ca_certificate</code></strong></p> <p>(optional, string) Path to trusted CA certificate.</p> <hr> <h3 id=misp-generic>MISP Generic <div id=intelmq.bots.collectors.misp.collector /></h3> <p>Collects messages from <a href=https://github.com/MISP>MISP</a>, a malware information sharing platform server.</p> <p><strong>Workflow</strong></p> <p>This collector will search for events on a MISP server that have a [to_process] tag attached to them (see the [misp_tag_to_process] parameter) and collect them for processing by IntelMQ. Once the MISP event has been processed the [to_process] tag is removed from the MISP event and a [processed] tag is then attached (see the [misp_tag_processed] parameter).</p> <p><strong>NB.</strong> The MISP tags must be configured to be 'exportable' otherwise they will not be retrieved by the collector.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.misp.collector</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>misp_url</code></strong></p> <p>(required, string) URL of MISP server (with trailing '/').</p> <p><strong><code>misp_key</code></strong></p> <p>(required, string) MISP Authkey.</p> <p><strong><code>misp_tag_to_process</code></strong></p> <p>(required, string) MISP tag for events to be processed.</p> <p><strong><code>misp_tag_processed</code></strong></p> <p>(optional, string) MISP tag for processed events.</p> <p><strong><code>http_verify_cert</code></strong></p> <p>(optional, boolean) Verify the TLS certificate of the server. Defaults to true.</p> <hr> <h3 id=request-tracker>Request Tracker <div id=intelmq.bots.collectors.rt.collector_rt /></h3> <p>Request Tracker Collector fetches attachments from an RTIR instance.</p> <p>This rt bot will connect to RT and inspect the given <code>search_queue</code> for tickets matching all criteria in <code>search_*</code>, Any matches will be inspected. For each match, all (RT-) attachments of the matching RT tickets are iterated over and within this loop, the first matching filename in the attachment is processed. If none of the filename matches apply, the contents of the first (RT-) "history" item is matched against the regular expression for the URL (<code>url_regex</code>).</p> <p>The parameter <code>http_timeout_max_tries</code> is of no use in this collector.</p> <p><strong>Search</strong></p> <p>The parameters prefixed with <code>search_</code> allow configuring the ticket search.</p> <p>Empty strings and null as value for search parameters are ignored.</p> <p><strong>File downloads</strong></p> <p>Attachments can be optionally unzipped, remote files are downloaded with the <code>http_*</code> settings applied.</p> <p>If <code>url_regex</code> or <code>attachment_regex</code> are empty strings, false or null, they are ignored.</p> <p><strong>Ticket processing</strong></p> <p>Optionally, the RT bot can "take" RT tickets (i.e. the <code>user</code> is assigned this ticket now) and/or the status can be changed (leave <code>set_status</code> empty in case you don't want to change the status). Please note however that you <strong>MUST</strong> do one of the following: either "take" the ticket or set the status (<code>set_status</code>). Otherwise, the search will find the ticket every time and get stuck in an endless loop.</p> <p>In case a resource needs to be fetched and this resource is permanently not available (status code is 4xx), the ticket status will be set according to the configuration to avoid processing the ticket over and over. For temporary failures the status is not modified, instead the ticket will be skipped in this run.</p> <p><strong>Time search</strong></p> <p>To find only tickets newer than a given absolute or relative time, you can use the <code>search_not_older_than</code> parameter. Absolute time specification can be anything parseable by dateutil, best use a ISO format.</p> <p>Relative must be in this format: <code>[NUMBER] [TIMESPAN]s</code>, e.g. <code>3 days</code>. Timespan can be hour, day, week, month or year. Trailing 's' is supported for all timespans. Relative times are subtracted from the current time directly before the search is performed.</p> <p>The resulting reports contains the following special fields:</p> <ul> <li><code>rtir_id</code>: The ticket ID</li> <li><code>extra.email_subject</code> and <code>extra.ticket_subject</code>: The subject of the ticket</li> <li><code>extra.email_from</code> and <code>extra.ticket_requestors</code>: Comma separated list of the ticket's requestor's email addresses.</li> <li><code>extra.ticket_owner</code>: The ticket's owner name</li> <li><code>extra.ticket_status</code>: The ticket's status</li> <li><code>extra.ticket_queue</code>: The ticket's queue</li> <li><code>extra.file_name</code>: The name of the extracted file, the name of the downloaded file or the attachments' filename without <code>.gz</code> postfix.</li> <li><code>time.observation</code>: The creation time of the ticket or attachment.</li> </ul> <p><strong>Requirements</strong></p> <p>You need the rt-library &gt;= 1.9 and &lt; 3.0 from from nic.cz, available via <a href=https://pypi.org/project/rt/ >pypi</a>: <code>pip3 install rt&lt;3</code></p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.rt.collector_rt</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a> and <a href=#http-parameters>HTTP parameters</a>):</strong></p> <p><strong><code>extract_attachment</code></strong></p> <p>(optional, boolean/array of strings) See documentation of the Generic URL Fetcher parameter <code>extract_files</code> for more details.</p> <p><strong><code>extract_download</code></strong></p> <p>(optional, boolean/array of strings) See documentation of the Generic URL Fetcher parameter <code>extract_files</code> for more details.</p> <p><strong><code>uri</code></strong></p> <p>(optional, string) URL of the REST interface of the RT. Defaults to <code>http://localhost/rt/REST/1.0</code>.</p> <p><strong><code>user</code></strong></p> <p>(optional, string) RT username. Defaults to intelmq.</p> <p><strong><code>password</code></strong></p> <p>(optional, string) RT password. Defaults to password.</p> <p><strong><code>search_not_older_than</code></strong></p> <p>(optional, string) Absolute time (use ISO format) or relative time, e.g. <code>3 days</code>.</p> <p><strong><code>search_owner</code></strong></p> <p>(optional, string) Owner of the ticket to search for. Defaults to nobody.</p> <p><strong><code>search_queue</code></strong></p> <p>(optional, string) Queue of the ticket to search for. Defaults to Incident Reports.</p> <p><strong><code>search_requestor</code></strong></p> <p>(optional, string) E-mail address of the requestor.</p> <p><strong><code>search_status</code></strong></p> <p>(optional, string) Status of the ticket to search for. Defaults to new.</p> <p><strong><code>search_subject_like</code></strong></p> <p>(optional, string/array of strings) Part of the subject of the ticket to search for. Defaults to "Report".</p> <p><strong><code>search_subject_notlike</code></strong></p> <p>(optional, string/array of strings) Exclude subject containing given value, use list for multiple excluding values.</p> <p><strong><code>set_status</code></strong></p> <p>(optional, string) Status to set the ticket to after processing. Use false or null to keep current status. Defaults to open.</p> <p><strong><code>take_ticket</code></strong></p> <p>(optional, boolean) Whether to take the ticket. Defaults to true.</p> <p><strong><code>url_regex</code></strong></p> <p>(optional, string) Regular expression of an URL to search for in the ticket. Defaults to <code>https://dl.shadowserver.org/[a-zA-Z0-9?_-]*</code>.</p> <p><strong><code>attachment_regex</code></strong></p> <p>(optional, string) Eegular expression of an attachment in the ticket. Defaults to <code>\.csv\.zip$</code>.</p> <hr> <h3 id=rsync>Rsync <div id=intelmq.bots.collectors.rsync.collector_rsync /></h3> <p>This bot downloads a file via rsync and then load data from downloaded file. Downloaded file is located in <code>var/lib/bots/rsync_collector</code>.</p> <p>Requires the rsync executable.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.rsync.collector_rsync</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>file</code></strong></p> <p>(required, string) The filename to process, combined with <code>rsync_path</code>.</p> <p><strong><code>rsync_path</code></strong></p> <p>(required, string) Path to the directory of the file. Allowed values are local directory (such as <code>/home/username/</code>) or remote directory (such as <code>&lt;username@remote_host&gt;:/home/username/directory</code>).</p> <p><strong><code>rsync_file_path_formatting</code></strong></p> <p>(optional, boolean) Whether the file and rsync_path should be formatted by the given format. E.g. if the path is <code>/path/to_file/{time[%Y]}</code>, then the resulting path is <code>/path/to/file/2023</code> for the year 2023. (Python's <code>Format Specification Mini-Language &lt;https://docs.python.org/3/library/string.html#formatspec&gt;</code><em> is used for this.). You may use a <code>JSON</code> specifying <code>time-delta &lt;https://docs.python.org/3/library/datetime.html#datetime.timedelta&gt;</code></em> parameters to shift the current time accordingly. For example use <code>{"days": -1}</code> for the yesterday's date; the path <code>/path/to/file/{time[%Y-%m-%d]}</code> will get translated to "/path/to/file/2018-12-31" for the 1st Jan of 2023. Defaults to false.</p> <p><strong><code>extra_params</code></strong></p> <p>(optional, array of strings) A list of extra parameters to pass to rsync.</p> <p><strong><code>private_key</code></strong></p> <p>(optional, string) Private key to use for rsync authentication.</p> <p><strong><code>private_key_path</code></strong></p> <p>(optional, string) Path to private key to use for rsync authentication. Use <code>private_key</code> or <code>private_key_path</code>, not both.</p> <p><strong><code>strict_host_key_checking</code></strong></p> <p>(optional, boolean) Whether the host key should be checked. Defaults to false.</p> <p><strong><code>temp_directory</code></strong></p> <p>(optional, string) The temporary directory for rsync to use for collected files. Defaults to <code>/opt/intelmq/var/run/{BOT-ID}</code> or <code>/var/run/intelmq/{BOT-ID}</code>.</p> <hr> <h3 id=shadowserver-reports-api>Shadowserver Reports API <div id=intelmq.bots.collectors.shadowserver.collector_reports_api /></h3> <p>Connects to the <a href=https://www.shadowserver.org/what-we-do/network-reporting/api-documentation/ >Shadowserver API</a>, requests a list of all the reports for a specific country and processes the ones that are new.</p> <p>The Cache is required to memorize which files have already been processed (TTL needs to be high enough to cover the oldest files available!).</p> <p>The resulting reports contain the following special field:</p> <ul> <li><code>extra.file_name</code>: The name of the downloaded file, with fixed filename extension.</li> </ul> <p><strong>Module:</strong> <code>intelmq.bots.collectors.shadowserver.collector_reports_api</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a> and <a href=#cache-parameters>cache parameters</a>):</strong></p> <p><strong><code>apikey</code></strong></p> <p>(required, string) Your Shadowserver API key.</p> <p><strong><code>secret</code></strong></p> <p>(required, string) Your Shadowserver API secret.</p> <p><strong><code>reports</code></strong></p> <p>(required, string/array of strings) An array of strings (or a list of comma-separated values) of the mailing lists you want to process.</p> <p><strong><code>types</code></strong></p> <p>(optional, string/array of strings) An array of strings (or a list of comma-separated values) with the names of report types you want to process. If you leave this empty, all the available reports will be downloaded and processed (i.e. 'scan', 'drones', 'intel', 'sandbox_connection', 'sinkhole_combined'). The possible report types are equivalent to the file names defined the the schema. Please see the Supported Reports of the <a href=#intelmq.bots.parsers.shadowserver.parser>Shadowserver parser</a> for details.</p> <p><strong>Sample configuration</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=w>  </span><span class=nt>shadowserver-collector</span><span class=p>:</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Our bot responsible for getting reports from Shadowserver</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>    </span><span class=nt>group</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Collector</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>    </span><span class=nt>module</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">intelmq.bots.collectors.shadowserver.collector_reports_api</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Shadowserver_Collector</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>    </span><span class=nt>parameters</span><span class=p>:</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>      </span><span class=nt>destination_queues</span><span class=p>:</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>        </span><span class=nt>_default</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>shadowserver-parser-queue</span><span class="p p-Indicator">]</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=w>      </span><span class=nt>file_format</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">csv</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=w>      </span><span class=nt>api_key</span><span class=p>:</span><span class=w> </span><span class=s>&quot;$API_KEY_received_from_the_shadowserver_foundation&quot;</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=w>      </span><span class=nt>secret</span><span class=p>:</span><span class=w> </span><span class=s>&quot;$SECRET_received_from_the_shadowserver_foundation&quot;</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=w>    </span><span class=nt>run_mode</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">continuous</span>
</code></pre></div> <hr> <h3 id=shodan-stream>Shodan Stream <div id=intelmq.bots.collectors.shodan.collector_stream /></h3> <p>Queries the Shodan Streaming API.</p> <p>Requires the shodan library to be installed:</p> <ul> <li> <p><a href=https://github.com/achillean/shodan-python/ >https://github.com/achillean/shodan-python/</a></p> </li> <li> <p><a href=https://pypi.org/project/shodan/ >https://pypi.org/project/shodan/</a></p> </li> </ul> <p><strong>Module:</strong> <code>intelmq.bots.collectors.shodan.collector_stream</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a> and <a href=#http-parameters>HTTP parameters</a>):</strong></p> <p>Only the proxy is used (requires <code>shodan-python &gt; 1.8.1</code>). Certificate is always verified.</p> <p><strong><code>countries</code></strong></p> <p>() A list of countries to query for. If it is a string, it will be spit by <code>,</code>.</p> <p><strong><code>alert</code></strong></p> <p>() Alert ID from monitor.shodan.io.</p> <p>If the stream is interrupted, the connection will be aborted using the timeout parameter. No error will be logged if the number of consecutive connection fails does not reach the parameter <code>error_max_retries</code>. Instead of errors, an INFO message is logged. This is a measurement against too frequent ERROR logging messages. The consecutive connection fails are reset if a data line has been successfully transferred. If the consecutive connection fails reaches the parameter <code>error_max_retries</code>, an exception will be thrown and <code>rate_limit</code> applies, if not null.</p> <hr> <h3 id=tcp>TCP <div id=intelmq.bots.collectors.tcp.collector /></h3> <p>TCP is the bot responsible to receive events on a TCP port (ex: from TCP Output of another IntelMQ instance). Might not be working on Python 3.4.6.</p> <p><strong>Response</strong></p> <p>TCP collector just sends an "OK" message after every received message, this should not pose a problem for an arbitrary input. If you intend to link two IntelMQ instance via TCP, have a look at the TCP output bot documentation.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.tcp.collector</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>ip</code></strong></p> <p>(required, string) IP of the destination server.</p> <p><strong><code>port</code></strong></p> <p>(required, integer) Port of destination server.</p> <hr> <h3 id=blueliv-crimeserver>Blueliv Crimeserver <div id=intelmq.bots.collectors.blueliv.collector_crimeserver /></h3> <p>Collects report messages from Blueliv API.</p> <p>For more information visit <a href=https://github.com/Blueliv/api-python-sdk>https://github.com/Blueliv/api-python-sdk</a></p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.blueliv.collector_crimeserver</code></p> <p><strong>Requirements</strong></p> <p>Install the required library:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>pip3<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>intelmq/bots/collectors/blueliv/REQUIREMENTS.txt
</code></pre></div> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>api_key</code></strong></p> <p>(required, string) location of information resource, see <a href="https://map.blueliv.com/?redirect=get-started#signup">https://map.blueliv.com/?redirect=get-started#signup</a></p> <p><strong><code>api_url</code></strong></p> <p>(optional, string) The optional API endpoint. Defaults to <code>https://freeapi.blueliv.com</code>.</p> <hr> <h3 id=calidog-certstream>Calidog Certstream <div id=intelmq.bots.collectors.calidog.collector_certstream /></h3> <p>A Bot to collect data from the Certificate Transparency Log (CTL). This bot works based on certstream library (<a href=https://github.com/CaliDog/certstream-python>https://github.com/CaliDog/certstream-python</a>)</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.calidog.collector_certstream</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <hr> <h3 id=eset-eti>ESET ETI <div id=intelmq.bots.collectors.eset.collector /></h3> <p>Collects data from ESET ETI TAXII server.</p> <p>For more information visit <a href=https://www.eset.com/int/business/services/threat-intelligence/ >https://www.eset.com/int/business/services/threat-intelligence/</a>.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.eset.collector</code></p> <p><strong>Requirements</strong></p> <p>Install the required <code>cabby</code> library:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>pip3<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>intelmq/bots/collectors/eset/REQUIREMENTS.txt
</code></pre></div> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>username</code></strong></p> <p>(required, string) Your username.</p> <p><strong><code>password</code></strong></p> <p>(required, string) Your password.</p> <p><strong><code>endpoint</code></strong></p> <p>(optional, string) Defaults to <code>eti.eset.com</code>.</p> <p><strong><code>time_delta</code></strong></p> <p>(optional, integer) The time (in seconds) span to look back. Default to 3600.</p> <p><strong><code>collection</code></strong></p> <p>(required, string) The collection to fetch.</p> <hr> <h3 id=mcafee-opendxl>McAfee openDXL <div id=intelmq.bots.collectors.opendxl.collector /></h3> <p>Collects messages via McAfee openDXL.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.opendxl.collector</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>dxl_config_file</code></strong></p> <p>(required, string) Path to the the configuration file containing required information to connect.</p> <p><strong><code>dxl_topic</code></strong></p> <p>(optional, string) Name of the DXL topic to subscribe to. Defaults to <code>/mcafee/event/atd/file/report</code>.</p> <hr> <h3 id=microsoft-azure>Microsoft Azure <div id=intelmq.bots.collectors.microsoft.collector_azure /></h3> <p>Collects blobs from Microsoft Azure using their library.</p> <p>Iterates over all blobs in all containers in an Azure storage. The Cache is required to memorize which files have already been processed (TTL needs to be high enough to cover the oldest files available!).</p> <p>This bot significantly changed in a backwards-incompatible way in IntelMQ Version 2.2.0 to support current versions of the Microsoft Azure Python libraries. <code>azure-storage-blob&gt;=12.0.0</code> is required.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.microsoft.collector_azure</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a> and <a href=#cache-parameters>cache parameters</a>):</strong></p> <p><strong><code>connection_string</code></strong></p> <p>(required, string) Connection string as given by Microsoft.</p> <p><strong><code>container_name</code></strong></p> <p>(required, string) Name of the container to connect to.</p> <hr> <h3 id=microsoft-interflow>Microsoft Interflow <div id=intelmq.bots.collectors.microsoft.collector_interflow /></h3> <p>This bot collects files from Microsoft Interflow API.</p> <p>Iterates over all files available by this API. Make sure to limit the files to be downloaded with the parameters, otherwise you will get a lot of data! The cache is used to remember which files have already been downloaded. Make sure the TTL is high enough, higher than <code>not_older_than</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.microsoft.collector_interflow</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>api_key</code></strong></p> <p>(required, string) API generated in their portal.</p> <p><strong><code>file_match</code></strong></p> <p>(optional, string) Regular expression to match file names.</p> <p><strong><code>not_older_than</code></strong></p> <p>(optional, integer/datetime) an optional relative (minutes) or absolute time (UTC is assumed) expression to determine the oldest time of a file to be downloaded.</p> <p><strong><code>redis_cache_*</code> and especially <code>redis_cache_ttl</code></strong></p> <p>Settings for the cache where file names of downloaded files are saved. The cache's TTL must always be bigger than <code>not_older_than</code>.</p> <p><strong>Additional functionalities</strong></p> <p>Files are automatically ungzipped if the filename ends with <code>.gz</code>.</p> <hr> <h3 id=stomp>STOMP <div id=intelmq.bots.collectors.stomp.collector /></h3> <p>Collects messages from a STOMP server.</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.stomp.collector</code></p> <p><strong>Requirements</strong></p> <p>Install the <code>stomp.py</code> library from PyPI:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>pip3<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>intelmq/bots/collectors/stomp/REQUIREMENTS.txt
</code></pre></div> <p>Alternatively, you may want to install it using your OS's native packaging tools, e.g.:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>apt<span class=w> </span>install<span class=w> </span>python3-stomp
</code></pre></div> <p>Apart from that, depending on what STOMP server you connect to, you may need to obtain, from the organization or company owning the server, one or more of the following security/authentication-related resources:</p> <ul> <li>CA certificate file;</li> <li>either: <em>client certificate</em> and <em>client certificate's key</em> files, or: <em>username</em> (STOMP <em>login</em>) and <em>password</em> (STOMP <em>passcode</em>).</li> </ul> <p>Also, you will need to know an appropriate STOMP <em>destination</em> (aka <em>exchange point</em>), e.g. <code>/exchange/my.example.org/*.*.*.*</code>.</p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>server</code></strong></p> <p>(required, string) STOMP server's hostname or IP, e.g. "n6stream.cert.pl" (which is default)</p> <p><strong><code>port</code></strong></p> <p>(optional, integer) STOMP server's port number (default: 61614)</p> <p><strong><code>exchange</code></strong></p> <p>(required, string) STOMP <em>destination</em> to subscribe to, e.g. <code>"/exchange/my.org/*.*.*.*"</code></p> <p><strong><code>heartbeat</code></strong></p> <p>(optional, integer) default: 6000</p> <p><strong><code>ssl_ca_certificate</code></strong></p> <p>(optional, string) Path to CA file, or empty string to load system's default CA certificates</p> <p><strong><code>auth_by_ssl_client_certificate</code></strong></p> <p>(optional, boolean) Default: true (note: false is needed for new <em>n6</em> auth)</p> <p><strong><code>ssl_client_certificate</code></strong></p> <p>(optional, string) Path to client certificate to use for TLS connections.</p> <p><strong><code>ssl_client_certificate_key</code></strong></p> <p>(optional, string) Path to client private key to use for TLS connections.</p> <p><strong><code>username</code></strong></p> <p>(optional, string) Username to use.</p> <p><strong><code>password</code></strong></p> <p>(optional, string) Password to use.</p> <hr> <h3 id=twitter-remove>Twitter (REMOVE?) <div id=intelmq.bots.collectors.twitter.collector_twitter /></h3> <p>Collects tweets.</p> <p>Collects tweets from target_timelines. Up to tweet_count tweets from each user and up to timelimit back in time. The tweet text is sent separately and if allowed, links to pastebin are followed and the text sent in a separate report</p> <p><strong>Module:</strong> <code>intelmq.bots.collectors.twitter.collector_twitter</code></p> <p><strong>Parameters (also expects <a href=#feed-parameters>feed parameters</a>):</strong></p> <p><strong><code>target_timelines</code></strong></p> <p>() screen_names of twitter accounts to be followed</p> <p><strong><code>tweet_count</code></strong></p> <p>() number of tweets to be taken from each account</p> <p><strong><code>timelimit</code></strong></p> <p>() maximum age of the tweets collected in seconds</p> <p><strong><code>follow_urls</code></strong></p> <p>() list of screen_names for which URLs will be followed</p> <p><strong><code>exclude_replies</code></strong></p> <p>() exclude replies of the followed screen_names</p> <p><strong><code>include_rts</code></strong></p> <p>() whether to include retweets by given screen_name</p> <p><strong><code>consumer_key</code></strong></p> <p>() Twitter API login data</p> <p><strong><code>consumer_secret</code></strong></p> <p>() Twitter API login data</p> <p><strong><code>access_token_key</code></strong></p> <p>() Twitter API login data</p> <p><strong><code>access_token_secret</code></strong></p> <p>() Twitter API login data</p> <h2 id=parser-bots>Parser Bots</h2> <p>If not set differently during parsing, all parser bots copy the following fields from the report to an event:</p> <ul> <li><code>feed.accuracy</code></li> <li><code>feed.code</code></li> <li><code>feed.documentation</code></li> <li><code>feed.name</code></li> <li><code>feed.provider</code></li> <li><code>feed.url</code></li> <li><code>rtir_id</code></li> <li><code>time.observation</code></li> </ul> <h3 id=common-parameters>Common parameters</h3> <h4 id=default_fields><code>default_fields</code></h4> <p>(optional, object) Map of statically added fields to each event (only applied if parsing the event doesn't set the value).</p> <p>example usage:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nt>defaults_fields</span><span class=p>:</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>  </span><span class=nt>classification.type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">c2-server</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>  </span><span class=nt>protocol.transport</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
</code></pre></div> <h4 id=copy_collector_provided_fields><code>copy_collector_provided_fields</code></h4> <p>(optional, list) List of additional fields to be copy from the report (only applied if parsing the event doesn't set the value).</p> <p>Example usage:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=nt>copy_collector_provided_fields</span><span class=p>:</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">extra.file_name</span>
</code></pre></div> <hr> <h3 id=abusech-feodo-tracker>Abuse.ch Feodo Tracker <div id=intelmq.bots.parsers.abusech.parser_feodotracker /></h3> <p>Parses data from Abuse.ch Feodo Tracker (JSON format).</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.abusech.parser_feodotracker</code></p> <p>No additional parameters.</p> <hr> <h3 id=alienvault-api>AlienVault API</h3> <p>Parses data from AlienVault API.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.alienvault.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=alienvault-otx>AlienVault OTX</h3> <p>Parses data from AlientVault Open Threat Exchange (OTX).</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.alienvault.parser_otx</code></p> <p>No additional parameters.</p> <hr> <h3 id=anubisnetworks-cyberfeed-stream>AnubisNetworks Cyberfeed Stream <div id=intelmq.bots.parsers.anubisnetworks.parser /></h3> <p>Parses data from AnubisNetworks Cyberfeed Stream.</p> <p>The feed format changes over time. The parser supports at least data from 2016 and 2020.</p> <p>Events with the Malware "TestSinkholingLoss" are ignored, as they are for the feed provider's internal purpose only and should not be processed at all.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.anubisnetworks.parser</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>use_malware_family_as_classification_identifier</code></strong></p> <p>(optional, boolean) Use the <code>malw.family</code> field as <code>classification.type</code>. If false, check if the same as <code>malw.variant</code>. If it is the same, it is ignored. Otherwise saved as <code>extra.malware.family</code>. Defaults to true.</p> <hr> <h3 id=bambenek>Bambenek <div id=intelmq.bots.parsers.bambenek.parser /></h3> <p>Parses data from Bambenek DGA, Domain, and IP feeds.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.bambenek.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=blocklistde>Blocklist.de <div id=intelmq.bots.parsers.blocklistde.parser /></h3> <p>Parses data from Blocklist.de feeds.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.blocklistde.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=blueliv-crimeserver_1>Blueliv Crimeserver <div id=intelmq.bots.parsers.blueliv.parser_crimeserver /></h3> <p>Parses data from Blueliv Crimeserver feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.blueliv.parser_crimeserver</code></p> <p>No additional parameters.</p> <hr> <h3 id=calidog-certstream_1>Calidog Certstream <div id=intelmq.bots.parsers.calidog.parser_certstream /></h3> <p>Parses data from Certificate Transparency Log.</p> <p>For each domain in the <code>leaf_cert.all_domains</code> object one event with the domain in <code>source.fqdn</code> (and <code>source.ip</code> as fallback) is produced. The seen-date is saved in <code>time.source</code> and the classification type is <code>other</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.calidog.parser_certstream</code></p> <p>No additional parameters.</p> <hr> <h3 id=cert-eu>CERT-EU <div id=intelmq.bots.parsers.certeu.parser_csv /></h3> <p>Parses data from CERT-EU feed (CSV).</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.certeu.parser_csv</code></p> <p>No additional parameters.</p> <hr> <h3 id=ci-army>CI Army <div id=intelmq.bots.parsers.ci_army.parser /></h3> <p>Parses data from CI Army feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.ci_army.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=cleanmx>CleanMX <div id=intelmq.bots.parsers.cleanmx.parser /></h3> <p>Parses data from CleanMX feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.cleanmx.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=team-cymru-cap>Team Cymru CAP <div id=intelmq.bots.parsers.cymru.parser_cap_program /></h3> <p>Parses data from Team Cymru's CSIRT Assistance Program (CAP) feed.</p> <p>There are two different feeds available:</p> <ul> <li><code>infected_$date.txt</code> ("old")</li> <li><code>$certname_$date.txt</code> ("new")</li> </ul> <p>The new will replace the old at some point in time, currently you need to fetch both. The parser handles both formats.</p> <p><strong>Old feed</strong></p> <p>As little information on the format is available, the mappings might not be correct in all cases. Some reports are not implemented at all as there is no data available to check if the parsing is correct at all. If you do get errors like <code>Report ... not implement</code> or similar please open an issue and report the (anonymized) example data. Thanks.</p> <p>The information about the event could be better in many cases but as Cymru does not want to be associated with the report, we can't add comments to the events in the parser, because then the source would be easily identifiable for the recipient.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.cymru.parser_cap_program</code></p> <p>No additional parameters.</p> <hr> <h3 id=team-cymru-full-bogons>Team Cymru Full Bogons <div id=intelmq.bots.parsers.cymru.parser_full_bogons /></h3> <p>Parses data from full bogons feed.</p> <p><a href=http://www.team-cymru.com/bogon-reference.html>http://www.team-cymru.com/bogon-reference.html</a></p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.cymru.parser_full_bogons</code></p> <p>No additional parameters.</p> <hr> <h3 id=cznic-haas>CZ.NIC HaaS <div id=intelmq.bots.parsers.cznic.parser_haas /></h3> <p>Parses data from CZ.NIC Honeypot as a service (HaaS) feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.cznic.parser_haas</code></p> <p>No additional parameters.</p> <hr> <h3 id=cznic-proki>CZ.NIC PROKI <div id=intelmq.bots.parsers.cznic.parser_proki /></h3> <p>Parses data from CZ.NIC PROKI API.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.cznic.parser_proki</code></p> <p>No additional parameters.</p> <hr> <h3 id=danger-rulez>Danger Rulez <div id=intelmq.bots.parsers.danger_rulez.parser /></h3> <p>Parses data from Danger Rulez SSH blocklist.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.danger_rulez.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=dataplane>Dataplane <div id=intelmq.bots.parsers.dataplane.parser /></h3> <p>Parses data from Dataplane feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.dataplane.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=dshield-asn>DShield ASN <div id=intelmq.bots.parsers.dshield.parser_asn /></h3> <p>Parses data from DShield ASN feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.dshield.parser_asn</code></p> <p>No additional parameters.</p> <hr> <h3 id=dshield-block>DShield Block <div id=intelmq.bots.parsers.dshield.parser_block /></h3> <p>Parses data from DShield Block feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.dshield_parser_block</code></p> <p>No additional parameters.</p> <hr> <h3 id=eset>ESET <div id=intelmq.bots.parsers.eset.parser /></h3> <p>Parses data from ESET ETI TAXII server.</p> <p>Supported collections:</p> <ul> <li>"ei.urls (json)"</li> <li>"ei.domains v2 (json)"</li> </ul> <p><strong>Module:</strong> <code>intelmq.bots.parsers.eset.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=dyn-todo>Dyn (TODO)</h3> <hr> <h3 id=fireeye_1>FireEye <div id=intelmq.bots.parsers.fireeye.parser /></h3> <p>Parses data from FireEye MAS appliance.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.fireeye.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=fraunhofer-dga>Fraunhofer DGA <div id=intelmq.bots.parsers.fraunhofer.parser_dga /></h3> <p>Parses data from Fraunhofer DGA feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.fraunhofer.parser_dga</code></p> <p>No additional parameters.</p> <hr> <h3 id=generic-csv>Generic CSV <div id=intelmq.bots.parsers.generic.parser_csv /></h3> <p>Parses CSV data.</p> <p>Lines starting with <code>#</code> are skipped. Headers won't be interpreted.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.generic.parser_csv</code></p> <p><strong>Parameters</strong></p> <p><strong><code>columns</code></strong></p> <p>(required, string/array of strings) A list of strings or a string of comma-separated values with field names. The names must match the IntelMQ Data Format field names. Empty column specifications and columns named <code>__IGNORE__</code> are ignored. E.g.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.ip&quot;</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.fqdn&quot;</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;extra.http_host_header&quot;</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;__IGNORE__&quot;</span>
</code></pre></div> <p>is equivalent to:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nt>columns</span><span class=p>:</span><span class=w> </span><span class=s>&quot;source.ip,source.fqdn,extra.http_host_header,__IGNORE__&quot;</span>
</code></pre></div> <p>The fourth column is not used in this example.</p> <p>It is possible to specify multiple columns using the <code>|</code> character. E.g.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.url|source.fqdn|source.ip&quot;</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.fqdn&quot;</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;extra.http_host_header&quot;</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;__IGNORE__&quot;</span>
</code></pre></div> <p>First, the bot will try to parse the value as URL, if it fails, it will try to parse it as FQDN, if that fails, it will try to parse it as IP, if that fails, an error will be raised. Some use cases:</p> <ul> <li>Mixed data set, e.g. URL/FQDN/IP/NETMASK:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.url|source.fqdn|source.ip|source.network&quot;</span>
</code></pre></div> <ul> <li>Parse a value and ignore if it fails:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.url|__IGNORE__&quot;</span>
</code></pre></div> <p><strong><code>column_regex_search</code></strong></p> <p>(optional, object) A dictionary mapping field names (as given per the columns parameter) to regular expression. The field is evaluated using <code>re.search</code>. Eg. to get the ASN out of <code>AS1234</code> use: <code>{"source.asn": "[0-9]*"}</code>. Make sure to properly escape any backslashes in your regular expression (see also this <a href=https://github.com/certtools/intelmq/issues/1579>issue</a>).</p> <p><strong><code>compose_fields</code></strong></p> <p>(optional, object) Compose fields from multiple columns, e.g. with data like this:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a># Host,Path
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>example.com,/foo/
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>example.net,/bar/
</code></pre></div> <p>Using this parameter:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=nt>compose_fields</span><span class=p>:</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=w>  </span><span class=nt>source.url</span><span class=p>:</span><span class=w> </span><span class=s>&quot;http://{0}{1}&quot;</span>
</code></pre></div> <p>You get:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>http://example.com/foo/
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>http://example.net/bar/
</code></pre></div> <p>in the respective <code>source.url</code> fields. The value in the dictionary mapping is formatted whereas the columns are available with their index.</p> <p><strong><code>default_url_protocol</code></strong></p> <p>(optional, string) For URLs you can give a default protocol which will be prepended to the data. Defaults to null.</p> <p><strong><code>delimiter</code></strong></p> <p>(optional, string) Character used for columns separation. Defaults to <code>,</code> (comma).</p> <p><strong><code>skip_header</code></strong></p> <p>(optional, boolean/integer) Whether to skip the first N lines of the input (true equals to 1, false requalis to 0). Lines starting with <code>#</code> will be skipped additionally, make sure you do not skip more lines than needed! Defaults to false/0.</p> <p><strong><code>time_format</code></strong></p> <p>(optional, string) Allowed values: <code>timestamp</code>, <code>windows_nt</code> or <code>epoch_millis</code>. When <code>null</code> then fuzzy time parsing is used. Defaults to null.</p> <p><strong><code>type</code></strong></p> <p>(optional, string) Set the <code>classification.type</code> statically. Deprecated in favour of <a href=#default_fields><code>default_fields</code></a> . Will be removed in IntelMQ 4.0.0.</p> <p><strong><code>data_type</code></strong></p> <p>(optional, object) Sets the data of specific type, currently only <code>json</code> is a supported value.</p> <p>Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source.ip</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source.url</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">extra.tags</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=nt>data_type</span><span class=p>:</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>  </span><span class=nt>extra.tags</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
</code></pre></div> <p>It will ensure that <code>extra.tags</code> is treated as JSON.</p> <p><strong><code>filter_text</code></strong></p> <p>(optional, string) Only process the lines containing or not containing specified text. It is expected to be used in conjunction with <code>filter_type</code>.</p> <p><strong><code>filter_type</code></strong></p> <p>(optional, string) Allowed values: <code>whitelist</code> or <code>blacklist</code>. When <code>whitelist</code> is used, only lines containing the text specified in <code>filter_text</code> option will be processed. When <code>blacklist</code> is used, only lines NOT containing the text will be processed.</p> <p>Example (processing ipset format files):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=nt>filter_text</span><span class=p>:</span><span class=w> </span><span class=s>&#39;ipset</span><span class=nv> </span><span class=s>add</span><span class=nv> </span><span class=s>&#39;</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=nt>filter_type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">whitelist</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">__IGNORE__</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">__IGNORE__</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">__IGNORE__</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source.ip</span>
</code></pre></div> <p><strong><code>type_translation</code></strong></p> <p>(optional, object) If the source does have a field with information for <code>classification.type</code>, but it does not correspond to IntelMQ's types, you can map them to the correct ones. The <code>type_translation</code> field can hold a dictionary, or a string with a JSON dictionary which maps the feed's values to IntelMQ's.</p> <p>Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=nt>type_translation</span><span class=p>:</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=w>  </span><span class=nt>malware_download</span><span class=p>:</span><span class=w> </span><span class=s>&quot;malware-distribution&quot;</span>
</code></pre></div> <p><strong><code>columns_required</code></strong></p> <p>(optional, array of booleans) An array of true/false for each column. By default, it is true for every column.</p> <hr> <h3 id=github-feed>Github Feed <div id=intelmq.bots.parsers.github_feed.parser /></h3> <p>Parses data publicly available on GitHub (should receive from <code>github_api</code> collector).</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.github_feed.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=have-i-been-pwned-callback>Have I Been Pwned Callback <div id=intelmq.bots.parsers.hibp.parser_callback /></h3> <p>Parsers data from the callback of Have I Been Pwned Enterprise Subscription.</p> <p>Parses breaches and pastes and creates one event per e-mail address. The e-mail address is stored in <code>source.account</code> . <code>classification.type</code> is <code>leak</code> and <code>classification.identifier</code> is <code>breach</code> or <code>paste</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.hibp.parser_callback</code></p> <p>No additional parameters.</p> <hr> <h3 id=html-table>HTML Table <div id=intelmq.bots.parsers.html_table.parser /></h3> <p>Parses tables in HTML documents.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.html_table.parser</code></p> <p><strong>Parameters:</strong></p> <p>(required, string/array of strings) A list of strings or a string of comma-separated values with field names. The names must match the IntelMQ Data Format field names. Empty column specifications and columns named <code>__IGNORE__</code> are ignored. E.g.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.ip&quot;</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.fqdn&quot;</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;extra.http_host_header&quot;</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;__IGNORE__&quot;</span>
</code></pre></div> <p>is equivalent to:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=nt>columns</span><span class=p>:</span><span class=w> </span><span class=s>&quot;source.ip,source.fqdn,extra.http_host_header,__IGNORE__&quot;</span>
</code></pre></div> <p>The fourth column is not used in this example.</p> <p>It is possible to specify multiple columns using the <code>|</code> character. E.g.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.url|source.fqdn|source.ip&quot;</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.fqdn&quot;</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;extra.http_host_header&quot;</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;__IGNORE__&quot;</span>
</code></pre></div> <p>First, the bot will try to parse the value as URL, if it fails, it will try to parse it as FQDN, if that fails, it will try to parse it as IP, if that fails, an error will be raised. Some use cases:</p> <ul> <li>Mixed data set, e.g. URL/FQDN/IP/NETMASK:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.url|source.fqdn|source.ip|source.network&quot;</span>
</code></pre></div> <ul> <li>Parse a value and ignore if it fails:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;source.url|__IGNORE__&quot;</span>
</code></pre></div> <p><strong><code>ignore_values</code></strong></p> <p>(optional, string/array of strings) A list of strings or a string of comma-separated values which are ignored when encountered.</p> <p>Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=nt>ignore_values</span><span class=p>:</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;&quot;</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;unknown&quot;</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;Not</span><span class=nv> </span><span class=s>listed&quot;</span>
</code></pre></div> <p>The following configuration will lead to assigning all values to <code>malware.name</code> and <code>extra.SBL</code> except <code>unknown</code> and <code>Not listed</code> respectively.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source.url</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">malware.name</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">extra.SBL</span>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=nt>ignore_values</span><span class=p>:</span>
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&#39;&#39;</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">unknown</span>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Not listed</span>
</code></pre></div> <p>Parameters <code>columns</code> and <code>ignore_values</code> <strong>must have same length!</strong></p> <p><strong><code>attribute_name</code></strong></p> <p>(optional, string) Filtering table with table attributes. To be used in conjunction with <code>attribute_value</code>. E.g. <code>class</code>, <code>id</code>, <code>style</code>.</p> <p><strong><code>attribute_value</code></strong></p> <p>(optional, string) To filter all tables with attribute <code>class='details'</code> use</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=nt>attribute_name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;class&quot;</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=nt>attribute_value</span><span class=p>:</span><span class=w> </span><span class=s>&quot;details&quot;</span>
</code></pre></div> <p><strong><code>table_index</code></strong></p> <p>(optional, integer) Index of the table if multiple tables present. If <code>attribute_name</code> and <code>attribute_value</code> given, index according to tables remaining after filtering with table attribute. Defaults to 0.</p> <p><strong><code>split_column</code></strong></p> <p>(optional, ) Padded column to be split to get values, to be used in conjunction with <code>split_separator</code> and <code>split_index</code>, optional.</p> <p><strong><code>split_separator</code></strong></p> <p>(optional, string) Delimiter string for padded column.</p> <p><strong><code>split_index</code></strong></p> <p>(optional, integer) Index of unpadded string in returned list from splitting <code>split_column</code> with <code>split_separator</code> as delimiter string. Defaults to 0.</p> <p>Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=nt>split_column</span><span class=p>:</span><span class=w> </span><span class=s>&quot;source.fqdn&quot;</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=nt>split_separator</span><span class=p>:</span><span class=w> </span><span class=s>&quot;</span><span class=nv> </span><span class=s>&quot;</span>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=nt>split_index</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div> <p>With above configuration, column corresponding to <code>source.fqdn</code> with value <code>D lingvaworld.ru</code> will be assigned as <code>source.fqdn: lingvaworld.ru</code>.</p> <p><strong><code>skip_table_head</code></strong></p> <p>(optional, boolean) Skip the first row of the table. Defaults to true.</p> <p><strong><code>default_url_protocol</code></strong></p> <p>(optional, string) For URLs you can give a default protocol which will be pretended to the data. Defaults to <code>http://</code>.</p> <p><strong><code>time_format</code></strong></p> <p>(optional, string) Allowed values: <code>timestamp</code>, <code>windows_nt</code> or <code>epoch_millis</code>. When <code>null</code> then fuzzy time parsing is used. Defaults to null.</p> <p><strong><code>html_parser</code></strong></p> <p>(optional, string) The HTML parser to use. Allowed values: <code>html.parser</code> or <code>lxml</code> (see also <a href=https://www.crummy.com/software/BeautifulSoup/bs4/doc/ >https://www.crummy.com/software/BeautifulSoup/bs4/doc/</a>). Defaults to <code>html.parser</code>.</p> <hr> <h3 id=json-todo>JSON (TODO) <div id=intelmq.bots.parsers.json.parser /></h3> <p>TODO</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.json.parser</code></p> <hr> <h3 id=keyvalue-parser>Key=Value Parser <div id=intelmq.bots.parsers.key_value.parser /></h3> <p>Parses text lines in key=value format, for example FortiGate firewall logs.</p> <p><strong>Parsing limitations</strong></p> <p>The input must not have (quoted) occurrences of the separator in the values. For example, this is not parsable (with space as separator):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a>key=&quot;long value&quot; key2=&quot;other value&quot;
</code></pre></div> <p>In firewall logs like FortiGate, this does not occur. These logs usually look like:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>srcip=192.0.2.1 srcmac=&quot;00:00:5e:00:17:17&quot;
</code></pre></div> <p><strong>Module:</strong> <code>intelmq.bots.parsers.key_value.parser</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>pair_separator</code></strong></p> <p>(optional, string) String separating key=value pairs. Defaults to space.</p> <p><strong><code>kv_separator</code></strong></p> <p>(optional, string) String separating the key and the value. Defaults to <code>=</code>.</p> <p><strong><code>keys</code></strong></p> <p>(optional, object) Mapping of original key names to IntelMQ Data Format.</p> <p>Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=nt>keys</span><span class=p>:</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=w>  </span><span class=nt>srcip</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source.ip</span>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=w>  </span><span class=nt>dstip</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">destination.ip</span>
</code></pre></div> <p>The value mapped to <code>time.source</code> is parsed. If the value is numeric, it is interpreted. Otherwise, or if it fails, it is parsed fuzzy with dateutil. If the value cannot be parsed, a warning is logged per line.</p> <p><strong><code>strip_quotes</code></strong></p> <p>(optional, boolean) Whether to remove opening and closing quotes from values. Defaults to true.</p> <hr> <h3 id=malwarepatrol>MalwarePatrol <div id=intelmq.bots.parsers.malwarepatrol.parser_dansguardian /></h3> <p>Parses data from MalwarePatrol feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.malwarepatrol.parser_dansguardian</code></p> <p>No additional parameters.</p> <hr> <h3 id=malwareurl>MalwareURL <div id=intelmq.bots.parsers.malwareurl.parser /></h3> <p>Parses data from MalwareURL feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.malwareurl.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=mcafee-advanced-threat-defense-file>McAfee Advanced Threat Defense File <div id=intelmq.bots.parsers.mcafee.parser_atd /></h3> <p>Parse IoCs from McAfee Advanced Threat Defense reports (hash, IP, URL).</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.mcafee.parser_atd</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>verdict_severity</code></strong></p> <p>(optional, integer) Minimum report severity to parse. Defaults to 4.</p> <hr> <h3 id=microsoft-ctip>Microsoft CTIP <div id=intelmq.bots.parsers.microsoft.parser_ctip /></h3> <p>Parses data from the Microsoft CTIP feed.</p> <p>Can parse the JSON format provided by the Interflow interface (lists of dictionaries) as well as the format provided by the Azure interface (one dictionary per line). The provided data differs between the two formats/providers.</p> <p>The parser is capable of parsing both feeds:</p> <ul> <li><code>ctip-c2</code></li> <li><code>ctip-infected-summary</code> The feeds only differ by a few fields, not in the format.</li> </ul> <p>The feeds contain a field called <code>Payload</code> which is nearly always a base64 encoded JSON structure. If decoding works, the contained fields are saved as <code>extra.payload.*</code>, otherwise the field is saved as <code>extra.payload.text</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.microsoft.parser_ctip</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Overwrite an existing field <code>feed.name</code> with <code>DataFeed</code> of the source. Defaults to false.</p> <hr> <h3 id=misp>MISP <div id=intelmq.bots.parsers.misp.parser /></h3> <p>Parses MISP events.</p> <p>MISP events collected by the MISPCollectorBot are passed to this parser for processing. Supported MISP event categories and attribute types are defined in the <code>SUPPORTED_MISP_CATEGORIES</code> and <code>MISP_TYPE_MAPPING</code> class constants.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.misp.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=n6>N6 <div id=intelmq.bots.parsers.n6.parser_n6stomp /></h3> <p>Parses n6 data into IntelMQ format.</p> <p>Test messages are ignored, this is logged with debug logging level. Also contains a mapping for the classification ( results in taxonomy, type and identifier). The <code>name</code> field is normally used as <code>malware.name</code>, if that fails due to disallowed characters, these characters are removed and the original value is saved as <code>event_description.text</code>. This can happen for names like <code>further iocs: text with invalid ' char</code>.</p> <p>If a n6 message contains multiple IP addresses, multiple events are generated, resulting in events only differing in the address information.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.n6.parser_n6stomp</code></p> <p>No additional parameters.</p> <hr> <h3 id=openphish-free>OpenPhish Free <div id=intelmq.bots.parsers.openphish.parser /></h3> <p>Parses data from OpenPhish Free feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.openphish.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=openphish-premium>OpenPhish Premium <div id=intelmq.bots.parsers.openphish.parser_commercial /></h3> <p>Parses data from OpenPhish Premium feed (JSON).</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.openphish.parser_commercial</code></p> <p>No additional parameters.</p> <hr> <h3 id=phishtank>Phishtank <div id=intelmq.bots.parsers.phishtank.parser /></h3> <p>Parses data from Phishtank feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.phishtank.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=shadowserver>Shadowserver <div id=intelmq.bots.parsers.shadowserver.parser /></h3> <p>The Shadowserver parser operates on CSV formatted data.</p> <p><strong>How this bot works?</strong></p> <p>There are two possibilities for the bot to determine which report type the data belongs to in order to determine the correct mapping of the columns:</p> <ol> <li> <p><strong>Automatic report type detection</strong></p> <p>Since IntelMQ version 2.1 the parser can detect the feed based on metadata provided by the collector.</p> <p>When processing a report, this bot takes <code>extra.file_name</code> from the report and looks in <code>config.py</code> how the report should be parsed. If this lookup is not possible, and the <code>feedname</code> is not given as parameter, the feed cannot be parsed.</p> <p>The field <code>extra.file_name</code> has the following structure: <code>%Y-%m-%d-${report_name}[-suffix].csv</code> where the optional suffix can be something like <code>country-geo</code>. For example, some possible filenames are <code>2019-01-01-scan_http-country-geo.csv</code> or <code>2019-01-01-scan_tftp.csv</code>. The important part is the <code>report_name</code>, between the date and the suffix. Since version 2.1.2 the date in the filename is optional, so filenames like <code>scan_tftp.csv</code> are also detected.</p> </li> <li> <p><strong>Fixed report type</strong></p> <p>If the method above is not possible and for upgraded instances, the report type can be set with the <code>feedname</code> parameter. Report type is derived from the subject of Shadowserver e-mails. A list of possible values of the <code>feedname</code> parameter can be found in the table below in the column "Report Type".</p> </li> </ol> <p><strong>Module:</strong></p> <p><code>intelmq.bots.parsers.shadowserver.parser</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>feedname</code></strong></p> <p>(optional, string) Name of the Shadowserver report. The value for each report type can be found in the schema <code>feed_name</code> field.</p> <p>For example using <code>curl -s https://interchange.shadowserver.org/intelmq/v1/schema | jq .[].feed_name</code>.</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) If an existing <code>feed.name</code> should be overwritten.</p> <p>** <code>auto_update</code>**</p> <p>(optional, boolean) Enable automatic schema download.</p> <p><strong>Supported reports:</strong></p> <p>The report configuration is stored in a <code>shadowserver-schema.json</code> file downloaded from https://interchange.shadowserver.org/intelmq/v1/schema.</p> <p>The parser will attempt to download a schema update on startup when the <em>auto_update</em> option is enabled.</p> <p>Schema downloads can also be scheduled as a cron job for the <code>intelmq</code> user:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=w>  </span><span class=m>02</span><span class=w>  </span><span class=m>01</span><span class=w> </span>*<span class=w>   </span>*<span class=w>   </span>*<span class=w>     </span>intelmq.bots.parsers.shadowserver.parser<span class=w> </span>--update-schema
</code></pre></div> <p>For air-gapped systems automation will be required to download and copy the file to VAR_STATE_PATH/shadowserver-schema.json.</p> <p>The parser will automatically reload the configuration when the file changes.</p> <p><strong>Schema contract</strong></p> <p>Once set in the schema, the <code>classification.identifier</code>, <code>classification.taxonomy</code>, and <code>classification.type</code> fields will remain static for a specific report.</p> <p>The schema revision history is maintained at https://github.com/The-Shadowserver-Foundation/report_schema/.</p> <p><strong>Sample configuration</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=w>  </span><span class=nt>shadowserver-parser</span><span class=p>:</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=w>    </span><span class=nt>bot_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">shadowserver-parser</span>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Shadowserver Parser</span>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=w>    </span><span class=nt>group</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Parser</span>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=w>    </span><span class=nt>groupname</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">parsers</span>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=w>    </span><span class=nt>module</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">intelmq.bots.parsers.shadowserver.parser</span>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a><span class=w>    </span><span class=nt>parameters</span><span class=p>:</span>
<a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a><span class=w>      </span><span class=nt>destination_queues</span><span class=p>:</span>
<a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a><span class=w>        </span><span class=nt>_default</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>file-output-queue</span><span class="p p-Indicator">]</span>
<a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a><span class=w>      </span><span class=nt>auto_update</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a><span class=w>    </span><span class=nt>run_mode</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">continuous</span>
</code></pre></div> <hr> <h3 id=shodan>Shodan <div id=intelmq.bots.parsers.shodan.parser /></h3> <p>Parses data from Shodan (search, stream etc).</p> <p>The parser is by far not complete as there are a lot of fields in a big nested structure. There is a minimal mode available which only parses the important/most useful fields and also saves everything in <code>extra.shodan</code> keeping the original structure. When not using the minimal mode if may be useful to ignore errors as many parsing errors can happen with the incomplete mapping.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.shodan.parser</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>ignore_errors</code></strong></p> <p>(optional, boolean) Defaults to true.</p> <p><strong><code>minimal_mode</code></strong></p> <p>(optional, boolean) Defaults to false.</p> <hr> <h3 id=spamhaus-drop>Spamhaus DROP <div id=intelmq.bots.parsers.spamhaus.parser_drop /></h3> <p>Parses data from Spamhaus DROP feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.spamhaus.parser_drop</code></p> <p>No additional parameters.</p> <hr> <h3 id=spamhaus-cert>Spamhaus CERT <div id=intelmq.bots.parsers.spamhaus.parser_cert /></h3> <p>Parses data from Spamhaus CERT feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.spamhaus.parser_cert</code></p> <p>No additional parameters.</p> <hr> <h3 id=surbl>Surbl <div id=intelmq.bots.parsers.surbl.parser /></h3> <p>Parses data from surbl feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.surbl.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=threatminer>Threatminer <div id=intelmq.bots.parsers.threatminer.parser /></h3> <p>Parses data from Threatminer feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.threatminer.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=turris>Turris <div id=intelmq.bots.parsers.turris.parser /></h3> <p>Parses data from Turris Greylist feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.turris.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=twitter>Twitter <div id=intelmq.bots.parsers.twitter.parser /></h3> <p>Extracts URLs from text, fuzzy, aimed at parsing tweets.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.twitter.parser</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>domain_whitelist</code></strong></p> <p>(optional, array of strings) domains to be filtered out</p> <p><strong><code>substitutions</code></strong></p> <p>(optional, string) Semicolon delimited list of even length of pairs of substitutions (for example: <code>.;.;,;.</code> substitutes <code>.</code> for <code>.</code> and <code>,</code> for <code>.</code>).</p> <p><strong><code>classification_type</code></strong></p> <p>(optional, string) Statically set <code>classification.type</code>.</p> <p><strong><code>default_scheme</code></strong></p> <p>(optional, string) Default scheme for URLs if not given. See also the next section.</p> <p><strong>Default scheme</strong></p> <p>The dependency <code>url-normalize</code> changed it's behavior in version 1.4.0 from using <code>http://</code> as default scheme to <code>https://</code>. Version 1.4.1 added the possibility to specify it. Thus you can only use the <code>default_scheme</code> parameter with a current version of this library &gt;= 1.4.1, with 1.4.0 you will always get <code>https://</code> as default scheme and for older versions &lt; 1.4.0 <code>http://</code> is used.</p> <p>This does not affect URLs which already include the scheme.</p> <hr> <h3 id=vxvault>VxVault <div id=intelmq.bots.parsers.vxvault.parser /></h3> <p>Parses data from VxVault feed.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.vxvault.parser</code></p> <p>No additional parameters.</p> <hr> <h3 id=zoneh>ZoneH <div id=intelmq.bots.parsers.zoneh.parser /></h3> <p>Parses data from ZoneH.</p> <p>This bot is designed to consume defacement reports from zone-h.org. It expects fields normally present in CSV files distributed by email.</p> <p><strong>Module:</strong> <code>intelmq.bots.parsers.zoneh.parser</code></p> <p>No additional parameters.</p> <h2 id=expert-bots>Expert Bots</h2> <p>Expert bots are used for enriching, filtering and/or other data manipulation.</p> <h3 id=abusix>Abusix <div id=intelmq.bots.experts.abusix.expert /></h3> <p>This bot adds <code>source.abuse_contact</code> and <code>destination.abuse_contact</code> e-mail addresses. They are obtained via DNS TXT queries to Abusix servers.</p> <p><strong>Requirements</strong></p> <p>This bot can optionally use the python module <em>querycontacts</em> by Abusix itself: <a href=https://pypi.org/project/querycontacts/ >https://pypi.org/project/querycontacts/</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a>pip3<span class=w> </span>install<span class=w> </span>querycontacts
</code></pre></div> <p>If the package is not installed, our own routines are used.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.abusix.expert</code></p> <p><strong>Parameters (also expects <a href=#cache-parameters>cache parameters</a>):</strong></p> <p>No additional parameters.</p> <hr> <h3 id=aggregate>Aggregate <div id=intelmq.bots.experts.aggregate.expert /></h3> <p>Aggregates events based upon given fields &amp; timespan.</p> <p>Define specific fields to filter incoming events and aggregate them. Also set the timespan you want the events to get aggregated.</p> <p>The "cleanup" procedure, sends out the aggregated events or drops them based upon the given threshold value. It is called on every incoming message and on the bot's initialization. If you're potentially running on low traffic ( no incoming events within the given timestamp ) it is recommended to reload or restart the bot via cronjob each 30 minutes (adapt to your configured timespan). Otherwise you might loose information.</p> <p>I. e.:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>crontab<span class=w> </span>-e
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=m>0</span>,30<span class=w> </span>*<span class=w> </span>*<span class=w> </span>*<span class=w> </span>*<span class=w> </span>intelmqctl<span class=w> </span>reload<span class=w> </span>my-aggregate-bot
</code></pre></div> <p>For reloading/restarting please check the <code>intelmqctl</code> documentation.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.aggregate.expert</code></p> <p><strong>Parameters (also expects <a href=#cache-parameters>cache parameters</a>):</strong></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p><code>redis_cache_ttl</code> is not used at it would result in data loss.</p> </div> <p><strong><code>fields</code></strong></p> <p>(required, string) Given fields which are used to aggregate like <code>classification.type</code>, <code>classification.identifier</code>.</p> <p><strong><code>threshold</code></strong></p> <p>(required, integer) If the aggregated event is lower than the given threshold after the timespan, the event will get dropped.</p> <p><strong><code>timespan</code></strong></p> <p>(required, string) Timespan to aggregate events during the given time. I. e. <code>1 hour</code></p> <hr> <h3 id=asn-lookup>ASN Lookup <div id=intelmq.bots.experts.asn_lookup.expert /></h3> <p>This bot uses an offline database to add <code>source.asn</code> and <code>destination.asn</code> based on the respective IP address.</p> <p><strong>Requirements</strong></p> <p>Install <code>pyasn</code> module.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>pip3<span class=w> </span>install<span class=w> </span>pyasn
</code></pre></div> <p><strong>Module:</strong> <code>intelmq.bots.experts.asn_lookup.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>database</code></strong></p> <p>(required, string) Path to the downloaded database.</p> <p><strong>Database</strong></p> <p>Use this command to create/update the database and reload the bot:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>intelmq.bots.experts.asn_lookup.expert<span class=w> </span>--update-database
</code></pre></div> <p>The database is fetched from <a href=http://www.routeviews.org/routeviews/ >routeviews.org</a> and licensed under the Creative Commons Attribution 4.0 International license (see the <a href=http://www.routeviews.org/routeviews/index.php/faq/#faq-6666>routeviews FAQ</a>).</p> <hr> <h3 id=csv-converter>CSV Converter <div id=intelmq.bots.experts.csv_converter.expert /></h3> <p>Converts an event to CSV format, saved in the <code>output</code> field.</p> <p>To use the CSV-converted data in an output bot - for example in a file output, use the configuration parameter <code>single_key</code> of the output bot and set it to <code>output</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.csv_converter.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>delimiter</code></strong></p> <p>(optional, string) Defaults to <code>,</code>.</p> <p><strong><code>fieldnames</code></strong></p> <p>(required, string) Comma-separated list of field names, e.g. <code>"time.source,classification.type,source.ip"</code>.</p> <hr> <h3 id=team-cymru-whois>Team Cymru Whois <div id=intelmq.bots.experts.cymru_whois.expert /></h3> <p>This bot adds geolocation, ASN and BGP prefix based on IP address.</p> <p>Public documentation: <a href=https://www.team-cymru.com/IP-ASN-mapping.html#dns>https://www.team-cymru.com/IP-ASN-mapping.html#dns</a></p> <p><strong>Module:</strong> <code>intelmq.bots.experts.cymru_whois.expert</code></p> <p><strong>Parameters (also expects <a href=#cache-parameters>cache parameters</a>):</strong></p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing fields. Defaults to true.</p> <hr> <h3 id=remove-affix>Remove Affix <div id=intelmq.bots.experts.remove_affix.expert /></h3> <p>Remove part of string from string fields, example: <code>www.</code> from <code>source.fqdn</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.remove_affix.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>remove_prefix</code></strong></p> <p>(optional, boolean) True - cut from start, False - cut from end. Defaults to true.</p> <p><strong><code>affix</code></strong></p> <p>(required, string) example 'www.'</p> <p><strong><code>field</code></strong></p> <p>(required, string) Which field to modify. 'source.fqdn'</p> <hr> <h3 id=domain-suffix>Domain Suffix <div id=intelmq.bots.experts.domain_suffix.expert /></h3> <p>This bots uses an offline database to add the public suffix to the event, derived by a domain. See or information on the public suffix list: <a href=https://publicsuffix.org/list/ >https://publicsuffix.org/list/</a>. Only rules for ICANN domains are processed. The list can (and should) contain Unicode data, punycode conversion is done during reading.</p> <p>Note that the public suffix is not the same as the top level domain (TLD). E.g. <code>co.uk</code> is a public suffix, but the TLD is <code>uk</code>. Privately registered suffixes (such as <code>blogspot.co.at</code>) which are part of the public suffix list too, are ignored.</p> <p><strong>Rule processing</strong></p> <p>A short summary how the rules are processed:</p> <p>The simple ones:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a>com
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>at
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>gv.at
</code></pre></div> <p><code>example.com</code> leads to <code>com</code>, <code>example.gv.at</code> leads to <code>gv.at</code>.</p> <p>Wildcards:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a>*.example.com
</code></pre></div> <p><code>www.example.com</code> leads to <code>www.example.com</code>.</p> <p>And additionally the exceptions, together with the above wildcard rule:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a>!www.example.com
</code></pre></div> <p><code>www.example.com</code> does now not lead to <code>www.example.com</code>, but to <code>example.com</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.domain_suffix.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>field</code></strong></p> <p>(required, string) Allowed values: <code>fqdn</code> or <code>reverse_dns</code>.</p> <p><strong><code>suffix_file</code></strong></p> <p>(required, string) path to the suffix file</p> <p><strong>Database</strong></p> <p>Use this command to create/update the database and reload the bot:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a>intelmq.bots.experts.domain_suffix.expert<span class=w> </span>--update-database
</code></pre></div> <hr> <h3 id=domain-valid>Domain Valid <div id=intelmq.bots.experts.domain_valid.expert /></h3> <p>Checks if a domain is valid by performing multiple validity checks (see below).</p> <p>If the field given in <code>domain_field</code> does not exist in the event, the event is dropped. If the domain contains underscores (<code>_</code>), the event is dropped. If the domain is not valid according to the <a href=https://pypi.org/project/validators/ >validators library</a>, the event is dropped. If the domain's last part (the TLD) is not in the TLD-list configured by parameter <code>tlds_domains_list</code>, the field is dropped. Latest TLD list: <a href=https://data.iana.org/TLD/ >https://data.iana.org/TLD/</a></p> <p><strong>Module:</strong> <code>intelmq.bots.experts.domain_valid.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>domain_field</code></strong></p> <p>(required, string) The name of the field to be validated.</p> <p><strong><code>tlds_domains_list</code></strong></p> <p>(required, string) Path to a local file with all valid TLDs. Defaults to <code>/opt/intelmq/var/lib/bots/domain_valid/tlds-alpha-by-domain.txt</code></p> <hr> <h3 id=deduplicator>Deduplicator <div id=intelmq.bots.experts.deduplicator.expert /></h3> <p>Bot responsible for dropping duplicate events. Deduplication can be performed based on an arbitrary set of fields.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.deduplicator.expert</code></p> <p><strong>Parameters (also expects <a href=#cache-parameters>cache parameters</a>):</strong></p> <p><strong><code>bypass</code></strong></p> <p>(optional, boolean) Whether to bypass the deduplicator or not. When set to true, messages will not be deduplicated. Defaults to false.</p> <p><strong><code>filter_type</code></strong></p> <p>(optional, string) Allowed values: <code>blacklist</code> or <code>whitelist</code>. The filter type will be used to define how Deduplicator bot will interpret the parameter <code>filter_keys</code> in order to decide whether an event has already been seen or not, i.e., duplicated event or a completely new event.</p> <ul> <li><code>whitelist</code> configuration: only the keys listed in <code>filter_keys</code> will be considered to verify if an event is duplicated or not.</li> <li><code>blacklist</code> configuration: all keys except those in <code>filter_keys</code> will be considered to verify if an event is duplicated or not.</li> </ul> <p><strong><code>filter_keys</code></strong></p> <p>(optional, string) string with multiple keys separated by comma. Please note that <code>time.observation</code> key will not be considered even if defined, because the system always ignore that key.</p> <p>When using a whitelist field pattern and a small number of fields (keys), it becomes more important, that these fields exist in the events themselves. If a field does not exist, but is part of the hashing/deduplication, this field will be ignored. If such events should not get deduplicated, you need to filter them out before the deduplication process, e.g. using a sieve expert. See also <a href=https://lists.cert.at/pipermail/intelmq-users/2021-July/000370.html>this discussion thread</a> on the mailing-list.</p> <p><strong>Configuration Example</strong></p> <p><em>Example 1</em></p> <p>The bot with this configuration will detect duplication only based on <code>source.ip</code> and <code>destination.ip</code> keys.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=nt>parameters</span><span class=p>:</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=w>  </span><span class=nt>redis_cache_db</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=w>  </span><span class=nt>redis_cache_host</span><span class=p>:</span><span class=w> </span><span class=s>&quot;127.0.0.1&quot;</span>
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a><span class=w>  </span><span class=nt>redis_cache_password</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=w>  </span><span class=nt>redis_cache_port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">6379</span>
<a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a><span class=w>  </span><span class=nt>redis_cache_ttl</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">86400</span>
<a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=w>  </span><span class=nt>filter_type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;whitelist&quot;</span>
<a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a><span class=w>  </span><span class=nt>filter_keys</span><span class=p>:</span><span class=w> </span><span class=s>&quot;source.ip,destination.ip&quot;</span>
</code></pre></div> <p><em>Example 2</em></p> <p>The bot with this configuration will detect duplication based on all keys, except <code>source.ip</code> and <code>destination.ip</code> keys.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=nt>parameters</span><span class=p>:</span>
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=w>  </span><span class=nt>redis_cache_db</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=w>  </span><span class=nt>redis_cache_host</span><span class=p>:</span><span class=w> </span><span class=s>&quot;127.0.0.1&quot;</span>
<a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a><span class=w>  </span><span class=nt>redis_cache_password</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a><span class=w>  </span><span class=nt>redis_cache_port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">6379</span>
<a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a><span class=w>  </span><span class=nt>redis_cache_ttl</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">86400</span>
<a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=w>  </span><span class=nt>filter_type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;blacklist&quot;</span>
<a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a><span class=w>  </span><span class=nt>filter_keys</span><span class=p>:</span><span class=w> </span><span class=s>&quot;source.ip,destination.ip&quot;</span>
</code></pre></div> <p><strong>Flushing the cache</strong></p> <p>To flush the deduplicator's cache, you can use the <code>redis-cli</code> tool. Enter the database used by the bot and submit the <code>flushdb</code> command:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a>redis-cli<span class=w> </span>-n<span class=w> </span><span class=m>6</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a>flushdb
</code></pre></div> <hr> <h3 id=do-portal>DO Portal <div id=intelmq.bots.experts.do_portal.expert /></h3> <p>The DO portal retrieves the contact information from a DO portal instance: <a href=http://github.com/certat/do-portal/ >http://github.com/certat/do-portal/</a></p> <p><strong>Module:</strong> <code>intelmq.bots.experts.do_portal.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>mode</code></strong></p> <p>(required, string) Allowed values: <code>replace</code> or <code>append</code>. How to handle new abuse contacts in case there are existing ones.</p> <p><strong><code>portal_url</code></strong></p> <p>(required, string) The URL to the portal, without the API-path. The used URL is <code>$portal_url + '/api/1.0/ripe/contact?cidr=%s'</code>.</p> <p><strong><code>portal_api_key</code></strong></p> <p>(required, string) The API key of the user to be used. Must have sufficient privileges.</p> <hr> <h3 id=field-reducer>Field Reducer <div id=intelmq.bots.experts.field_reducer.expert /></h3> <p>The field reducer bot is capable of removing fields from events.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.field_reducer.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>type</code></strong></p> <p>(required, string) Allowed values: <code>whitelist</code> or <code>blacklist</code>. When <code>whitelist</code> is set, tnly the fields in <code>keys</code> will passed along. When <code>blacklist</code> is set then the fields in <code>keys</code> will be removed from events.</p> <p><strong><code>keys</code></strong></p> <p>(required, array of strings) Can be an array of field names or a string with a comma-separated list of field names.</p> <hr> <h3 id=filter>Filter <div id=intelmq.bots.experts.filter.expert /></h3> <p>The filter bot is capable of filtering specific events.</p> <p>A simple filter for messages (drop or pass) based on a exact string comparison or regular expression.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.filter.expert</code></p> <p><strong>Parameters:</strong></p> <p><em>Parameters for filtering with key/value attributes</em></p> <p><strong><code>filter_key</code></strong></p> <p>(required, string) - key from data format</p> <p><strong><code>filter_value</code></strong></p> <p>(required, string) - value for the key</p> <p><strong><code>filter_action</code></strong></p> <p>(required, string) - action when a message match to the criteria (possible actions: keep/drop)</p> <p><strong><code>filter_regex</code></strong></p> <p>(optional, boolean) - attribute determines if the <code>filter_value</code> shall be treated as regular expression or not.</p> <p>If this attribute is not empty (can be <code>true</code>, <code>yes</code> or whatever), the bot uses python's <a href=https://docs.python.org/3/library/re.html#re.search><code>re.search</code></a> function to evaluate the filter with regular expressions. If this attribute is empty or evaluates to false, an exact string comparison is performed. A check on string <em>inequality</em> can be achieved with the usage of <em>Paths</em> described below.</p> <p><em>Parameters for time based filtering</em></p> <p><strong><code>not_before</code></strong></p> <p>(optional, string) Events before this time will be dropped. Example: <code>1 week</code>.</p> <p><strong><code>not_after</code></strong></p> <p>(optional, string) - Events after this time will be dropped.</p> <p>Both parameters accept string values describing absolute or relative time:</p> <ul> <li>absolute</li> <li>basically anything parseable by datetime parser, eg.</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a>2015-09-12T06:22:11+00:00
</code></pre></div> <p><strong><code>time.source</code></strong></p> <p>(optional, string) Taken from the event will be compared to this value to decide the filter behavior.</p> <ul> <li>relative</li> <li>accepted string formatted like this "<integer> <epoch>", where epoch could be any of following strings (could optionally end with trailing 's'): hour, day, week, month, year</li> <li>time.source taken from the event will be compared to the value (now - relative) to decide the filter behavior</li> </ul> <p><em>Examples of time filter definition</em></p> <ul> <li><code>not_before: "2015-09-12T06:22:11+00:00"</code> - events older than the specified time will be dropped</li> <li><code>not_after: "6 months"</code> - just events older than 6 months will be passed through the pipeline</li> </ul> <p><strong>Possible paths</strong></p> <ul> <li><code>_default</code>: default path, according to the configuration</li> <li><code>action_other</code>: Negation of the default path</li> <li><code>filter_match</code>: For all events the filter matched on</li> <li><code>filter_no_match</code>: For all events the filter does not match</li> </ul> <table> <thead> <tr> <th>action</th> <th>match</th> <th>_default</th> <th>action_other</th> <th>filter_match</th> <th>filter_no_match</th> </tr> </thead> <tbody> <tr> <td>keep</td> <td>✓</td> <td>✓</td> <td>✗</td> <td>✓</td> <td>✗</td> </tr> <tr> <td>keep</td> <td>✗</td> <td>✗</td> <td>✓</td> <td>✗</td> <td>✓</td> </tr> <tr> <td>drop</td> <td>✓</td> <td>✗</td> <td>✓</td> <td>✓</td> <td>✗</td> </tr> <tr> <td>drop</td> <td>✗</td> <td>✓</td> <td>✗</td> <td>✗</td> <td>✓</td> </tr> </tbody> </table> <p>In <code>DEBUG</code> logging level, one can see that the message is sent to both matching paths, also if one of the paths is not configured. Of course the message is only delivered to the configured paths.</p> <hr> <h3 id=format-field>Format Field <div id=intelmq.bots.experts.format_field.expert /></h3> <p>String method operations on column values.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.format_field.expert</code></p> <p><strong>Parameters:</strong></p> <p><em>Parameters for stripping chars</em></p> <p><strong><code>strip_columns</code></strong> (optional, string/array of strings) A list of strings or a string of comma-separated values with field names. The names must match the IntelMQ Data Format field names.</p> <p>For example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=nt>columns</span><span class=p>:</span>
<a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">malware.name</span>
<a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">extra.tags</span>
</code></pre></div> <p>is equivalent to:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=nt>columns</span><span class=p>:</span><span class=w> </span><span class=s>&quot;malware.name,extra.tags&quot;</span>
</code></pre></div> <p><strong><code>strip_chars</code></strong></p> <p>(optional, string) Set of characters to remove as leading/trailing characters. Defaults to space.</p> <p><em>Parameters for replacing chars</em></p> <p><strong><code>replace_column</code></strong></p> <p>() key from data format</p> <p><strong><code>old_value</code></strong></p> <p>() the string to search for</p> <p><strong><code>new_value</code></strong></p> <p>() the string to replace the old value with</p> <p><strong><code>replace_count</code></strong> () number specifying how many occurrences of the old value you want to replace(default: [1])</p> <p><em>Parameters for splitting string to list of string</em></p> <p><strong><code>split_column</code></strong></p> <p>() key from data format</p> <p><strong><code>split_separator</code></strong></p> <p>() specifies the separator to use when splitting the string(default: <code>,</code>)</p> <p>Order of operation: <code>strip -&gt; replace -&gt; split</code>. These three methods can be combined such as first strip and then split.</p> <hr> <h3 id=generic-db-lookup>Generic DB Lookup <div id=intelmq.bots.experts.generic_db_lookup.expert /></h3> <p>This bot is capable for enriching intelmq events by lookups to a database. Currently only PostgreSQL and SQLite are supported.</p> <p>If more than one result is returned, a ValueError is raised.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.generic_db_lookup.expert</code></p> <p><strong>Parameters:</strong></p> <p><em>Connection</em></p> <p><strong><code>engine</code></strong></p> <p>(required, string) Allowed values: <code>postgresql</code> or <code>sqlite</code>.</p> <p><strong><code>database</code></strong></p> <p>(optional, string) Database name or the SQLite filename. Defaults to <code>intelmq</code>.</p> <p><strong><code>table</code></strong></p> <p>(optional, string) Name of the table. Defaults to <code>contacts</code>.</p> <p><em>PostgreSQL specific parameters</em></p> <p><strong><code>host</code></strong></p> <p>(optional, string) Hostname of the PostgreSQL server. Defaults to <code>localhost</code>.</p> <p><strong><code>port</code></strong></p> <p>(optional, integer) Port of the PostgreSQL server. Defaults to 5432.</p> <p><strong><code>user</code></strong></p> <p>(optional, string) Username for accessing PostgreSQL. Defaults to <code>intelmq</code>.</p> <p><strong><code>password</code></strong></p> <p>(optional, string) Password for accessing PostgreSQL. Defaults to ?.</p> <p><strong><code>sslmode</code></strong></p> <p>(optional, string) Type of TLS mode to use. Defaults to <code>require</code>.</p> <p><em>Lookup</em></p> <p><strong><code>match_fields</code></strong></p> <p>(optional, object) The value is a key-value mapping an arbitrary number IntelMQ field names to table column names. The values are compared with <code>=</code> only. Defaults to <code>source.asn: "asn"</code>.</p> <p><em>Replace fields</em></p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing fields. Defaults to false.</p> <p><strong><code>replace_fields</code></strong></p> <p>(optional, object) Key-value mapping an arbitrary number of table column names to IntelMQ field names. Defaults to <code>{"contact": "source.abuse_contact"}</code>.</p> <hr> <h3 id=gethostbyname>Gethostbyname <div id=intelmq.bots.experts.gethostbyname.expert /></h3> <p>This bot resolves to IP address (<code>source.ip</code> and <code>destination.ip</code>). Can possibly use also the <code>source.url</code> and <code>destination.url</code> for extracting FQDN.</p> <p>This bot resolves the DNS name (<code>source.fqdn</code> and <code>destination.fqdn</code>) using the <code>gethostbyname</code> syscall to an IP address (<code>source.ip</code> and <code>destination.ip</code>). The following gaierror resolution errors are ignored and treated as if the hostname cannot be resolved:</p> <ul> <li><code>-2</code>/<code>EAI_NONAME</code>: NAME or SERVICE is unknown</li> <li><code>-4</code>/<code>EAI_FAIL</code>: Non-recoverable failure in name res.</li> <li><code>-5</code>/<code>EAI_NODATA</code>: No address associated with NAME.</li> <li><code>-8</code>/<code>EAI_SERVICE</code>: SERVICE not supported for `ai_socktype'.</li> <li><code>-11</code>/<code>EAI_SYSTEM</code>: System error returned in `errno'.</li> </ul> <p>Other errors result in an exception if not ignored by the parameter <code>gaierrors_to_ignore</code>. All gaierrors can be found here: <a href=http://www.castaglia.org/proftpd/doc/devel-guide/src/lib/glibc-gai_strerror.c.html>http://www.castaglia.org/proftpd/doc/devel-guide/src/lib/glibc-gai_strerror.c.html</a></p> <p><strong>Module:</strong> <code>intelmq.bots.experts.gethostbyname.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>fallback_to_url</code></strong></p> <p>(optional, boolean) When true and no <code>source.fqdn</code> present, use <code>source.url</code> instead for producing <code>source.ip</code>.</p> <p><strong><code>gaierrors_to_ignore</code></strong></p> <p>(optional, array of integers) Gaierror codes to ignore, e.g. <code>-3</code> for EAI_AGAIN (Temporary failure in name resolution). Only accepts the integer values, not the names.</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing <code>source.ip</code> and/or <code>source.destination</code> fields. Defaults to false.</p> <hr> <h3 id=http-status>HTTP Status <div id=intelmq.bots.experts.http.expert_status /></h3> <p>The bot fetches the HTTP status for a given URL and saves it in the event.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.http.expert_status</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>field</code></strong></p> <p>(required, string) The name of the field containing the URL to be checked.</p> <p><strong><code>success_status_codes</code></strong></p> <p>(optional, array of integers) An array of success status codes. If this parameter is omitted or the list is empty, successful status codes are the ones between 200 and 400.</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing <code>status</code> field. Defaults to false.</p> <hr> <h3 id=http-content>HTTP Content <div id=intelmq.bots.experts.http.expert_content /></h3> <p>Fetches an HTTP resource and checks if it contains a specific string.</p> <p>The bot fetches an HTTP resource and checks if it contains a specific string.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.http.expert_content</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>field</code></strong></p> <p>(optional, string) The name of the field containing the URL to be checked. Defaults to <code>source.url</code>.</p> <p><strong><code>needle</code></strong></p> <p>(optional, string) The string that the content available on URL is checked for.</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing <code>status</code> field. Defaults to false.</p> <hr> <h3 id=idea-converter>IDEA Converter <div id=intelmq.bots.experts.idea.expert /></h3> <p>Converts the event to IDEA format and saves it as JSON in the field <code>output</code>. All other fields are not modified.</p> <p>Documentation about IDEA: <a href=https://idea.cesnet.cz/en/index>https://idea.cesnet.cz/en/index</a></p> <p><strong>Module:</strong> <code>intelmq.bots.experts.idea.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>test_mode</code></strong></p> <p>(optional, boolean) Adds <code>Test</code> category to mark all outgoing IDEA events as informal (meant to simplify setting up and debugging new IDEA producers). Defaults to true.</p> <hr> <h3 id=jinja2-template>Jinja2 Template <div id=intelmq.bots.experts.jinja.expert /></h3> <p>This bot lets you modify the content of your IntelMQ message fields using Jinja2 templates.</p> <p>Documentation about Jinja2 templating language: <a href=https://jinja.palletsprojects.com/ >https://jinja.palletsprojects.com/</a></p> <p><strong>Module:</strong> <code>intelmq.bots.experts.jinja.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>fields</code></strong></p> <p>(required, object) a dict containing as key the name of the field where the result of the Jinja2 template should be written to and as value either a Jinja2 template or a filepath to a Jinja2 template file (starting with <code>file:///</code>). Because the experts decides if it is a filepath based on the value starting with <code>file:///</code> it is not possible to simply write values starting with <code>file:///</code> to fields. The object containing the existing message will be passed to the Jinja2 template with the name <code>msg</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=nt>fields</span><span class=p>:</span>
<a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=w>  </span><span class=nt>output</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">The provider is {{ msg[&#39;feed.provider&#39;] }}!</span>
<a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a><span class=w>  </span><span class=nt>feed.url</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>msg[&#39;feed.url&#39;]</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>upper</span><span class=nv> </span><span class=s>}}&quot;</span>
<a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=w>  </span><span class=nt>extra.somejinjaoutput</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">file:///etc/intelmq/somejinjatemplate.j2</span>
</code></pre></div> <hr> <h3 id=lookyloo>Lookyloo <div id=intelmq.bots.experts.lookyloo.expert /></h3> <p>Lookyloo is a website screenshotting and analysis tool. For more information and installation instructions visit <a href=https://www.lookyloo.eu/ >https://www.lookyloo.eu/</a></p> <p>The bot sends a request for <code>source.url</code> to the configured Lookyloo instance and saves the retrieved website screenshot link in the field <code>screenshot_url</code>. Lookyloo only <em>queues</em> the website for screenshotting, therefore the screenshot may not be directly ready after the bot requested it. The <code>pylookyloo</code> library is required for this bot. The <code>http_user_agent</code> parameter is passed on, but not other HTTP-related parameter like proxies.</p> <p>Events without <code>source.url</code> are ignored.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.lookyloo.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>instance_url</code></strong></p> <p>(required, string) LookyLoo instance to connect to.</p> <hr> <h3 id=maxmind-geoip>MaxMind GeoIP <div id=intelmq.bots.experts.maxmind_geoip.expert /></h3> <p>This bot uses an offline database for adding geolocation information based on the IP address (<code>source.ip</code> and <code>destination.ip</code>).</p> <p><strong>Requirements</strong></p> <p>The bot requires the MaxMind's <code>geoip2</code> Python library, version 2.2.0 has been tested.</p> <p>To download the database a free license key is required. More information can be found at <a href=https://blog.maxmind.com/2019/12/18/significant-changes-to-accessing-and-using-geolite2-databases/ >https://blog.maxmind.com/2019/12/18/significant-changes-to-accessing-and-using-geolite2-databases/</a>.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.maxmind_geoip.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>database</code></strong></p> <p>(required, string) Path to the local database file.</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing fields. Defaults to true.</p> <p><strong><code>use_registered</code></strong></p> <p>(optional, boolean) MaxMind has two country ISO codes: One for the physical location of the address and one for the registered location. See also <a href=https://github.com/certtools/intelmq/pull/1344>https://github.com/certtools/intelmq/pull/1344</a> for a short explanation. Defaults to <code>false</code> (backwards-compatibility).</p> <p><strong><code>license_key</code></strong></p> <p>(required, string) MaxMind license key is necessary for downloading the GeoLite2 database.</p> <p><strong>Database</strong></p> <p>Use this command to create/update the database and reload the bot:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a>intelmq.bots.experts.maxmind_geoip.expert<span class=w> </span>--update-database
</code></pre></div> <hr> <h3 id=misp_1>MISP <div id=intelmq.bots.experts.misp.expert /></h3> <p>Queries a MISP instance for the <code>source.ip</code> and adds the MISP Attribute UUID and MISP Event ID of the newest attribute found.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.misp.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>misp_key</code></strong></p> <p>(required, string) MISP Authkey.</p> <p><strong><code>misp_url</code></strong></p> <p>(required, string) URL of MISP server (with trailing '/')</p> <p><strong><code>http_verify_cert</code></strong></p> <p>(optional, boolean) Verify the TLS certificate of the server. Default to <code>true</code>.</p> <hr> <h3 id=mcafee-active-response-lookup>McAfee Active Response Lookup <div id=intelmq.bots.experts.mcafee.expert_mar /></h3> <p>Queries DXL bus for hashes, IP addresses or FQDNs.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.mcafee.expert_mar</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>dxl_config_file</code></strong></p> <p>(required, string) Location of the file containing required information to connect to DXL bus.</p> <p><strong><code>lookup_type</code></strong></p> <p>(required, string) Allowed values:</p> <ul> <li><code>Hash</code> - Looks up <code>malware.hash.md5</code>, <code>malware.hash.sha1</code> and <code>malware.hash.sha256</code>.</li> <li><code>DestSocket</code> - Looks up <code>destination.ip</code> and <code>destination.port</code>.</li> <li><code>DestIP</code> - Looks up <code>destination.ip</code>.</li> <li><code>DestFQDN</code> - Looks up in <code>destination.fqdn</code>.</li> </ul> <hr> <h3 id=modify>Modify <div id=intelmq.bots.experts.modify.expert /></h3> <p>This bots allows you to change arbitrary field values of events using a configuration file.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.modify.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>configuration_path</code></strong></p> <p>(required, string) Location of the configuration file.</p> <p><strong><code>case_sensitive</code></strong></p> <p>(optional, boolean) Defaults to true.</p> <p><strong><code>maximum_matches</code></strong></p> <p>(optional, boolean) Maximum number of matches. Processing stops after the limit is reached. Defaults to null (no limit).</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Overwrite any existing fields by matching rules. Defaults to false.</p> <p><strong>Configuration File</strong></p> <p>The modify expert bot allows you to change arbitrary field values of events just using a configuration file. Thus it is possible to adapt certain values or adding new ones only by changing JSON-files without touching the code of many other bots.</p> <p>The configuration is called <code>modify.conf</code> and looks like this:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=p>[</span>
<a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a><span class=w>  </span><span class=p>{</span>
<a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a><span class=w>    </span><span class=nt>&quot;rulename&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Standard Protocols http&quot;</span><span class=p>,</span>
<a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a><span class=w>    </span><span class=nt>&quot;if&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a><span class=w>      </span><span class=nt>&quot;source.port&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;^(80|443)$&quot;</span>
<a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-49-7 name=__codelineno-49-7 href=#__codelineno-49-7></a><span class=w>    </span><span class=nt>&quot;then&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-8 name=__codelineno-49-8 href=#__codelineno-49-8></a><span class=w>      </span><span class=nt>&quot;protocol.application&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;http&quot;</span>
<a id=__codelineno-49-9 name=__codelineno-49-9 href=#__codelineno-49-9></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-49-10 name=__codelineno-49-10 href=#__codelineno-49-10></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-49-11 name=__codelineno-49-11 href=#__codelineno-49-11></a><span class=w>  </span><span class=p>{</span>
<a id=__codelineno-49-12 name=__codelineno-49-12 href=#__codelineno-49-12></a><span class=w>    </span><span class=nt>&quot;rulename&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Spamhaus Cert conficker&quot;</span><span class=p>,</span>
<a id=__codelineno-49-13 name=__codelineno-49-13 href=#__codelineno-49-13></a><span class=w>    </span><span class=nt>&quot;if&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-14 name=__codelineno-49-14 href=#__codelineno-49-14></a><span class=w>      </span><span class=nt>&quot;malware.name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;^conficker(ab)?$&quot;</span>
<a id=__codelineno-49-15 name=__codelineno-49-15 href=#__codelineno-49-15></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-49-16 name=__codelineno-49-16 href=#__codelineno-49-16></a><span class=w>    </span><span class=nt>&quot;then&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-17 name=__codelineno-49-17 href=#__codelineno-49-17></a><span class=w>      </span><span class=nt>&quot;classification.identifier&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;conficker&quot;</span>
<a id=__codelineno-49-18 name=__codelineno-49-18 href=#__codelineno-49-18></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-49-19 name=__codelineno-49-19 href=#__codelineno-49-19></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-49-20 name=__codelineno-49-20 href=#__codelineno-49-20></a><span class=w>  </span><span class=p>{</span>
<a id=__codelineno-49-21 name=__codelineno-49-21 href=#__codelineno-49-21></a><span class=w>    </span><span class=nt>&quot;rulename&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bitdefender&quot;</span><span class=p>,</span>
<a id=__codelineno-49-22 name=__codelineno-49-22 href=#__codelineno-49-22></a><span class=w>    </span><span class=nt>&quot;if&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-23 name=__codelineno-49-23 href=#__codelineno-49-23></a><span class=w>      </span><span class=nt>&quot;malware.name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bitdefender-(.*)$&quot;</span>
<a id=__codelineno-49-24 name=__codelineno-49-24 href=#__codelineno-49-24></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-49-25 name=__codelineno-49-25 href=#__codelineno-49-25></a><span class=w>    </span><span class=nt>&quot;then&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-26 name=__codelineno-49-26 href=#__codelineno-49-26></a><span class=w>      </span><span class=nt>&quot;malware.name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;{matches[malware.name][1]}&quot;</span>
<a id=__codelineno-49-27 name=__codelineno-49-27 href=#__codelineno-49-27></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-49-28 name=__codelineno-49-28 href=#__codelineno-49-28></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-49-29 name=__codelineno-49-29 href=#__codelineno-49-29></a><span class=w>  </span><span class=p>{</span>
<a id=__codelineno-49-30 name=__codelineno-49-30 href=#__codelineno-49-30></a><span class=w>    </span><span class=nt>&quot;rulename&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;urlzone&quot;</span><span class=p>,</span>
<a id=__codelineno-49-31 name=__codelineno-49-31 href=#__codelineno-49-31></a><span class=w>    </span><span class=nt>&quot;if&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-32 name=__codelineno-49-32 href=#__codelineno-49-32></a><span class=w>      </span><span class=nt>&quot;malware.name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;^urlzone2?$&quot;</span>
<a id=__codelineno-49-33 name=__codelineno-49-33 href=#__codelineno-49-33></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-49-34 name=__codelineno-49-34 href=#__codelineno-49-34></a><span class=w>    </span><span class=nt>&quot;then&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-35 name=__codelineno-49-35 href=#__codelineno-49-35></a><span class=w>      </span><span class=nt>&quot;classification.identifier&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;urlzone&quot;</span>
<a id=__codelineno-49-36 name=__codelineno-49-36 href=#__codelineno-49-36></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-49-37 name=__codelineno-49-37 href=#__codelineno-49-37></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-49-38 name=__codelineno-49-38 href=#__codelineno-49-38></a><span class=w>  </span><span class=p>{</span>
<a id=__codelineno-49-39 name=__codelineno-49-39 href=#__codelineno-49-39></a><span class=w>    </span><span class=nt>&quot;rulename&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;default&quot;</span><span class=p>,</span>
<a id=__codelineno-49-40 name=__codelineno-49-40 href=#__codelineno-49-40></a><span class=w>    </span><span class=nt>&quot;if&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-41 name=__codelineno-49-41 href=#__codelineno-49-41></a><span class=w>      </span><span class=nt>&quot;feed.name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;^Spamhaus Cert$&quot;</span>
<a id=__codelineno-49-42 name=__codelineno-49-42 href=#__codelineno-49-42></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-49-43 name=__codelineno-49-43 href=#__codelineno-49-43></a><span class=w>    </span><span class=nt>&quot;then&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-49-44 name=__codelineno-49-44 href=#__codelineno-49-44></a><span class=w>      </span><span class=nt>&quot;classification.identifier&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;{msg[malware.name]}&quot;</span>
<a id=__codelineno-49-45 name=__codelineno-49-45 href=#__codelineno-49-45></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-49-46 name=__codelineno-49-46 href=#__codelineno-49-46></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-49-47 name=__codelineno-49-47 href=#__codelineno-49-47></a><span class=p>]</span>
</code></pre></div> <p>In our example above we have five groups labeled <code>Standard Protocols http</code>, <code>Spamhaus Cert conficker</code>, <code>bitdefender</code>, <code>urlzone</code> and <code>default</code>. All sections will be considered, in the given order (from top to bottom).</p> <p>Each rule consists of <em>conditions</em> and <em>actions</em>. Conditions and actions are dictionaries holding the field names of events and regular expressions to match values (selection) or set values (action). All matching rules will be applied in the given order. The actions are only performed if all selections apply.</p> <p>If the value for a condition is an empty string, the bot checks if the field does not exist. This is useful to apply default values for empty fields.</p> <p><strong>Actions</strong></p> <p>You can set the value of the field to a string literal or number.</p> <p>In addition you can use the <a href=https://docs.python.org/3/library/string.html#format-string-syntax>standard Python string format syntax</a> to access the values from the processed event as <code>msg</code> and the match groups of the conditions as <code>matches</code>, see the bitdefender example above. Group 0 ([<code>0</code>]) contains the full matching string. See also the documentation on <a href="https://docs.python.org/3/library/re.html?highlight=re%20search#re.Match.group">re.Match.group</a>.</p> <p>Note that <code>matches</code> will also contain the match groups from the default conditions if there were any.</p> <p><strong>Examples</strong></p> <p>We have an event with <code>feed.name = Spamhaus Cert</code> and <code>malware.name = confickerab</code>. The expert loops over all sections in the file and eventually enters section <code>Spamhaus Cert</code>. First, the default condition is checked, it matches! OK, going on. Otherwise the expert would have selected a different section that has not yet been considered. Now, go through the rules, until we hit the rule <code>conficker</code>. We combine the conditions of this rule with the default conditions, and both rules match! So we can apply the action: <code>classification.identifier</code> is set to <code>conficker</code>, the trivial name.</p> <p>Assume we have an event with <code>feed.name = Spamhaus Cert</code> and <code>malware.name = feodo</code>. The default condition matches, but no others. So the default action is applied. The value for <code>classification.identifier</code> will be set to <code>feodo</code> by <code>{msg[malware.name]}</code>.</p> <p><strong>Types</strong></p> <p>If the rule is a string, a regular expression search is performed, also for numeric values (<code>str()</code> is called on them). If the rule is numeric for numeric values, a simple comparison is done. If other types are mixed, a warning will be thrown.</p> <p>For boolean values, the comparison value needs to be <code>true</code> or <code>false</code> as in JSON they are written all-lowercase.</p> <hr> <h3 id=national-cert-contact-lookup-by-certat>National CERT Contact Lookup by CERT.AT <div id=intelmq.bots.experts.national_cert_contact_certat.expert /></h3> <p><a href=https://contacts.cert.at>https://contacts.cert.at</a> offers an IP address to national CERT contact (and cc) mapping.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.national_cert_contact_certat.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>filter</code></strong></p> <p>(optional, boolean) Whether to act as a filter for AT.</p> <p><strong><code>overwrite_cc</code></strong></p> <p>(optional, boolean) Set to true if you want to overwrite any potentially existing cc fields in the event. Defaults to false.</p> <hr> <h3 id=rdap>RDAP <div id=intelmq.bots.experts.rdap.expert /></h3> <p>This bot queries RDAP servers for additional information about a domain.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.rdap.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>rdap_order</code></strong></p> <p>(optional, array of strings) Search order of contacts with these roles. Defaults to <code>["abuse", "technical"]</code>.</p> <p><strong><code>rdap_bootstrapped_servers</code></strong></p> <p>(optional, object) Customized RDAP servers. Do not forget the trailing slash. For example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=p>{</span>
<a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a><span class=w>  </span><span class=nt>&quot;at&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a><span class=w>    </span><span class=nt>&quot;url&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;rdap.server.at/v1/&quot;</span><span class=p>,</span>
<a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a><span class=w>    </span><span class=nt>&quot;auth&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a><span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;jwt&quot;</span><span class=p>,</span>
<a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a><span class=w>      </span><span class=nt>&quot;token&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ey...&quot;</span>
<a id=__codelineno-50-7 name=__codelineno-50-7 href=#__codelineno-50-7></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-50-8 name=__codelineno-50-8 href=#__codelineno-50-8></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-50-9 name=__codelineno-50-9 href=#__codelineno-50-9></a><span class=w>  </span><span class=nt>&quot;de&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;rdap.service:1337/v1/&quot;</span>
<a id=__codelineno-50-10 name=__codelineno-50-10 href=#__codelineno-50-10></a><span class=p>}</span>
</code></pre></div> <hr> <h3 id=recordedfuture-ip-risk>RecordedFuture IP Risk <div id=intelmq.bots.experts.recordedfuture_iprisk.expert /></h3> <p>This bot tags events with the score found in RecordedFuture large IP risklist.</p> <p>Record risk score associated to source and destination IP if they are present. Assigns 0 to IP addresses not in the RF list.</p> <p>For both <code>source.ip</code> and <code>destination.ip</code> the corresponding risk score is fetched from a local database created from RecordedFuture's API. The score is recorded in <code>extra.rf_iprisk.source</code> and <code>extra.rf_iprisk.destination</code>. If a lookup for an IP fails a score of 0 is recorded.</p> <p>See <a href=https://www.recordedfuture.com/products/api/ >https://www.recordedfuture.com/products/api/</a> and speak with your RecordedFuture representative for more information.</p> <p>The list is obtained from recorded future API and needs a valid API TOKEN The large list contains all IP's with a risk score of 25 or more. If IP's are not present in the database a risk score of 0 is given.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.recordedfuture_iprisk.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>database</code></strong></p> <p>(required, string) Path to the local database file.</p> <p><strong><code>api_token</code></strong></p> <p>(required, string) This needs to contain valid API token to download the latest database data.</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing fields. Defaults to false.</p> <p><strong>Database</strong></p> <p>Use this command to create/update the database and reload the bot:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a>intelmq.bots.experts.recordedfuture_iprisk.expert<span class=w> </span>--update-database
</code></pre></div> <hr> <h3 id=reverse-dns>Reverse DNS <div id=intelmq.bots.experts.reverse_dns.expert /></h3> <p>For both <code>source.ip</code> and <code>destination.ip</code> the PTR record is fetched and the first valid result is used for <code>source.reverse_dns</code> or <code>destination.reverse_dns</code>.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.reverse_dns.expert</code></p> <p><strong>Parameters (also expects <a href=#cache-parameters>cache parameters</a>):</strong></p> <p><strong><code>cache_ttl_invalid_response</code></strong></p> <p>(required, integer) The TTL for cached invalid responses.</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing fields. Defaults to false.</p> <hr> <h3 id=rfc1918>RFC1918 <div id=intelmq.bots.experts.rfc1918.expert /></h3> <p>Several RFCs define ASNs, IP Addresses and Hostnames (and TLDs) reserved for <em>documentation</em>. Events or fields of events can be dropped if they match the criteria of either being reserved for documentation (e.g. AS 64496, Domain <code>example.com</code>) or belonging to a local area network (e.g. <code>192.168.0.0/24</code>). These checks can applied to URLs, IP Addresses, FQDNs and ASNs.</p> <p>It is configurable if the whole event should be dropped ("policies") or just the field removed, as well as which fields should be checked.</p> <p>Sources:</p> <ul> <li><code>1918</code></li> <li><code>2606</code></li> <li><code>3849</code></li> <li><code>4291</code></li> <li><code>5737</code></li> <li><a href=https://en.wikipedia.org/wiki/IPv4>https://en.wikipedia.org/wiki/IPv4</a></li> <li><a href=https://en.wikipedia.org/wiki/Autonomous_system_(Internet)>https://en.wikipedia.org/wiki/Autonomous_system_(Internet)</a></li> </ul> <p><strong>Module:</strong> <code>intelmq.bots.experts.rfc1918.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>fields</code></strong></p> <p>(required, string) Comma-separated list of fields. Allowed values:</p> <ul> <li><code>destination.asn</code> &amp; <code>source.asn</code></li> <li><code>destination.fqdn</code> &amp; <code>source.fqdn</code></li> <li><code>destination.ip</code> &amp; <code>source.ip</code></li> <li><code>destination.url</code> &amp; <code>source.url</code></li> </ul> <p><strong><code>policy</code></strong></p> <p>(required, string) Comma-separated list of policies. Allowed values:</p> <ul> <li><code>drop</code> - the entire events is dropped</li> <li><code>del</code> - the affected field is removed</li> </ul> <p>With the example parameter values given above, this means that:</p> <ul> <li>If a <code>destination.ip</code> value is part of a reserved network block, the field will be removed (policy <code>del</code>).</li> <li>If a <code>source.asn</code> value is in the range of reserved AS numbers, the event will be removed altogether (policy <code>drop</code>).</li> <li>If a <code>source.url</code> value contains a host with either an IP address part of a reserved network block, or a reserved domain name (or with a reserved TLD), the event will be dropped (policy <code>drop</code>).</li> </ul> <hr> <h3 id=ripe>RIPE <div id=intelmq.bots.experts.ripe.expert /></h3> <p>Online RIPE Abuse Contact and Geolocation Finder for IP addresses and Autonomous Systems.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.ripe.expert</code></p> <p><strong>Parameters (also expects <a href=#cache-parameters>cache parameters</a>):</strong></p> <p><strong><code>mode</code></strong></p> <p>(optional, string) Allowed values: <code>append</code> or <code>replace</code>. Defaults to <code>append</code>.</p> <p><strong><code>query_ripe_db_asn</code></strong></p> <p>(optional, boolean) Query for IPs at <code>http://rest.db.ripe.net/abuse-contact/%s.json</code>. Defaults to true.</p> <p><strong><code>query_ripe_db_ip</code></strong></p> <p>(optional, boolean) Query for ASNs at <code>http://rest.db.ripe.net/abuse-contact/as%s.json</code>. Defaults to true.</p> <p><strong><code>query_ripe_stat_asn</code></strong></p> <p>(optional, boolean) Query for ASNs at <code>https://stat.ripe.net/data/abuse-contact-finder/data.json?resource=%s</code>. Defaults to true.</p> <p><strong><code>query_ripe_stat_ip</code></strong></p> <p>(optional, boolean) Query for IPs at <code>https://stat.ripe.net/data/abuse-contact-finder/data.json?resource=%s</code>. Defaults to true.</p> <p><strong><code>query_ripe_stat_geolocation</code></strong></p> <p>(optional, boolean) Query for IPs at <code>https://stat.ripe.net/data/maxmind-geo-lite/data.json?resource=%s</code>. Defaults to true.</p> <hr> <h3 id=sieve>Sieve <div id=intelmq.bots.experts.sieve.expert /></h3> <p>This bot is used to filter and/or modify events based on a set of rules. The rules are specified in an external configuration file and with a syntax <em>similar</em> to the <a href=http://sieve.info>Sieve language</a> used for mail filtering.</p> <p>Each rule defines a set of matching conditions on received events. Events can be matched based on keys and values in the event. Conditions can be combined using parenthesis and the boolean operators <code>&amp;&amp;</code> and <code>||</code>. If the processed event matches a rule's conditions, the corresponding actions are performed. Actions can specify whether the event should be kept or dropped in the pipeline (filtering actions) or if keys and values should be changed (modification actions).</p> <p><strong>Requirements</strong></p> <p>To use this bot, you need to install the required dependencies:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a>pip3<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>intelmq/bots/experts/sieve/REQUIREMENTS.txt
</code></pre></div> <p><strong>Module:</strong> <code>intelmq.bots.experts.sieve.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>file</code></strong></p> <p>(required, string) Path to sieve file. Syntax can be validated with <code>intelmq_sieve_expert_validator</code>.</p> <p><strong>Examples</strong></p> <p>The following excerpts illustrate some of the basic features of the sieve file format:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a>if :exists source.fqdn {
<a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a> keep // aborts processing of subsequent rules and forwards the event.
<a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a>}
<a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a>
<a id=__codelineno-53-5 name=__codelineno-53-5 href=#__codelineno-53-5></a>
<a id=__codelineno-53-6 name=__codelineno-53-6 href=#__codelineno-53-6></a>if :notexists source.abuse_contact || source.abuse_contact =~ &#39;.*@example.com&#39; {
<a id=__codelineno-53-7 name=__codelineno-53-7 href=#__codelineno-53-7></a> drop // aborts processing of subsequent rules and drops the event.
<a id=__codelineno-53-8 name=__codelineno-53-8 href=#__codelineno-53-8></a>}
<a id=__codelineno-53-9 name=__codelineno-53-9 href=#__codelineno-53-9></a>
<a id=__codelineno-53-10 name=__codelineno-53-10 href=#__codelineno-53-10></a>if source.ip &lt;&lt; &#39;192.0.0.0/24&#39; {
<a id=__codelineno-53-11 name=__codelineno-53-11 href=#__codelineno-53-11></a> add! comment = &#39;bogon&#39; // sets the field comment to this value and overwrites existing values
<a id=__codelineno-53-12 name=__codelineno-53-12 href=#__codelineno-53-12></a> path &#39;other-path&#39; // the message is sent to the given path
<a id=__codelineno-53-13 name=__codelineno-53-13 href=#__codelineno-53-13></a>}
<a id=__codelineno-53-14 name=__codelineno-53-14 href=#__codelineno-53-14></a>
<a id=__codelineno-53-15 name=__codelineno-53-15 href=#__codelineno-53-15></a>if classification.type :in [&#39;phishing&#39;, &#39;malware-distribution&#39;] &amp;&amp; source.fqdn =~ &#39;.*.(ch|li)$&#39; {
<a id=__codelineno-53-16 name=__codelineno-53-16 href=#__codelineno-53-16></a> add! comment = &#39;domainabuse&#39;
<a id=__codelineno-53-17 name=__codelineno-53-17 href=#__codelineno-53-17></a> keep
<a id=__codelineno-53-18 name=__codelineno-53-18 href=#__codelineno-53-18></a>} elif classification.type == &#39;scanner&#39; {
<a id=__codelineno-53-19 name=__codelineno-53-19 href=#__codelineno-53-19></a> add! comment = &#39;ignore&#39;
<a id=__codelineno-53-20 name=__codelineno-53-20 href=#__codelineno-53-20></a> drop
<a id=__codelineno-53-21 name=__codelineno-53-21 href=#__codelineno-53-21></a>} else {
<a id=__codelineno-53-22 name=__codelineno-53-22 href=#__codelineno-53-22></a> remove comment
<a id=__codelineno-53-23 name=__codelineno-53-23 href=#__codelineno-53-23></a>}
</code></pre></div> <p><strong>Reference</strong></p> <p><em>Sieve File Structure</em></p> <p>The sieve file contains an arbitrary number of rules of the form:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a>if EXPRESSION {
<a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a> ACTIONS
<a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a>} elif EXPRESSION {
<a id=__codelineno-54-4 name=__codelineno-54-4 href=#__codelineno-54-4></a> ACTIONS
<a id=__codelineno-54-5 name=__codelineno-54-5 href=#__codelineno-54-5></a>} else {
<a id=__codelineno-54-6 name=__codelineno-54-6 href=#__codelineno-54-6></a> ACTIONS
<a id=__codelineno-54-7 name=__codelineno-54-7 href=#__codelineno-54-7></a>}
</code></pre></div> <p>Nested if-statements and mixed if statements and rules in the same scope are possible.</p> <p><em>Expressions</em></p> <p>Each rule specifies on or more expressions to match an event based on its keys and values. Event keys are specified as strings without quotes. String values must be enclosed in single quotes. Numeric values can be specified as integers or floats and are unquoted. IP addresses and network ranges (IPv4 and IPv6) are specified with quotes. List values for use with list/set operators are specified as string, float, int, bool and string literals separated by commas and enclosed in square brackets. Expression statements can be combined and chained using parentheses and the boolean operators <code>&amp;&amp;</code> and <code>||</code>. The following operators may be used to match events:</p> <ul> <li><code>:exists</code> and <code>:notexists</code> match if a given key exists, for example:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a>if :exists source.fqdn { ... }
</code></pre></div> <ul> <li><code>==</code> and <code>!=</code> match for equality of strings, numbers, and booleans, for example:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a>if feed.name != &#39;acme-security&#39; || feed.accuracy == 100 || extra.false_positive == false { ... }
</code></pre></div> <ul> <li> <p><code>:contains</code> matches on substrings (<a href=https://docs.python.org/3/library/stdtypes.html#str.find><code>str.find</code></a>).</p> </li> <li> <p><code>=~</code> matches strings based on the given regular expression. <code>!~</code> is the inverse regular expression match.</p> </li> <li> <p>For <code>:contains</code>, <code>=~</code> and <code>!~</code>, the value is converted to string before matching. If the value is a dict, convert the value to JSON.</p> </li> <li> <p>Numerical comparisons are evaluated with <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>.</p> </li> <li> <p><code>&lt;&lt;</code> matches if an IP address is contained in the specified network range:</p> </li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a>if source.ip &lt;&lt; &#39;10.0.0.0/8&#39; { ... }
</code></pre></div> <ul> <li>String values to match against can also be specified as lists of strings, which have separate operators. For example:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a>if source.ip :in [&#39;8.8.8.8&#39;, &#39;8.8.4.4&#39;] { ... }
</code></pre></div> <p>In this case, the event will match if it contains a key <code>source.ip</code> with either value <code>8.8.8.8</code> or <code>8.8.4.4</code>.</p> <p>There are also <code>:containsany</code> to match at least one of a list of substrings, and <code>:regexin</code> to match at least one of a list of regular expressions, similar to the <code>:contains</code> and <code>=~</code> operators.</p> <ul> <li>Lists of numeric values support <code>:in</code> to check for inclusion in a list of numbers:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a>if source.port :in [80, 443] { ... }
</code></pre></div> <ul> <li><code>:equals</code> tests for equality between lists, including order. Example for checking a hostname-port pair:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a>if extra.host_tuple :equals [&#39;dns.google&#39;, 53] { ... }
</code></pre></div> <ul> <li><code>:setequals</code> tests for set-based equality (ignoring duplicates and value order) between a list of given values. Example for checking for the first nameserver of two domains, regardless of the order they are given in the list:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a>if extra.hostnames :setequals [&#39;ns1.example.com&#39;, &#39;ns1.example.mx&#39;] { ... }
</code></pre></div> <ul> <li><code>:overlaps</code> tests if there is at least one element in common between the list specified by a key and a list of values. Example for checking if at least one of the ICS, database or vulnerable tags is given:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a>if extra.tags :overlaps [&#39;ics&#39;, &#39;database&#39;, &#39;vulnerable&#39;] { ... }
</code></pre></div> <ul> <li><code>:subsetof</code> tests if the list of values from the given key only contains values from a set of values specified as the argument. Example for checking for a host that has only ns1.example.com and/or ns2.* as its apparent hostname:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a>if extra.hostnames :subsetof [&#39;ns1.example.com&#39;, &#39;ns2.example.com&#39;] { ... }
</code></pre></div> <ul> <li><code>:supersetof</code> tests if the list of values from the given key is a superset of the values specified as the argument. Example for matching hosts with at least the IoT and vulnerable tags:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a>if extra.tags :supersetof [&#39;iot&#39;, &#39;vulnerable&#39;] { ... }
</code></pre></div> <ul> <li><code>:before</code> tests if the date value occurred before given time ago. The time might be absolute (basically anything parseable by pendulum parser, eg. “2015-09-12T06:22:11+00:00”) or relative (accepted string formatted like this “<integer> <epoch>”, where epoch could be any of following strings (could optionally end with trailing ‘s’): hour, day, week, month, year)</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a>if time.observation :before &#39;1 week&#39; { ... }
</code></pre></div> <ul> <li><code>:after</code> tests if the date value occurred after given time ago; see <code>:before</code></li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a>if time.observation :after &#39;2015-09-12&#39; { ... }  # happened after midnight the 12th Sep
</code></pre></div> <ul> <li>Boolean values can be matched with <code>==</code> or <code>!=</code> followed by <code>true</code> or <code>false</code>. Example:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a>if extra.has_known_vulns == true { ... }
</code></pre></div> <ul> <li>The combination of multiple expressions can be done using parenthesis and boolean operators:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a>if (source.ip == &#39;127.0.0.1&#39;) &amp;&amp; (comment == &#39;add field&#39; || classification.taxonomy == &#39;vulnerable&#39;) { ... }
</code></pre></div> <ul> <li>Any single expression or a parenthesised group of expressions can be negated using <code>!</code>:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a>if ! source.ip :contains &#39;127.0.0.&#39; || ! ( source.ip == &#39;172.16.0.5&#39; &amp;&amp; source.port == 25 ) { ... }
</code></pre></div> <p>!!! note Since 3.0.0, list-based operators are used on list values, such as <code>foo :in [1, 2, 3]</code> instead of <code>foo == [1, 2, 3]</code> and <code>foo :regexin ['.mx', '.zz']</code> rather than <code>foo =~ ['.mx', '.zz']</code>, and similarly for <code>:containsany</code> vs <code>:contains</code>. Besides that, <code>:notcontains</code> has been removed, with e.g <code>foo :notcontains ['.mx', '.zz']</code> now being represented using negation as <code>! foo :contains ['.mx', '.zz']</code>.</p> <p><em>Actions</em></p> <p>If part of a rule matches the given conditions, the actions enclosed in <code>{</code> and <code>}</code> are applied. By default, all events that are matched or not matched by rules in the sieve file will be forwarded to the next bot in the pipeline, unless the <code>drop</code> action is applied.</p> <ul> <li><code>add</code> adds a key value pair to the event. It can be a string, number, or boolean. This action only applies if the key is not yet defined in the event. If the key is already defined, the action is ignored. Example:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-70-1 name=__codelineno-70-1 href=#__codelineno-70-1></a>add comment = &#39;hello, world&#39;
</code></pre></div> <p>Some basic mathematical expressions are possible, but currently support only relative time specifications objects are supported. For example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-71-1 name=__codelineno-71-1 href=#__codelineno-71-1></a>add time.observation += &#39;1 hour&#39;
<a id=__codelineno-71-2 name=__codelineno-71-2 href=#__codelineno-71-2></a>add time.observation -= &#39;10 hours&#39;
</code></pre></div> <ul> <li> <p><code>add!</code> same as above, but will force overwrite the key in the event.</p> </li> <li> <p><code>update</code> modifies an existing value for a key. Only applies if the key is already defined. If the key is not defined in the event, this action is ignored. This supports mathematical expressions like above. Example:</p> </li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-72-1 name=__codelineno-72-1 href=#__codelineno-72-1></a>update feed.accuracy = 50
</code></pre></div> <p>Some basic mathematical expressions are possible, but currently support only relative time specifications objects are supported. For example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-73-1 name=__codelineno-73-1 href=#__codelineno-73-1></a>update time.observation += &#39;1 hour&#39;
<a id=__codelineno-73-2 name=__codelineno-73-2 href=#__codelineno-73-2></a>update time.observation -= &#39;10 hours&#39;
</code></pre></div> <ul> <li><code>remove</code> removes a key/value from the event. Action is ignored if the key is not defined in the event. Example:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-74-1 name=__codelineno-74-1 href=#__codelineno-74-1></a>remove extra.comments
</code></pre></div> <ul> <li> <p><code>keep</code> sends the message to the next bot in the pipeline (same as the default behaviour), and stops sieve rules processing.</p> </li> <li> <p><code>path</code> sets the path (named queue) the message should be sent to (implicitly or with the command <code>keep</code>. The named queue needs to configured in the pipeline, see the User Guide for more information.</p> </li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-75-1 name=__codelineno-75-1 href=#__codelineno-75-1></a>path &#39;named-queue&#39;
</code></pre></div> <p>You can as well set multiple destination paths with the same syntax as for value lists:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-76-1 name=__codelineno-76-1 href=#__codelineno-76-1></a>path [&#39;one&#39;, &#39;two&#39;]
</code></pre></div> <p>This will result in two identical message, one sent to the path <code>one</code> and the other sent to the path <code>two</code>.</p> <p>If the path is not configured, the error looks like:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-77-1 name=__codelineno-77-1 href=#__codelineno-77-1></a>File &quot;/path/to/intelmq/intelmq/lib/pipeline.py&quot;, line 353, in send for destination_queue in self.destination_queues path]: KeyError: &#39;one&#39;
</code></pre></div> <ul> <li><code>drop</code> marks the event to be dropped. The event will not be forwarded to the next bot in the pipeline. The sieve file processing is interrupted upon reaching this action. No other actions may be specified besides the <code>drop</code> action within <code>{</code> and <code>}</code>.</li> </ul> <p><em>Comments</em></p> <p>Comments may be used in the sieve file: all characters after <code>//</code> and until the end of the line will be ignored.</p> <hr> <h3 id=splunk-saved-search-lookup>Splunk Saved Search Lookup <div id=intelmq.bots.experts.splunk_saved_search.expert /></h3> <p>Runs a saved search in Splunk using fields in an event, adding fields from the search result into the event.</p> <p>Splunk documentation on saved searches: <a href=https://docs.splunk.com/Documentation/Splunk/latest/Report/Createandeditreports>https://docs.splunk.com/Documentation/Splunk/latest/Report/Createandeditreports</a></p> <p>The saved search should take parameters according to the <code>search_parameters</code> configuration and deliver results according to <code>result_fields</code>. The examples above match a saved search of this format:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-78-1 name=__codelineno-78-1 href=#__codelineno-78-1></a>index=&quot;dhcp&quot; ipv4address=&quot;$ip$&quot; | ... | fields _time username ether
</code></pre></div> <p>The time window used is the one saved with the search.</p> <p>Waits for Splunk to return an answer for each message, so slow searches will delay the entire botnet. If you anticipate a load of more than one search every few seconds, consider running multiple load-balanced copies of this bot.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.splunk_saved_search.expert</code></p> <p><strong>Parameters (also expects <a href=#http-parameters>HTTP parameters</a>):</strong></p> <p><strong><code>auth_token</code></strong></p> <p>(required, string) Splunk API authentication token.</p> <p><strong><code>url</code></strong></p> <p>(required, string) base URL of the Splunk REST API.</p> <p><strong><code>retry_interval</code></strong></p> <p>(optional, integer) Number of seconds to wait between polling for search results to be available. Defaults to 5.</p> <p><strong><code>saved_search</code></strong></p> <p>(required, string) Name of Splunk saved search to run.</p> <p><strong><code>search_parameters</code></strong></p> <p>(optional, object) Mapping of IntelMQ event fields containing the data to search for to parameters of the Splunk saved search. Defaults to <code>{}</code>. Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-79-1 name=__codelineno-79-1 href=#__codelineno-79-1></a><span class=nt>search_parameters</span><span class=p>:</span>
<a id=__codelineno-79-2 name=__codelineno-79-2 href=#__codelineno-79-2></a><span class=w>  </span><span class=nt>source.ip</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ip</span>
</code></pre></div> <p><strong><code>result_fields</code></strong></p> <p>(optional, object) Mapping of Splunk saved search result fields to IntelMQ event fields to store the results in. Defaults to <code>{}</code>. Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-80-1 name=__codelineno-80-1 href=#__codelineno-80-1></a><span class=nt>result_fields</span><span class=p>:</span>
<a id=__codelineno-80-2 name=__codelineno-80-2 href=#__codelineno-80-2></a><span class=w>  </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source.account</span>
</code></pre></div> <p><strong><code>not_found</code></strong></p> <p>(optional, array of strings) How to handle empty search results. Allowed values:</p> <ul> <li><code>warn</code> - log a warning message</li> <li><code>send</code> - send the event on unmodified</li> <li><code>drop</code> - drop the message</li> <li><code>send</code> - and <code>drop</code> are mutually exclusive</li> </ul> <p>All specified actions are performed. Defaults to <code>[ "warn", "send" ]</code>.</p> <p><strong><code>multiple_result_handling</code></strong></p> <p>(optional, array of strings) How to handle more than one search result. Allowed values:</p> <ul> <li><code>limit</code> - limit the search so that duplicates are impossible</li> <li><code>warn</code> - log a warning message</li> <li><code>use_first</code> - use the first search result</li> <li><code>ignore</code> - do not modify the event</li> <li><code>send</code> - send the event on</li> <li><code>drop</code> - drop the message</li> <li><code>limit</code> cannot be combined with any other value</li> <li><code>send</code> and <code>drop</code> are mutually exclusive</li> <li><code>ignore</code> and <code>use_first</code> are mutually exclusive</li> </ul> <p>All specified actions are performed. Defaults to <code>["warn", "use_first", "send" ]</code>.</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean/null) Whether search results overwrite values already in the message or not. If null, attempting to add a field that already exists throws an exception. Defaults to null.</p> <hr> <h3 id=taxonomy>Taxonomy <div id=intelmq.bots.experts.taxonomy.expert /></h3> <p>This bot adds the <code>classification.taxonomy</code> field according to the RSIT taxonomy.</p> <p>Please note that there is a slight mismatch of IntelMQ's taxonomy to the upstream taxonomy. See also this <a href=https://github.com/certtools/intelmq/issues/1409>issue</a>.</p> <p>Information on the "Reference Security Incident Taxonomy" can be found here: <a href=https://github.com/enisaeu/Reference-Security-Incident-Taxonomy-Task-Force>https://github.com/enisaeu/Reference-Security-Incident-Taxonomy-Task-Force</a></p> <p>For brevity, "type" means <code>classification.type</code> and "taxonomy" means <code>classification.taxonomy</code>.</p> <ul> <li>If taxonomy is missing, and type is given, the according taxonomy is set.</li> <li>If neither taxonomy, not type is given, taxonomy is set to "other" and type to "unknown".</li> <li>If taxonomy is given, but type is not, type is set to "unknown".</li> </ul> <p><strong>Module:</strong> <code>intelmq.bots.experts.taxonomy.expert</code></p> <p>No additional parameters.</p> <hr> <h3 id=threshold>Threshold <div id=intelmq.bots.experts.threshold.expert /></h3> <p>Check if the number of similar messages during a specified time interval exceeds a set value.</p> <p><strong>Limitations</strong></p> <p>This bot has certain limitations and is not a true threshold filter (yet). It works like this:</p> <ol> <li>Every incoming message is hashed according to the <code>filter_*</code> parameters.</li> <li>The hash is looked up in the cache and the count is incremented by 1, and the TTL of the key is (re-)set to the timeout.</li> <li>If the new count matches the threshold exactly, the message is forwarded. Otherwise it is dropped.</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Even if a message is sent, any further identical messages are dropped, if the time difference to the last message is less than the timeout! The counter is not reset if the threshold is reached.</p> </div> <p><strong>Module:</strong> <code>intelmq.bots.experts.threshold.expert</code></p> <p><strong>Parameters (also expects <a href=#cache-parameters>cache parameters</a>):</strong></p> <p><strong><code>filter_keys</code></strong></p> <p>(required, string/array of strings) Array or comma-separated list of field names to consider or ignore when determining which messages are similar.</p> <p><strong><code>filter_type</code></strong></p> <p>(required, string) Allowed values: <code>whitelist</code> or <code>blacklist</code>. When <code>whitelist</code> is used, only lines containing the text specified in <code>filter_text</code> option will be processed. When <code>blacklist</code> is used, only lines NOT containing the text will be processed.</p> <p><strong><code>threshold</code></strong></p> <p>(required, integer) Number of messages required before propagating one. In forwarded messages, the threshold is saved in the message as <code>extra.count</code>.</p> <p><strong><code>add_keys</code></strong></p> <p>(optional, object) List of keys and their respective values to add to the propagated messages. Example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-81-1 name=__codelineno-81-1 href=#__codelineno-81-1></a><span class=nt>add_keys</span><span class=p>:</span>
<a id=__codelineno-81-2 name=__codelineno-81-2 href=#__codelineno-81-2></a><span class=w>  </span><span class=nt>classification.type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;spam&quot;</span>
<a id=__codelineno-81-3 name=__codelineno-81-3 href=#__codelineno-81-3></a><span class=w>  </span><span class=nt>comment</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Started</span><span class=nv> </span><span class=s>more</span><span class=nv> </span><span class=s>than</span><span class=nv> </span><span class=s>10</span><span class=nv> </span><span class=s>SMTP</span><span class=nv> </span><span class=s>connections&quot;</span>
</code></pre></div> <hr> <h3 id=tor-exit-node>Tor Exit Node <div id=intelmq.bots.experts.tor_nodes.expert /></h3> <p>This bot uses an offline database to determine whether the host is a Tor exit node.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.tor_nodes.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>database</code></strong></p> <p>(required, string) Path to the database file.</p> <p><strong>Database</strong></p> <p>Use this command to create/update the database and reload the bot:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-82-1 name=__codelineno-82-1 href=#__codelineno-82-1></a>intelmq.bots.experts.tor_nodes.expert<span class=w> </span>--update-database
</code></pre></div> <hr> <h3 id=trusted-introducer-lookup>Trusted Introducer Lookup <div id=intelmq.bots.experts.trusted_introducer_lookup.expert /></h3> <p>Lookups data from Trusted Introducer public teams list.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.trusted_introducer_lookup.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>order</code></strong></p> <p>(required, string) Allowed values: <code>domain</code> and <code>asn</code>. You can set multiple values, so first match wins.</p> <ul> <li>When <code>domain</code> is set, it will lookup the <code>source.fqdn</code> field. It will go from high-order to low-order, i.e. <code>1337.super.example.com -&gt; super.example.com -&gt; example.com -&gt; .com</code></li> <li>If <code>asn</code> is set, it will lookup <code>source.asn</code>.</li> </ul> <p>After a match, the abuse contact will be fetched from the trusted introducer teams list and will be stored in the event as <code>source.abuse_contact</code>. If there is no match, the event will not be enriched and will be sent to the next configured step.</p> <hr> <h3 id=tuency>Tuency <div id=intelmq.bots.experts.tuency.expert /></h3> <p>Queries the <a href=https://gitlab.com/intevation/tuency/tuency/-/blob/master/backend/docs/IntelMQ-API.md>IntelMQ API</a> of a <a href=https://gitlab.com/intevation/tuency/tuency/ >Tuency Contact Database</a> instance.</p> <p><em>Tuency</em> is a contact management database addressing the needs of CERTs. Users of <em>tuency</em> can configure contact addresses and delivery settings for IP objects (addresses, netblocks), Autonomous Systems, and (sub-)domains. This expert queries the information for <code>source.ip</code> and <code>source.fqdn</code> using the following other fields:</p> <ul> <li><code>classification.taxonomy</code></li> <li><code>classification.type</code></li> <li><code>feed.provider</code></li> <li><code>feed.name</code></li> </ul> <p>These fields therefore need to exist, otherwise the message is skipped.</p> <p>The API parameter "feed_status" is currently set to "production" constantly, until IntelMQ supports this field.</p> <p>The API answer is processed as following. For the notification interval:</p> <ul> <li>If <em>suppress</em> is true, then <code>extra.notify</code> is set to false.</li> <li>Otherwise:</li> <li>If the interval is <em>immediate</em>, then <code>extra.ttl</code> is set to 0.</li> <li>Otherwise the interval is converted into seconds and saved in <code>extra.ttl</code>.</li> </ul> <p>For the contact lookup: For both fields <em>ip</em> and <em>domain</em>, the <em>destinations</em> objects are iterated and its <em>email</em> fields concatenated to a comma-separated list in <code>source.abuse_contact</code>.</p> <p>The IntelMQ fields used by this bot may change in the next IntelMQ release, as soon as better suited fields are available.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.tuency.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>url</code></strong></p> <p>(required, string) Tuency instance URL. Without the API path.</p> <p><strong><code>authentication_token</code></strong></p> <p>(required, string) The Bearer authentication token. Without the <code>Bearer</code> prefix.</p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether the existing data in <code>source.abuse_contact</code> should be overwritten. Defaults to true.</p> <hr> <h3 id=truncate-by-delimiter>Truncate By Delimiter <div id=intelmq.bots.experts.truncate_by_delimiter.expert /></h3> <p>Cut string if length is bigger than maximum length.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.truncate_by_delimiter.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>delimiter</code></strong></p> <p>(required, string) The delimiter to be used for truncating. Defaults to <code>.</code>.</p> <p><strong><code>max_length</code></strong></p> <p>(required, integer) The maximum string length.</p> <p><strong><code>field</code></strong></p> <p>(required, string) The field to be truncated, e.g. <code>source.fqdn</code>. The given field is truncated step-by-step using the delimiter from the beginning, until the field is shorter than <code>max_length</code>.</p> <p>Example: Cut through a long domain with a dot. The string is truncated until the domain does not exceed the configured maximum length.</p> <ul> <li>Input domain (e.g. <code>source.fqdn</code>): <code>www.subdomain.web.secondsubomain.test.domain.com</code></li> <li><code>delimiter</code>: <code>.</code></li> <li><code>max_length</code>: 20</li> <li>Resulting value <code>test.domain.com</code> (length: 15 characters)</li> </ul> <hr> <h3 id=url>URL <div id=intelmq.bots.experts.url.expert /></h3> <p>This bot extracts additional information from <code>source.url</code> and <code>destination.url</code> fields. It can fill the following fields:</p> <ul> <li><code>source.fqdn</code></li> <li><code>source.ip</code></li> <li><code>source.port</code></li> <li><code>source.urlpath</code></li> <li><code>source.account</code></li> <li><code>destination.fqdn</code></li> <li><code>destination.ip</code></li> <li><code>destination.port</code></li> <li><code>destination.urlpath</code></li> <li><code>destination.account</code></li> <li><code>protocol.application</code></li> <li><code>protocol.transport</code></li> </ul> <p><strong>Module:</strong> <code>intelmq.bots.experts.url.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing fields. Defaults to false.</p> <p><strong><code>skip_fields</code></strong></p> <p>(optional, array of string) An array of field names that shouldn't be extracted from the URL.</p> <hr> <h3 id=url2fqdn>Url2FQDN <div id=intelmq.bots.experts.url2fqdn.expert /></h3> <p>This bot is deprecated and will be removed in version 4.0. Use <a href=#intelmq.bots.experts.url.expert>URL Expert</a> bot instead.</p> <p>This bot extracts the Host from the <code>source.url</code> and <code>destination.url</code> fields and writes it to <code>source.fqdn</code> or <code>destination.fqdn</code> if it is a hostname, or <code>source.ip</code> or <code>destination.ip</code> if it is an IP address.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.url2fqdn.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>overwrite</code></strong></p> <p>(optional, boolean) Whether to overwrite existing fields. Defaults to false.</p> <hr> <h3 id=uwhoisd>uWhoisd <div id=intelmq.bots.experts.uwhoisd.expert /></h3> <p><a href=https://github.com/Lookyloo/uwhoisd>uWhoisd</a> is a universal Whois server that supports caching and stores whois entries for historical purposes.</p> <p>The bot sends a request for <code>source.url</code>, <code>source.fqdn</code>, <code>source.ip</code> or <code>source.asn</code> to the configured uWhoisd instance and saves the retrieved whois entry:</p> <ul> <li>If both <code>source.url</code> and <code>source.fqdn</code> are present, it will only do a request for <code>source.fqdn</code>, as the hostname of <code>source.url</code> should be the same as <code>source.fqdn</code>. The whois entry will be saved in <code>extra.whois.fqdn</code>.</li> <li>If <code>source.ip</code> is present, the whois entry will be saved in <code>extra.whois.ip</code>.</li> <li>If <code>source.asn</code> is present, he whois entry will be saved in <code>extra.whois.asn</code>.</li> </ul> <p>Events without <code>source.url</code>, <code>source.fqdn</code>, <code>source.ip</code>, or <code>source.asn</code>, are ignored.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Requesting a whois entry for a fully qualified domain name (FQDN) only works if the request only contains the domain. uWhoisd will automatically strip the subdomain part if it is present in the request.</p> </div> <p>Example: <code>https://www.theguardian.co.uk</code></p> <ul> <li>TLD: <code>co.uk</code> (uWhoisd uses the <a href=https://publicsuffix.org/list/ >Mozilla public suffix list</a> as a reference)</li> <li>Domain: <code>theguardian.co.uk</code></li> <li>Subdomain: <code>www</code></li> </ul> <p>The whois request will be for <code>theguardian.co.uk</code></p> <p><strong>Module:</strong> <code>intelmq.bots.experts.uwhoisd.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>server</code></strong></p> <p>(optional, string) Hostname of the uWhoisd server. Defaults to localhost.</p> <p><strong><code>port</code></strong></p> <p>(optional, integer) Port of the uWhoisd server. Defaults to 4243.</p> <hr> <h3 id=wait>Wait <div id=intelmq.bots.experts.wait.expert /></h3> <p>Waits for a some time or until a queue size is lower than a given number.</p> <p>Only one of the two modes is possible. If a queue name is given, the queue mode is active. If the sleep_time is a number, sleep mode is active. Otherwise the dummy mode is active, the events are just passed without an additional delay.</p> <p>Note that SIGHUPs and reloads interrupt the sleeping.</p> <p><strong>Module:</strong> <code>intelmq.bots.experts.wait.expert</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>queue_db</code></strong></p> <p>(optional, integer) Database number of the database. Defaults to 2.</p> <p><strong><code>queue_host</code></strong></p> <p>(optional, string) Hostname of the database. Defaults to localhost.</p> <p><strong><code>queue_name</code></strong></p> <p>(optional, string) Name of the queue to be watched. This is not the name of a bot but the queue's name. Defaults to null.</p> <p><strong><code>queue_password</code></strong></p> <p>(optional, string) Password for the database. Defaults to null.</p> <p><strong><code>queue_polling_interval</code></strong></p> <p>(required, float) Interval to poll the list length in seconds. Defaults to ?.</p> <p><strong><code>queue_port</code></strong></p> <p>(optional, integer) Port of the database. Defaults to 6379.</p> <p><strong><code>queue_size</code></strong></p> <p>(optional, integer) Maximum size of the queue. Defaults to 0.</p> <p><strong><code>sleep_time</code></strong></p> <p>(optional, integer) Time to sleep before sending the event. Defaults to null.</p> <h2 id=output-bots>Output Bots</h2> <h3 id=amqp-topic>AMQP Topic <div id=intelmq.bots.outputs.amqptopic.output /></h3> <p>Sends the event to a specified topic of an AMQP server</p> <p>Sends data to an AMQP Server See <a href=https://www.rabbitmq.com/tutorials/amqp-concepts.html>https://www.rabbitmq.com/tutorials/amqp-concepts.html</a> for more details on amqp topic exchange.</p> <p>Requires the <a href=https://pypi.org/project/pika/ >pika python library</a>.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.amqptopic.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>connection_attempts</code></strong></p> <p>(optional, integer) The number of connection attempts to defined server. Defaults to 3.</p> <p><strong><code>connection_heartbeat</code></strong></p> <p>(optional, integer) Heartbeat to server (in seconds). Defaults to 3600.</p> <p><strong><code>connection_host</code></strong></p> <p>(optional, string) Hostname of the AMQP server. Defaults to 127.0.0.1.</p> <p><strong><code>connection_port</code></strong></p> <p>(optional, integer) Port of the AMQP server. Defaults to 5672.</p> <p><strong><code>connection_vhost</code></strong></p> <p>(optional, string) Virtual host to connect, on an http(s) connection would be <code>http://IP/&lt;your virtual host&gt;</code>.</p> <p><strong><code>content_type</code></strong></p> <p>(optional, string) Content type to deliver to AMQP server. Currently only supports <code>application/json</code>.</p> <p><strong><code>delivery_mode</code></strong></p> <p>(optional, integer) Allowed values:</p> <ul> <li><code>1</code> - Non-persistent delivery.</li> <li><code>2</code> - Persistent delivery. Messages are delivered to 'durable' queues and will be saved to disk.</li> </ul> <p><strong><code>exchange_durable</code></strong></p> <p>(optional, boolean) When set to true, the exchange will survive broker restart, otherwise will be a transient exchange.</p> <p><strong><code>exchange_name</code></strong></p> <p>(optional, string) The name of the exchange to use.</p> <p><strong><code>exchange_type</code></strong></p> <p>(optional, string) Type of the exchange, e.g. <code>topic</code>, <code>fanout</code> etc.</p> <p><strong><code>keep_raw_field</code></strong></p> <p>(optional, boolean) Whether to keep the <code>raw</code> field or not. Defaults to false.</p> <p><strong><code>password</code></strong></p> <p>(optional, boolean) Password for authentication on your AMQP server. Leave empty if authentication is not required.</p> <p><strong><code>require_confirmation</code></strong></p> <p>(optional, boolean) If set to True, an exception will be raised if a confirmation error is received.</p> <p><strong><code>routing_key</code></strong></p> <p>(required, string) The routing key for your amqptopic.</p> <p><strong><code>single_key</code></strong></p> <p>(optional, boolean) Only send the field instead of the full event (expecting a field name as string). Defaults to false.</p> <p><strong><code>username</code></strong></p> <p>(required, string) Username for authentication on your AMQP server.</p> <p><strong><code>use_ssl</code></strong></p> <p>(optional, boolean) Use ssl for the connection, make sure to also set the correct port, usually 5671. Defaults to false.</p> <p><strong><code>message_hierarchical_output</code></strong></p> <p>(optional, boolean) Convert the message to hierarchical JSON. Defaults to false.</p> <p><strong><code>message_with_type</code></strong></p> <p>(optional, boolean) Whether to include the type in the sent message. Defaults to false.</p> <p><strong><code>message_jsondict_as_string</code></strong></p> <p>(optional, boolean) Whether to convert JSON fields (<code>extra</code>) to string. Defaults to false.</p> <p><strong>Examples of usage</strong></p> <ul> <li>Useful to send events to a RabbitMQ exchange topic to be further processed in other platforms.</li> </ul> <p><strong>Confirmation</strong></p> <p>If routing key or exchange name are invalid or non existent, the message is accepted by the server but we receive no confirmation. If parameter require_confirmation is True and no confirmation is received, an error is raised.</p> <p><strong>Common errors</strong></p> <p><em>Unroutable messages / Undefined destination queue</em></p> <p>The destination exchange and queue need to exist beforehand, with your preferred settings (e.g. durable, <a href=https://www.rabbitmq.com/lazy-queues.html>lazy queue</a>. If the error message says that the message is "unroutable", the queue doesn't exist.</p> <hr> <h3 id=blackhole>Blackhole <div id=intelmq.bots.outputs.blackhole.output /></h3> <p>This bot discards all incoming messages.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.blackhole.output</code></p> <p>No additional parameters.</p> <hr> <h3 id=bro-file>Bro File <div id=intelmq.bots.outputs.bro_file.output /></h3> <p>This bot outputs to BRO (zeek) file.</p> <p>File example:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-83-1 name=__codelineno-83-1 href=#__codelineno-83-1></a>#fields indicator indicator_type meta.desc meta.cif_confidence meta.source xxx.xxx.xxx.xxx Intel::ADDR phishing 100 MISP XXX www.testdomain.com Intel::DOMAIN apt 85 CERT
</code></pre></div> <p><strong>Module:</strong> <code>intelmq.bots.outputs.bro_file.output</code></p> <p>No additional parameters.</p> <hr> <h3 id=cifv3-api>CIFv3 API <div id=intelmq.bots.outputs.cif3.output /></h3> <p>This bot outputs to a CIFv3 API instance and adds new indicator if not there already.</p> <p>By default, CIFv3 does an upsert check and will only insert entirely new indicators. Otherwise, upsert matches will have their count increased by 1. By default, the CIF3 output bot will batch indicators up to 500 at a time prior to doing a single bulk send. If the output bot doesn't receive a full 500 indicators within 5 seconds of the first received indicator, it will send what it has so far.</p> <p>CIFv3 should be able to process indicators as fast as IntelMQ can send them.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.cif3.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>add_feed_provider_as_tag</code></strong></p> <p>(required, boolean) Use <code>false</code> when in doubt.</p> <p><strong><code>cif3_additional_tags</code></strong></p> <p>(required, array of strings) An array of tags to set on submitted indicator(s).</p> <p><strong><code>cif3_feed_confidence</code></strong></p> <p>(required, float) Used when mapping a feed's confidence fails or if static confidence parameter is true.</p> <p><strong><code>cif3_static_confidence</code></strong></p> <p>(required, boolean) Whether to always use <code>cif3_feed_confidence</code> value as confidence rather than dynamically interpret feed value (use <code>false</code> when in doubt).</p> <p><strong><code>cif3_token</code></strong></p> <p>(required, string) Token key for accessing CIFv3 API.</p> <p><strong><code>cif3_url</code></strong></p> <p>(required, string) URL of the CIFv3 instance.</p> <p><strong><code>fireball</code></strong></p> <p>(required, integer) Used to batch events before submitting to a CIFv3 instance, use 0 to disable batch and send each event as received. Defaults to 500.</p> <p><strong><code>http_verify_cert</code></strong></p> <p>(optional, boolean) Verify the TLS certificate of the server. Defaults to true.</p> <hr> <h3 id=elasticsearch>Elasticsearch <div id=intelmq.bots.outputs.elasticsearch.output /></h3> <p>This bot outputs to Elasticsearch.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.elasticsearch.output</code></p> <ul> <li><code>lookup</code>: yes</li> <li><code>public</code>: yes</li> <li><code>cache</code>: no</li> <li><code>description</code>: Output Bot that sends events to Elasticsearch</li> </ul> <p>Only ElasticSearch version 7 supported.</p> <p>It is also possible to feed data into ElasticSearch using ELK-Stack via Redis and Logstash, see <code>ELK-Stack</code> {.interpreted-text role="doc"} for more information. This methods supports various different versions of ElasticSearch.</p> <p><strong>Parameters:</strong></p> <p><strong><code>elastic_host</code></strong></p> <p>(optional, string) Name/IP for the Elasticsearch server. Defaults to 127.0.0.1.</p> <p><strong><code>elastic_port</code></strong></p> <p>(optional, int) Port for the Elasticsearch server. Defaults to 9200.</p> <p><strong><code>elastic_index</code></strong></p> <p>(optional, string) Index for the Elasticsearch output. Defaults to intelmq.</p> <p><strong><code>rotate_index</code></strong></p> <p>(optional, string) Allowed values: <code>never</code>, <code>daily</code>, <code>weekly</code>, <code>monthly</code> or <code>yearly</code>. If set, will index events using the date information associated with the event. Defaults to never.</p> <p>Using 'intelmq' as the <code>elastic_index</code>, the following are examples of the generated index names:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-84-1 name=__codelineno-84-1 href=#__codelineno-84-1></a>&#39;never&#39; --&gt; intelmq
<a id=__codelineno-84-2 name=__codelineno-84-2 href=#__codelineno-84-2></a>&#39;daily&#39; --&gt; intelmq-2018-02-02
<a id=__codelineno-84-3 name=__codelineno-84-3 href=#__codelineno-84-3></a>&#39;weekly&#39; --&gt; intelmq-2018-42
<a id=__codelineno-84-4 name=__codelineno-84-4 href=#__codelineno-84-4></a>&#39;monthly&#39; --&gt; intelmq-2018-02
<a id=__codelineno-84-5 name=__codelineno-84-5 href=#__codelineno-84-5></a>&#39;yearly&#39; --&gt; intelmq-2018
</code></pre></div> <p><strong><code>http_username</code></strong></p> <p>(optional, string) HTTP basic authentication username.</p> <p><strong><code>http_password</code></strong></p> <p>(optional, string) HTTP basic authentication password.</p> <p><strong><code>use_ssl</code></strong></p> <p>(optional, boolean) Whether to use SSL/TLS when connecting to Elasticsearch. Defaults to false.</p> <p><strong><code>http_verify_cert</code></strong></p> <p>(optional, boolean) Whether to require verification of the server's certificate. Defaults to false.</p> <p><strong><code>ssl_ca_certificate</code></strong></p> <p>(optional, string) Path to trusted CA certificate.</p> <p><strong><code>ssl_show_warnings</code></strong></p> <p>(optional, boolean) Whether to show warnings if the server's certificate cannot be verified. Defaults to true.</p> <p><strong><code>replacement_char</code></strong></p> <p>(optional, string) If set, dots ('.') in field names will be replaced with this character prior to indexing. This is for backward compatibility with ES 2.X. Defaults to null. Recommended for Elasticsearch 2.X: <code>_</code></p> <p><strong><code>flatten_fields</code></strong></p> <p>(optional, array of strings) In ES, some query and aggregations work better if the fields are flat and not JSON. Here you can provide a list of fields to convert. Defaults to <code>['extra']</code>.</p> <p>Can be a list of strings (fieldnames) or a string with field names separated by a comma (,). eg <code>extra,field2</code> or <code>['extra', 'field2']</code>.</p> <p>See <code>contrib/elasticsearch/elasticmapper</code> for a utility for creating Elasticsearch mappings and templates.</p> <p>If using <code>rotate_index</code>, the resulting index name will be of the form <code>elastic_index</code>-<code>event date</code>. To query all intelmq indices at once, use an alias (<a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-aliases.html>https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-aliases.html</a>), or a multi-index query.</p> <p>The data in ES can be retrieved with the HTTP-Interface:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-85-1 name=__codelineno-85-1 href=#__codelineno-85-1></a><span class=w> </span>curl<span class=w> </span>-XGET<span class=w> </span><span class=s1>&#39;http://localhost:9200/intelmq/events/_search?pretty=True&#39;</span>
</code></pre></div> <hr> <h3 id=file_1>File <div id=intelmq.bots.outputs.file.output /></h3> <p>This bot outputs messages (reports or events) to a file.</p> <p>Multihreading is disabled for this bot, as this would lead to corrupted files.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.file.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>encoding_errors_mode</code></strong></p> <p>(optional, string) See for more details and options: <a href=https://docs.python.org/3/library/functions.html#open>https://docs.python.org/3/library/functions.html#open</a> For example with <code>backslashreplace</code> all characters which cannot be properly encoded will be written escaped with backslashes. Defaults to <code>strict</code>.</p> <p><strong><code>file</code></strong></p> <p>(optional, string) Path to the output file. Missing directories will be created if possible with the mode 755. Defaults to <code>/opt/intelmq/var/lib/bots/file-output/events.txt</code>.</p> <p><strong><code>format_filename</code></strong></p> <p>(optional, boolean) Whether the file name should be formatted. Defaults to false.</p> <p>Uses Python formatted strings. See: <a href=https://docs.python.org/3/library/string.html#formatstrings>https://docs.python.org/3/library/string.html#formatstrings</a></p> <p>Example:</p> <ul> <li>The filename <code>.../{event[source.abuse_contact]}.txt</code> will be (for example) <code>.../abuse@example.com.txt</code>.</li> <li><code>.../{event[time.source]:%Y-%m-%d}</code> results in the date of the event used as filename.</li> </ul> <p>If the field used in the format string is not defined, <code>None</code> will be used as fallback.</p> <p><strong><code>hierarchical_output</code></strong></p> <p>(optional, boolean) Whether the resulting dictionary should be hierarchical (field names split by a dot). Defaults to false.</p> <p><strong><code>single_key</code></strong></p> <p>(optional, string) Output only a single specified key. In case of <code>raw</code> key the data is base64 decoded. Defaults to null (output the whole message).</p> <hr> <h3 id=files>Files <div id=intelmq.bots.outputs.files.output /></h3> <p>This bot outputs each message to a separate file.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.files.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>dir</code></strong></p> <p>(optional, string) Path to the output directory. Defaults to <code>/opt/intelmq/var/lib/bots/files-output/incoming</code>.</p> <p><strong><code>tmp</code></strong></p> <p>(optional, string) Temporary directory to use (must reside on the same filesystem as <code>dir</code>). Defaults to <code>/opt/intelmq/var/lib/bots/files-output/tmp</code>.</p> <p><strong><code>suffix</code></strong></p> <p>(optional, strings) Extension of created files. Defaults to .json.</p> <p><strong><code>hierarchical_output</code></strong></p> <p>(optional, boolean) Whether the resulting dictionary should be hierarchical (field names split by a dot). Defaults to false.</p> <p><strong><code>single_key</code></strong></p> <p>(optional, string) Output only a single specified key. In case of <code>raw</code> key the data is base64 decoded. Defaults to null (output the whole message).</p> <hr> <h3 id=mcafee-enterprise-security-manager>McAfee Enterprise Security Manager <div id=intelmq.bots.outputs.mcafee.output_esm_ip /></h3> <p>This bot outputs messages to McAfee Enterprise Security Manager watchlist.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.mcafee.output_esm_ip</code></p> <p><strong>Parameters:</strong></p> <ul> <li><strong>Feed parameters</strong> (see above)</li> </ul> <p><strong><code>esm_ip</code></strong></p> <p>(optional, string) Hostname of the ESM server. Defaults to 1.2.3.4.</p> <p><strong><code>esm_user</code></strong></p> <p>(optional, string) Username of user entitled to write to watchlist. Defaults to NGCP.</p> <p><strong><code>esm_pw</code></strong></p> <p>(required, string) Password of user entitled to write to watchlist.</p> <p><strong><code>esm_watchlist</code></strong></p> <p>(required, string) Name of the watchlist to write to.</p> <p><strong><code>field</code></strong></p> <p>(optional, string) Name of the IntelMQ field to be written to ESM. Defaults to source.ip.</p> <hr> <h3 id=misp-feed>MISP Feed <div id=intelmq.bots.outputs.misp.output_feed /></h3> <p>Create a directory layout in the MISP Feed format.</p> <p>The PyMISP library &gt;= 2.4.119.1 is required, see <a href=https://github.com/certtools/intelmq/blob/master/intelmq/bots/outputs/misp/REQUIREMENTS.txt>REQUIREMENTS.txt</a>.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.misp.output_feed</code></p> <p><strong>Parameters:</strong></p> <ul> <li><strong>Feed parameters</strong> (see above)</li> </ul> <p><strong><code>misp_org_name</code></strong></p> <p>() Org name which creates the event, string</p> <p><strong><code>misp_org_uuid</code></strong></p> <p>() Org UUID which creates the event, string</p> <p><strong><code>output_dir</code></strong></p> <p>() Output directory path, e.g. [/opt/intelmq/var/lib/bots/mispfeed-output]. Will be created if it does not exist and possible.</p> <p><strong><code>interval_event</code></strong></p> <p>() The output bot creates one event per each interval, all data in this time frame is part of this event. Default "1 hour", string.</p> <p><strong>Usage in MISP</strong></p> <p>Configure the destination directory of this feed as feed in MISP, either as local location, or served via a web server. See <a href=https://www.circl.lu/doc/misp/managing-feeds>the MISP documentation on Feeds</a> for more information</p> <hr> <h3 id=misp-api>MISP API <div id=intelmq.bots.outputs.misp.output_api /></h3> <p><strong>Module:</strong> <code>intelmq.bots.outputs.misp.output_api</code></p> <p>Connect to a MISP instance and add event as MISPObject if not there already.</p> <p>The PyMISP library &gt;= 2.4.120 is required, see <a href=https://github.com/certtools/intelmq/blob/master/intelmq/bots/outputs/misp/REQUIREMENTS.txt>REQUIREMENTS.txt</a>.</p> <p><strong>Parameters:</strong></p> <ul> <li><strong>Feed parameters</strong> (see above)</li> </ul> <p><strong><code>add_feed_provider_as_tag</code></strong></p> <p>() boolean (use [true] when in doubt)</p> <p><strong><code>add_feed_name_as_tag</code></strong></p> <p>() boolean (use [true] when in doubt)</p> <p><strong><code>misp_additional_correlation_fields</code></strong></p> <p>() list of fields for which the correlation flags will be enabled (in addition to those which are in significant_fields)</p> <p><strong><code>misp_additional_tags</code></strong></p> <p>() list of tags to set not be searched for when looking for duplicates</p> <p><strong><code>misp_key</code></strong></p> <p>() string, API key for accessing MISP</p> <p><strong><code>misp_publish</code></strong></p> <p>() boolean, if a new MISP event should be set to "publish".</p> <p>Expert setting as MISP may really make it "public"! (Use [false] when in doubt.)</p> <p><strong><code>misp_tag_for_bot</code></strong></p> <p>() string, used to mark MISP events</p> <p><strong><code>misp_to_ids_fields</code></strong></p> <p>() list of fields for which the [to_ids] flags will be set</p> <p><strong><code>misp_url</code></strong></p> <p>() string, URL of the MISP server</p> <p><strong><code>significant_fields</code></strong></p> <p>() list of intelmq field names</p> <p>The <code>significant_fields</code> values will be searched for in all MISP attribute values and if all values are found in the same MISP event, no new MISP event will be created. Instead if the existing MISP events have the same feed.provider and match closely, their timestamp will be updated.</p> <p>If a new MISP event is inserted the <code>significant_fields</code> and the <code>misp_additional_correlation_fields</code> will be the attributes where correlation is enabled.</p> <p>Make sure to build the IntelMQ Botnet in a way the rate of incoming events is what MISP can handle, as IntelMQ can process many more events faster than MISP (which is by design as MISP is for manual handling). Also remove the fields of the IntelMQ events with an expert bot that you do not want to be inserted into MISP.</p> <p>(More details can be found in the docstring of <a href=https://github.com/certtools/intelmq/blob/master/intelmq/bots/outputs/misp/output_api.py>output_api.py</a>.</p> <hr> <h3 id=mongodb>MongoDB <div id=intelmq.bots.outputs.mongodb.output /></h3> <p>MongoDB is the bot responsible to send events to a MongoDB database</p> <p>Saves events in a MongoDB either as hierarchical structure or flat with full key names. <code>time.observation</code> and <code>time.source</code> are saved as datetime objects, not as ISO formatted string.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.mongodb.output</code></p> <p><strong>Requirements</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-86-1 name=__codelineno-86-1 href=#__codelineno-86-1></a>pip3<span class=w> </span>install<span class=w> </span>pymongo&gt;<span class=o>=</span><span class=m>2</span>.7.1
</code></pre></div> <p>The bot has been tested with pymongo versions 2.7.1, 3.4 and 3.10.1 (server versions 2.6.10 and 3.6.8).</p> <p><strong>Parameters:</strong></p> <p><strong><code>host</code></strong></p> <p>(optional, string) Hostname of the MongoDB server. Defaults to localhost.</p> <p><strong><code>port</code></strong></p> <p>(optional, integer) Port of the MongoDB server. Defaults to 27017.</p> <p><strong><code>database</code></strong></p> <p>(required, string) Name of the MongoDB database to use.</p> <p><strong><code>db_user</code></strong></p> <p>(optional, string) User that should be used if authentication is required.</p> <p><strong><code>db_pass</code></strong></p> <p>(optional, string) Password.</p> <p><strong><code>collection</code></strong></p> <p>(required, string) Name of the MongoDB collection to use.</p> <p><strong><code>hierarchical_output</code></strong></p> <p>(optional, boolean) MongoDB does not allow saving keys with dots, we split the dictionary in sub-dictionaries. Defaults to true.</p> <p><strong><code>replacement_char</code></strong></p> <p>(optional, string) Replacement character for replacing the dots in key names if hierarchical output is not used. Defaults to <code>_</code>.</p> <hr> <h3 id=redis>Redis <div id=intelmq.bots.outputs.redis.output /></h3> <p>This bot outputs events to a remote Redis server/queue.</p> <p><strong>Examples of usage</strong></p> <ul> <li>Can be used to send events to be processed in another system. E.g.: send events to Logstash.</li> <li>In a multi tenant installation can be used to send events to external/remote IntelMQ instance. Any expert bot queue can receive the events.</li> <li>In a complex configuration can be used to create logical sets in IntelMQ-Manager.</li> </ul> <p><strong>Module:</strong> <code>intelmq.bots.outputs.redis.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>redis_server_ip</code></strong></p> <p>(optional, string) Hostname of the Redis server. Defaults to 127.0.0.1.</p> <p><strong><code>redis_server_port</code></strong></p> <p>(optional, integer) Port of the Redis server. Defaults to 6379.</p> <p><strong><code>redis_db</code></strong></p> <p>(optional, integer) Redis database number. Defaults to 2.</p> <p><strong><code>redis_password</code></strong></p> <p>(optional, string) Redis server password. Defaults to null.</p> <p><strong><code>redis_queue</code></strong></p> <p>(required, string) Redis queue name (such as <code>remote-server-queue</code>).</p> <p><strong><code>redis_timeout</code></strong></p> <p>(optional, integer) Connection timeout, in milliseconds. Defaults to 5000.</p> <p><strong><code>hierarchical_output</code></strong></p> <p>(optional, boolean) Whether the resulting dictionary should be hierarchical (field names split by a dot). Defaults to false.</p> <p><strong><code>with_type</code></strong></p> <p>(optional, boolean) Whether to include <code>__type</code> field. Defaults to true.</p> <hr> <h3 id=request-tracker_1>Request Tracker <div id=intelmq.bots.outputs.rt.output /></h3> <p>Output Bot that creates Request Tracker tickets from events.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.rt.output</code></p> <p><strong>Description</strong></p> <p>The bot creates tickets in Request Tracker and uses event fields for the ticket body text. The bot follows the workflow of the RTIR:</p> <ul> <li>create ticket in Incidents queue (or any other queue)</li> <li>all event fields are included in the ticket body,</li> <li>event attributes are assigned to tickets' CFs according to the attribute mapping,</li> <li>ticket taxonomy can be assigned according to the CF mapping. If you use taxonomy different from <a href=https://github.com/enisaeu/Reference-Security-Incident-Taxonomy-Task-Force>ENISA RSIT</a>, consider using some extra attribute field and do value mapping with modify or sieve bot,</li> <li>create linked ticket in Investigations queue, if these conditions are met</li> <li>if first ticket destination was Incidents queue,</li> <li>if there is source.abuse_contact is specified,</li> <li>if description text is specified in the field appointed by configuration,</li> <li>RT/RTIR supposed to do relevant notifications by script working on condition "On Create",</li> <li>configuration option investigation_fields specifies which event fields has to be included in the investigation,</li> <li>Resolve Incident ticket, according to configuration (Investigation ticket status should depend on RT script configuration),</li> </ul> <p>Take extra caution not to flood your ticketing system with enormous amount of tickets. Add extra filtering for that to pass only critical events to the RT, and/or deduplicating events.</p> <p><strong>Parameters:</strong></p> <p><strong><code>rt_uri</code></strong></p> <p>()</p> <p><strong><code>rt_user</code></strong></p> <p>()</p> <p><strong><code>rt_password</code></strong></p> <p>()</p> <p><strong><code>verify_cert</code></strong></p> <p>() RT API endpoint connection details, string.</p> <p><strong><code>queue</code></strong></p> <p>() ticket destination queue. If set to 'Incidents', 'Investigations' ticket will be created if create_investigation is set to true, string.</p> <p><strong><code>CF_mapping</code></strong></p> <p>(optional, object) Mapping event fields to ticket CFs. Defaults to:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-87-1 name=__codelineno-87-1 href=#__codelineno-87-1></a><span class=nt>classification.taxonomy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Classification</span>
<a id=__codelineno-87-2 name=__codelineno-87-2 href=#__codelineno-87-2></a><span class=nt>classification.type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Incident Type</span>
<a id=__codelineno-87-3 name=__codelineno-87-3 href=#__codelineno-87-3></a><span class=nt>event_description.text</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Description</span>
<a id=__codelineno-87-4 name=__codelineno-87-4 href=#__codelineno-87-4></a><span class=nt>extra.incident.importance</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Importance</span>
<a id=__codelineno-87-5 name=__codelineno-87-5 href=#__codelineno-87-5></a><span class=nt>extra.incident.severity</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Incident Severity</span>
<a id=__codelineno-87-6 name=__codelineno-87-6 href=#__codelineno-87-6></a><span class=nt>extra.organization.name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Customer</span>
<a id=__codelineno-87-7 name=__codelineno-87-7 href=#__codelineno-87-7></a><span class=nt>source.ip</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">IP</span>
</code></pre></div> <p><strong><code>final_status</code></strong></p> <p>(optional, string) The final status for the created ticket. Defaults to resolved. The linked Investigation ticket will be resolved automatically by RTIR scripts.</p> <p><strong><code>create_investigation</code></strong></p> <p>(optional, boolean) Whether an Investigation ticket should be created (in case of RTIR workflow). Defaults to false.</p> <p><strong><code>investigation_fields</code></strong></p> <p>(optional, string) Comma-separated string of attributes to include in an Investigation ticket. Defaults to <code>time.source,source.ip,source.port,source.fqdn,source.url,classification.taxonomy,classification.type,classification.identifier,event_description.url,event_description.text,malware.name,protocol.application,protocol.transport</code>.</p> <p><strong><code>description_attr</code></strong></p> <p>(optional, string) Event field to be used as a text message being sent to the recipient. If it is not specified or not found in the event, the Investigation ticket is not going to be created. Defaults to <code>event_decription.text</code>.</p> <hr> <h3 id=rest-api>REST API <div id=intelmq.bots.outputs.restapi.output /></h3> <p>REST API is the bot responsible to send events to a REST API listener through POST.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.restapi.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>host</code></strong></p> <p>(required, host) Destination URL of the POST request.</p> <p><strong><code>auth_type</code></strong></p> <p>(required, string) Allowed values: <code>http_basic_auth</code> or <code>http_header</code>. Type of authentication to use.</p> <p><strong><code>auth_token</code></strong></p> <p>(required, string) Username or HTTP header key.</p> <p><strong><code>auth_token_name</code></strong></p> <p>(required, string) Password or HTTP header value.</p> <p><strong><code>hierarchical_output</code></strong></p> <p>(optional, boolean) Whether the resulting dictionary should be hierarchical (field names split by a dot). Defaults to false.</p> <p><strong><code>use_json</code></strong></p> <p>(optional, boolean) Whether to use JSON. Defaults to true.</p> <hr> <h3 id=rpz-file>RPZ File <div id=intelmq.bots.outputs.rpz_file.output /></h3> <p>This bot outputs events into DNS RPZ blocklist file used for "DNS firewall".</p> <p>The prime motivation for creating this feature was to protect users from badness on the Internet related to known-malicious global identifiers such as host names, domain names, IP addresses, or nameservers. More information: <a href=https://dnsrpz.info>https://dnsrpz.info</a></p> <p>Example: <div class=highlight><pre><span></span><code><a id=__codelineno-88-1 name=__codelineno-88-1 href=#__codelineno-88-1></a>$TTL 3600 @ SOA rpz.yourdomain.eu. hostmaster.rpz.yourdomain.eu. 2105260601 60 60 432000 60 NS localhost. ; ;
<a id=__codelineno-88-2 name=__codelineno-88-2 href=#__codelineno-88-2></a>yourdomain.eu. CERT.XX Response Policy Zones (RPZ) ; Last updated: 2021-05-26 06:01:41 (UTC) ; ; Terms Of
<a id=__codelineno-88-3 name=__codelineno-88-3 href=#__codelineno-88-3></a>Use: https://rpz.yourdomain.eu ; For questions please contact rpz [at] yourdomain.eu ; *.maliciousdomain.com CNAME
<a id=__codelineno-88-4 name=__codelineno-88-4 href=#__codelineno-88-4></a>rpz.yourdomain.eu. *.secondmaliciousdomain.com CNAME rpz.yourdomain.eu.
</code></pre></div></p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.rpz_file.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>cname</code></strong></p> <p>(optional, string) example rpz.yourdomain.eu</p> <p><strong><code>organization_name</code></strong></p> <p>(optional, string) Your organisation name</p> <p><strong><code>rpz_domain</code></strong></p> <p>(optional, string) Information website about RPZ</p> <p><strong><code>hostmaster_rpz_domain</code></strong></p> <p>() Technical website</p> <p><strong><code>rpz_email</code></strong></p> <p>() Contact email</p> <p><strong><code>ttl</code></strong></p> <p>() Time to live</p> <p><strong><code>ncachttl</code></strong></p> <p>() DNS negative cache</p> <p><strong><code>serial</code></strong></p> <p>() Time stamp or another numbering</p> <p><strong><code>refresh</code></strong></p> <p>() Refresh time</p> <p><strong><code>retry</code></strong></p> <p>() Retry time</p> <p><strong><code>expire</code></strong></p> <p>() Expiration time</p> <p><strong><code>test_domain</code></strong></p> <p>() For test domain, it's added in first rpz file (after header)</p> <hr> <h3 id=smtp-batch>SMTP Batch <div id=intelmq.bots.outputs.smtp_batch.output /></h3> <p>Aggregate events by e-mail addresses in the <code>source.abuse_contact</code> field and batch send them at once as a zipped CSV file attachment in a GPG signed message.</p> <p>When the bot is run normally by IntelMQ, it just aggregates the events for later use into a custom Redis database. If run through CLI (by a cron or manually), it shows e-mail messages that are ready to be sent and let you send them to the tester's e-mail OR to abuse contact e-mails. E-mails are sent in a zipped CSV file, delimited by a comma, while keeping strings in double quotes. Note: The field "raw" gets base64 decoded if possible. Bytes <code>\n</code> and <code>\r</code> are replaced with "\n" and "\r" strings in order to guarantee best CSV files readability both in Microsoft Office and LibreOffice. (A multiline string may be stored in "raw" which completely confused Microsoft Excel.)</p> <p>Launch it like this: <div class=highlight><pre><span></span><code><a id=__codelineno-89-1 name=__codelineno-89-1 href=#__codelineno-89-1></a>&lt;/usr/local/bin executable&gt; &lt;bot-id&gt; --cli [--tester tester&#39;s email]
</code></pre></div> Example: <div class=highlight><pre><span></span><code><a id=__codelineno-90-1 name=__codelineno-90-1 href=#__codelineno-90-1></a>intelmq.bots.outputs.smtp_batch.output<span class=w> </span>smtp-batch-output<span class=w> </span>--cli<span class=w> </span>--tester<span class=w> </span>your-email@example.com
</code></pre></div></p> <p>CLI flags: <div class=highlight><pre><span></span><code><a id=__codelineno-91-1 name=__codelineno-91-1 href=#__codelineno-91-1></a>-h, --help            show this help message and exit
<a id=__codelineno-91-2 name=__codelineno-91-2 href=#__codelineno-91-2></a>--cli                 initiate CLI interface
<a id=__codelineno-91-3 name=__codelineno-91-3 href=#__codelineno-91-3></a>--tester TESTING_TO   tester&#39;s e-mail
<a id=__codelineno-91-4 name=__codelineno-91-4 href=#__codelineno-91-4></a>--ignore-older-than-days IGNORE_OLDER_THAN_DAYS
<a id=__codelineno-91-5 name=__codelineno-91-5 href=#__codelineno-91-5></a>                      1..n skip all events with time.observation older than 1..n day; 0 disabled (allow all)
<a id=__codelineno-91-6 name=__codelineno-91-6 href=#__codelineno-91-6></a>--gpg-key GPG_KEY     fingerprint of gpg key to be used
<a id=__codelineno-91-7 name=__codelineno-91-7 href=#__codelineno-91-7></a>--limit-results LIMIT_RESULTS
<a id=__codelineno-91-8 name=__codelineno-91-8 href=#__codelineno-91-8></a>                      Just send first N mails.
<a id=__codelineno-91-9 name=__codelineno-91-9 href=#__codelineno-91-9></a>--send                Sends now, without dialog.
</code></pre></div></p> <p>You can schedule the batch sending easily with a cron script, I.E. put this into <code>crontab -e</code> of the <code>intelmq</code> user:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-92-1 name=__codelineno-92-1 href=#__codelineno-92-1></a># Send the e-mails every day at 6 AM
<a id=__codelineno-92-2 name=__codelineno-92-2 href=#__codelineno-92-2></a>0 6 * * *  /usr/local/bin/intelmq.bots.outputs.smtp_batch.output smtp-batch-output-cz cli --ignore-older-than-days 4 --send &amp;&gt; /tmp/intelmq-send.log
</code></pre></div> <p><strong>Module:</strong> <code>intelmq.bots.outputs.smtp_batch.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>alternative_mails</code></strong></p> <p>(optional, string) Path to CSV in the form <code>original@email.com,alternative@email.com</code>. Needed when some of the recipients ask you to forward their e-mails to another address. Delimit multiple recipients by the semicolon. The field is internally parsed by <a href=https://github.com/CZ-NIC/envelope#recipients>Envelope</a> so pretty anything is allowed:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-93-1 name=__codelineno-93-1 href=#__codelineno-93-1></a>original@email.com,alternative@email.com
<a id=__codelineno-93-2 name=__codelineno-93-2 href=#__codelineno-93-2></a>original2@email.com,person1@email.com;person2@email.com
<a id=__codelineno-93-3 name=__codelineno-93-3 href=#__codelineno-93-3></a>original3@email.com, Mary &lt;person1@example.com&gt;; John &lt;person2@example.com&gt;
</code></pre></div> <p><strong><code>attachment_name</code></strong></p> <p>(optional, string) Attachment file name for the outgoing messages. May contain date formatting like this <code>%Y-%m-%d</code>. Example: "events_%Y-%m-%d" will appear as "events_2022-12-01.zip". Defaults to "intelmq_%Y-%m-%d".</p> <p><strong><code>bcc</code></strong></p> <p>(optional, array of strings) An array of e-mails to be put in the <code>Bcc</code> field for every mail.</p> <p><strong><code>email_from</code></strong></p> <p>(required, string) Sender's e-mail of the outgoing messages.</p> <p><strong><code>gpg_key</code></strong></p> <p>(optional, string) The Key or the fingerprint of a GPG key stored in ~/.gnupg keyring folder.</p> <p><strong><code>gpg_pass</code></strong></p> <p>(optional, string) Password for the GPG key if needed.</p> <p><strong><code>mail_template</code></strong></p> <p>(required, string) Path to the file containing the body of the mail for the outgoing messages.</p> <p><strong><code>ignore_older_than_days</code></strong></p> <p>(optional, integer) Skips events with time.observation older than now-N. (If your queue gets stuck for a reason, you do not want to send old and probably already solved events.) Defaults to 0 (allow all).</p> <p><strong><code>limit_results</code></strong></p> <p>(optional, integer) Intended as a debugging option, allows loading just first N e-mails from the queue.</p> <p><strong><code>redis_cache_db</code></strong></p> <p>(required, integer) Redis database used for event aggregation. As the databases &lt; 10 are reserved for the IntelMQ core, recommended is a bigger number.</p> <p><strong><code>redis_cache_host</code></strong></p> <p>(required, string) Hostname of the Redis database.</p> <p><strong><code>redis_cache_port</code></strong></p> <p>(required, string) Port of the Redis database.</p> <p><strong><code>redis_cache_ttl</code></strong></p> <p>(required, integer) TTL in seconds used for caching. Recommended 1728000 for 20 days.</p> <p><strong><code>smtp_server</code></strong></p> <p>(required, string/array/object) SMTP server information and credentials. See <a href=https://github.com/CZ-NIC/envelope#sending>SMTP parameter</a> of the envelope module.</p> <p>Examples: <div class=highlight><pre><span></span><code><a id=__codelineno-94-1 name=__codelineno-94-1 href=#__codelineno-94-1></a><span class=nt>smtp_server</span><span class=p>:</span><span class=w> </span><span class=s>&quot;mailer&quot;</span>
<a id=__codelineno-94-2 name=__codelineno-94-2 href=#__codelineno-94-2></a><span class=nt>smtp_server</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{</span><span class=s>&quot;host&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class=s>&quot;mailer&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;port&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class=nv>587</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;user&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class=s>&quot;john&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;password&quot;</span><span class="p p-Indicator">:</span><span class=w> </span><span class=s>&quot;123&quot;</span><span class="p p-Indicator">}</span>
<a id=__codelineno-94-3 name=__codelineno-94-3 href=#__codelineno-94-3></a><span class=nt>smtp_server</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;mailer&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>587</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;john&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;password&quot;</span><span class="p p-Indicator">]</span>
</code></pre></div></p> <p><strong><code>subject</code></strong></p> <p>(required, string) Subject for the outgoing messages. May contain date formatting like this <code>%Y-%m-%d</code>. Example: "IntelMQ weekly warning (%d.%m.%Y)".</p> <p><strong><code>testing_to</code></strong></p> <p>(optional, string) Tester's e-mail.</p> <hr> <h3 id=smtp>SMTP <div id=intelmq.bots.outputs.smtp.output /></h3> <p>Sends a MIME Multipart message containing the text and the event as CSV for every single event.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.smtp.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>fieldnames</code></strong></p> <p>(optional, string/array of strings) Array of field names (or comma-separated list) to be included in the email. If empty, no attachment is sent - this can be useful if the actual data is already in the body (parameter <code>text</code>) or the <code>subject</code>.</p> <p><strong><code>mail_from</code></strong></p> <p>(optional, string) Sender's e-email address. Defaults to <code>cert@localhost</code>.</p> <p><strong><code>mail_to</code></strong></p> <p>(required, string) Comma-separated string of recipient email addresses. Supports formatting.</p> <p><strong><code>smtp_host</code></strong></p> <p>(optional, string) Hostname of the SMTP server. Defaults to <code>localhost</code>.</p> <p><strong><code>smtp_password</code></strong></p> <p>(optional, string) Password for authentication to your SMTP server. Defaults to <code>null</code>.</p> <p><strong><code>smtp_port</code></strong></p> <p>(optional, integer) Port of the SMTP server. Defaults to 25.</p> <p><strong><code>smtp_username</code></strong></p> <p>(optional, string) Username for authentication to your SMTP server. Defaults to <code>null</code>.</p> <p><strong><code>fail_on_errors</code></strong></p> <p>(optional, boolean) Whether any error should cause the bot to fail (raise an exception) or otherwise rollback. If false, the bot eventually waits and re-try (e.g. re-connect) etc. to solve the issue. If true, the bot raises an exception and - depending on the IntelMQ error handling configuration - stops. Defaults to false.</p> <p><strong><code>ssl</code></strong></p> <p>(optional, boolean) Defaults to false.</p> <p><strong><code>starttls</code></strong></p> <p>(optional, boolean) Defaults to true.</p> <p><strong><code>subject</code></strong></p> <p>(optional, string) Subject of the e-mail message. Supports formatting. Defaults to <code>Incident in your AS {ev[source.asn]}</code>.</p> <p><strong><code>text</code></strong></p> <p>(optional, string) Body of the e-mail message. Supports formatting. Defaults to <div class=highlight><pre><span></span><code><a id=__codelineno-95-1 name=__codelineno-95-1 href=#__codelineno-95-1></a>Dear network owner,
<a id=__codelineno-95-2 name=__codelineno-95-2 href=#__codelineno-95-2></a>
<a id=__codelineno-95-3 name=__codelineno-95-3 href=#__codelineno-95-3></a>We have been informed that the following device might have security problems.
<a id=__codelineno-95-4 name=__codelineno-95-4 href=#__codelineno-95-4></a>
<a id=__codelineno-95-5 name=__codelineno-95-5 href=#__codelineno-95-5></a>Your localhost CERT
</code></pre></div></p> <p>For several strings you can use values from the string using the <a href=https://docs.python.org/3/library/string.html#format-string-syntax>standard Python string format syntax</a>. Access the event's values with <code>{ev[source.ip]}</code> and similar. Any not existing fields will result in <code>None</code>. For example, to set the recipient(s) to the value given in the event's <code>source.abuse_contact</code> field, use this as <code>mail_to</code> parameter: <code>{ev[source.abuse_contact]}</code></p> <p>Authentication is optional. If both username and password are given, these mechanism are tried: CRAM-MD5, PLAIN, and LOGIN.</p> <p>Client certificates are not supported. If <code>http_verify_cert</code> is true, TLS certificates are checked.</p> <hr> <h3 id=sql>SQL <div id=intelmq.bots.outputs.sql.output /></h3> <p>SQL is the bot responsible to send events to a PostgreSQL, SQLite, or MSSQL Database.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>When activating autocommit, transactions are not used. See: <a href=http://initd.org/psycopg/docs/connection.html#connection.autocommit>http://initd.org/psycopg/docs/connection.html#connection.autocommit</a></p> </div> <p><strong>Module:</strong> <code>intelmq.bots.outputs.sql.output</code></p> <p><strong>Parameters:</strong></p> <p>The parameters marked with 'PostgreSQL' will be sent to libpq via psycopg2. Check the <a href=https://www.postgresql.org/docs/current/static/images/libpq-connect.html#LIBPQ-PARAMKEYWORDS>libpq parameter documentation</a> for the versions you are using.</p> <p><strong><code>autocommit</code></strong></p> <p>(optional, boolean) <a href=http://initd.org/psycopg/docs/connection.html?#connection.autocommit>Psycopg's autocommit mode</a>. Defaults to true.</p> <p><strong><code>engine</code></strong></p> <p>(required, string) Allowed values are <code>postgresql</code>, <code>sqlite</code>, or <code>mssql</code>.</p> <p><strong><code>database</code></strong></p> <p>(optional, string) Database name or SQLite database file. Defaults to intelmq-events.</p> <p><strong><code>host</code></strong></p> <p>(optional, string) Hostname of the database server. Defaults to localhost.</p> <p><strong><code>jsondict_as_string</code></strong></p> <p>(optional, boolean) Whether to save JSON fields as JSON string. Defaults to true.</p> <p><strong><code>message_jsondict_as_string</code></strong></p> <p>(optional, boolean) Whether to save JSON fields as JSON string. Defaults to true.</p> <p><strong><code>port</code></strong></p> <p>(optional, integer) Port of the database server. Defaults to 5432.</p> <p><strong><code>user</code></strong></p> <p>(optional, string) Username for connecting to the database system. Defaults to intelmq.</p> <p><strong><code>password</code></strong></p> <p>(optional, string) Password for connecting to the database system. Defaults to null.</p> <p><strong><code>sslmode</code></strong></p> <p>(optional, string) Database sslmode, Allowed values: <code>disable</code>, <code>allow</code>, <code>prefer</code>, <code>require</code>, <code>verify-ca</code> or <code>verify-full</code>. See: <a href=https://www.postgresql.org/docs/current/static/images/libpq-connect.html#libpq-connect-sslmode>https://www.postgresql.org/docs/current/static/images/libpq-connect.html#libpq-connect-sslmode</a>. Defaults to <code>require</code>.</p> <p><strong><code>table</code></strong></p> <p>(optional, string) Name of the database table to use. Defaults to events.</p> <p><strong><code>fields</code></strong></p> <p>(optional, array) Array of event fields to output to the database. Defaults to null (use all fields).</p> <p><strong><code>reconnect_delay</code></strong></p> <p>(optional, integer) Number of seconds to wait before reconnecting in case of an error. Defaults to 0.</p> <p><strong><code>fail_on_errors</code></strong></p> <p>(optional, boolean) Whether an error should cause the bot to fail (raise an exception) or otherwise rollback. If false, the bot eventually waits and re-try (e.g. re-connect) etc. to solve the issue. If true, the bot raises an exception and - depending on the IntelMQ error handling configuration - stops. Defaults to false.</p> <h3 id=stomp_1>STOMP</h3> <p>This bot pushes data to any STOMP stream. STOMP stands for Streaming Text Oriented Messaging Protocol. See: <a href=https://en.wikipedia.org/wiki/Streaming_Text_Oriented_Messaging_Protocol>https://en.wikipedia.org/wiki/Streaming_Text_Oriented_Messaging_Protocol</a></p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.stomp.output</code></p> <p><strong>Requirements</strong></p> <p>Install the <code>stomp.py</code> library from PyPI:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-96-1 name=__codelineno-96-1 href=#__codelineno-96-1></a>pip3<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>intelmq/bots/outputs/stomp/REQUIREMENTS.txt
</code></pre></div> <p>Alternatively, you may want to install it using your OS's native packaging tools, e.g.:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-97-1 name=__codelineno-97-1 href=#__codelineno-97-1></a>apt<span class=w> </span>install<span class=w> </span>python3-stomp
</code></pre></div> <p>Apart from that, depending on what STOMP server you connect to, you may need to obtain, from the organization or company owning the server, one or more of the following security/authentication-related resources:</p> <ul> <li>CA certificate file;</li> <li>either: <em>client certificate</em> and <em>client certificate's key</em> files, or: <em>username</em> (STOMP <em>login</em>) and <em>password</em> (STOMP <em>passcode</em>).</li> </ul> <p>Also, you will need to know an appropriate STOMP <em>destination</em> (aka <em>exchange point</em>), e.g. <code>/exchange/_push</code>.</p> <p><strong>Parameters:</strong></p> <p><strong><code>server</code></strong></p> <p>(optional, string) STOMP server's hostname or IP, e.g. "n6stream.cert.pl" or "127.0.0.1" (which is default)</p> <p><strong><code>port</code></strong></p> <p>(optional, integer) STOMP server's port number (default: 61614)</p> <p><strong><code>exchange</code></strong></p> <p>(optional, string) STOMP <em>destination</em> to push at, e.g. <code>"/exchange/_push"</code> (which is default)</p> <p><strong><code>heartbeat</code></strong></p> <p>(optional, integer) Defaults to 60000.</p> <p><strong><code>ssl_ca_certificate</code></strong></p> <p>(optional, string) path to CA file, or empty string to load system's default CA certificates</p> <p><strong><code>auth_by_ssl_client_certificate</code></strong></p> <p>(optional, boolean) default: true (note: false is needed for new <em>n6</em> auth)</p> <p><strong><code>ssl_client_certificate</code></strong></p> <p>(optional, string) Path to client certificate to use for TLS connections.</p> <p><strong><code>ssl_client_certificate_key</code></strong></p> <p>(optional, string) Path to client private key to use for TLS connections.</p> <p><strong><code>username</code></strong></p> <p>(optional, string) STOMP <em>login</em> (e.g., <em>n6</em> user login), used only if <code>auth_by_ssl_client_certificate</code> is false</p> <p><strong><code>password</code></strong></p> <p>(optional, string) STOMP <em>passcode</em> (e.g., <em>n6</em> user API key), used only if <code>auth_by_ssl_client_certificate</code> is false</p> <p><strong><code>message_hierarchical_output</code></strong></p> <p>(optional, boolean) Defaults to false.</p> <p><strong><code>message_jsondict_as_string</code></strong></p> <p>(optional, boolean) Defaults to false.</p> <p><strong><code>message_with_type</code></strong></p> <p>(optional, boolean) Defaults to false.</p> <p><strong><code>single_key</code></strong></p> <p>(optional, string) Output only a single specified key. In case of <code>raw</code> key the data is base64 decoded. Defaults to null (output the whole message).</p> <hr> <h3 id=tcp_1>TCP <div id=intelmq.bots.outputs.tcp.output /></h3> <p>TCP is the bot responsible to send events to a TCP port (Splunk, another IntelMQ, etc..).</p> <p>Multihreading is disabled for this bot.</p> <p><strong>Sending to an IntelMQ TCP collector</strong></p> <p>If you intend to link two IntelMQ instance via TCP, set the parameter <code>counterpart_is_intelmq</code> to true. The bot then awaits an "Ok" message to be received after each message is sent. The TCP collector just sends "Ok" after every message it gets.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.tcp.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>counterpart_is_intelmq</code></strong></p> <p>(optional, boolean) Whether the receiver is an IntelMQ TCP collector bot. Defaults to true.</p> <p><strong><code>ip</code></strong></p> <p>(required, string) Hostname of the destination server.</p> <p><strong><code>hierarchical_output</code></strong></p> <p>(optional, boolean) True for a nested JSON, false for a flat JSON (when sending to a TCP collector).</p> <p><strong><code>port</code></strong></p> <p>(required, integer) Port of destination server.</p> <p><strong><code>separator</code></strong></p> <p>(optional, string) Separator of messages, e.g. "n", optional. When sending to a TCP collector, parameter shouldn't be present. In that case, the output waits every message is acknowledged by "Ok" message the TCP collector bot implements.</p> <hr> <h3 id=templated-smtp>Templated SMTP <div id=intelmq.bots.outputs.templated_smtp.output /></h3> <p>Sends a MIME Multipart message built from an event and static text using Jinja2 templates.</p> <p>See the Jinja2 documentation at <a href=https://jinja.palletsprojects.com/ >https://jinja.palletsprojects.com/</a>.</p> <p>Authentication is attempted only if both username and password are specified.</p> <p>Templates are in Jinja2 format with the event provided in the variable <code>event</code>. E.g.:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-98-1 name=__codelineno-98-1 href=#__codelineno-98-1></a><span class=nt>mail_to</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>event[&#39;source.abuse_contact&#39;]</span><span class=nv> </span><span class=s>}}&quot;</span>
</code></pre></div> <p>As an extension to the Jinja2 environment, the function <code>from_json</code> is available for parsing JSON strings into Python structures. This is useful if you want to handle complicated structures in the <code>output</code> field of an event. In that case, you would start your template with a line like:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-99-1 name=__codelineno-99-1 href=#__codelineno-99-1></a>{%- set output = from_json(event[&#39;output&#39;]) %}
</code></pre></div> <p>and can then use <code>output</code> as a regular Python object in the rest of the template.</p> <p>Attachments are templated strings, especially useful for sending structured data. E.g. to send a JSON document including <code>malware.name</code> and all other fields starting with <code>source.</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-100-1 name=__codelineno-100-1 href=#__codelineno-100-1></a><span class=nt>attachments</span><span class=p>:</span>
<a id=__codelineno-100-2 name=__codelineno-100-2 href=#__codelineno-100-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>content-type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">application/json</span>
<a id=__codelineno-100-3 name=__codelineno-100-3 href=#__codelineno-100-3></a><span class=w>    </span><span class=nt>text</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
<a id=__codelineno-100-4 name=__codelineno-100-4 href=#__codelineno-100-4></a><span class=w>      </span><span class=no>{</span>
<a id=__codelineno-100-5 name=__codelineno-100-5 href=#__codelineno-100-5></a><span class=w>        </span><span class=no>&quot;malware&quot;: &quot;{{ event[&#39;malware.name&#39;] }}&quot;,</span>
<a id=__codelineno-100-6 name=__codelineno-100-6 href=#__codelineno-100-6></a><span class=w>        </span><span class=no>{%- set comma = joiner(&quot;, &quot;) %}</span>
<a id=__codelineno-100-7 name=__codelineno-100-7 href=#__codelineno-100-7></a><span class=w>        </span><span class=no>{%- for key in event %}</span>
<a id=__codelineno-100-8 name=__codelineno-100-8 href=#__codelineno-100-8></a><span class=w>           </span><span class=no>{%- if key.startswith(&#39;source.&#39;) %}</span>
<a id=__codelineno-100-9 name=__codelineno-100-9 href=#__codelineno-100-9></a><span class=w>        </span><span class=no>{{ comma() }}&quot;{{ key }}&quot;: &quot;{{ event[key] }}&quot;</span>
<a id=__codelineno-100-10 name=__codelineno-100-10 href=#__codelineno-100-10></a><span class=w>           </span><span class=no>{%- endif %}</span>
<a id=__codelineno-100-11 name=__codelineno-100-11 href=#__codelineno-100-11></a><span class=w>        </span><span class=no>{%- endfor %}</span>
<a id=__codelineno-100-12 name=__codelineno-100-12 href=#__codelineno-100-12></a><span class=w>      </span><span class=no>}</span>
<a id=__codelineno-100-13 name=__codelineno-100-13 href=#__codelineno-100-13></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">report.json</span>
</code></pre></div> <p>You are responsible for making sure that the text produced by the template is valid according to the content-type.</p> <p>If you are migrating from the SMTP output bot that produced CSV format attachments, use the following configuration to produce a matching format:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-101-1 name=__codelineno-101-1 href=#__codelineno-101-1></a><span class=nt>attachments</span><span class=p>:</span>
<a id=__codelineno-101-2 name=__codelineno-101-2 href=#__codelineno-101-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>content-type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">text/csv</span>
<a id=__codelineno-101-3 name=__codelineno-101-3 href=#__codelineno-101-3></a><span class=w>    </span><span class=nt>text</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
<a id=__codelineno-101-4 name=__codelineno-101-4 href=#__codelineno-101-4></a><span class=w>      </span><span class=no>{%- set fields = [&quot;classification.taxonomy&quot;, &quot;classification.type&quot;, &quot;classification.identifier&quot;, &quot;source.ip&quot;,&quot;source.asn&quot;, &quot;source.port&quot;] %}</span>
<a id=__codelineno-101-5 name=__codelineno-101-5 href=#__codelineno-101-5></a><span class=w>      </span><span class=no>{%- set sep = joiner(&quot;;&quot;) %}</span>
<a id=__codelineno-101-6 name=__codelineno-101-6 href=#__codelineno-101-6></a><span class=w>      </span><span class=no>{%- for field in fields %}{{ sep() }}{{ field }}{%- endfor %}</span>
<a id=__codelineno-101-7 name=__codelineno-101-7 href=#__codelineno-101-7></a><span class=w>      </span><span class=no>{% set sep = joiner(&quot;;&quot;) %}</span>
<a id=__codelineno-101-8 name=__codelineno-101-8 href=#__codelineno-101-8></a><span class=w>      </span><span class=no>{%- for field in fields %}{{ sep() }}{{ event[field] }}{%- endfor %}</span>
<a id=__codelineno-101-9 name=__codelineno-101-9 href=#__codelineno-101-9></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">event.csv</span>
</code></pre></div> <p><strong>Module:</strong> <code>intelmq.bots.outputs.templated_smtp.output</code></p> <p><strong>Requirements</strong></p> <p>Install the required <code>jinja2</code> library:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-102-1 name=__codelineno-102-1 href=#__codelineno-102-1></a>pip3<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>intelmq/bots/collectors/templated_smtp/REQUIREMENTS.txt
</code></pre></div> <p><strong>Parameters:</strong></p> <p><strong><code>attachments</code></strong></p> <p>(required, array of objects) Each object must have <code>content-type</code>, <code>text</code> (attachment text) and <code>name</code> (filename of the attachment) fields.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-103-1 name=__codelineno-103-1 href=#__codelineno-103-1></a><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>content-type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">simple string/jinja template</span>
<a id=__codelineno-103-2 name=__codelineno-103-2 href=#__codelineno-103-2></a><span class=w>  </span><span class=nt>text</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">simple string/jinja template</span>
<a id=__codelineno-103-3 name=__codelineno-103-3 href=#__codelineno-103-3></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">simple string/jinja template</span>
</code></pre></div> <p><strong><code>body</code></strong></p> <p>(optional, string) Simple string or Jinja template. The default body template prints every field in the event except <code>raw</code>, in undefined order, one field per line, as "field: value".</p> <p><strong><code>mail_from</code></strong></p> <p>(optional, string) Simple string or Jinja template. Sender's address.</p> <p><strong><code>mail_to</code></strong></p> <p>(required, string) Simple string or Jinja template. Comma-separated array of recipient addresses.</p> <p><strong><code>smtp_host</code></strong></p> <p>(optional, string) Hostname of the SMTP server. Defaults to localhost.</p> <p><strong><code>smtp_password</code></strong></p> <p>(optional, string) Password (if any) for authenticated SMTP. Defaults to null.</p> <p><strong><code>smtp_port</code></strong></p> <p>(optional, integer) TCP port to connect to. Defaults to 25.</p> <p><strong><code>smtp_username</code></strong></p> <p>(optional, string) Username (if any) for authenticated SMTP. Defaults to null.</p> <p><strong><code>tls</code></strong></p> <p>(optional, boolean) Whether to use use SMTPS. When true, also set smtp_port to the SMTPS port. Defaults to false.</p> <p><strong><code>starttls</code></strong></p> <p>(optional, boolean) Whether to use opportunistic STARTTLS over SMTP. Defaults to true.</p> <p><strong><code>subject</code></strong></p> <p>(optional, string) Simple string or Jinja template. E-mail subject line. Defaults to "IntelMQ event".</p> <p><strong><code>verify_cert</code></strong></p> <p>(optional, boolean) Whether to verify the server certificate in STARTTLS or SMTPS. Defaults to true.</p> <hr> <h3 id=touch>Touch <div id=intelmq.bots.outputs.touch.output /></h3> <p>Touches a file for every event received. Does not output the event!</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.touch.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>path</code></strong></p> <p>(optional, string) Path to the file to touch.</p> <hr> <h3 id=udp>UDP <div id=intelmq.bots.outputs.udp.output /></h3> <p>Output Bot that sends events to a remote UDP server.</p> <p>Multihreading is disabled for this bot.</p> <p><strong>Module:</strong> <code>intelmq.bots.outputs.udp.output</code></p> <p><strong>Parameters:</strong></p> <p><strong><code>format</code></strong></p> <p>(optional, string) Allowed values: <code>json</code> or <code>delimited</code>. The JSON format outputs the event 'as-is'. Delimited will deconstruct the event and print each field:value separated by the field delimit. See examples below.</p> <p><strong><code>field_delimiter</code></strong></p> <p>(optional, string) If the <code>format</code> is <code>delimited</code> then this parameter is used as a delimiter between fields. Defaults to <code>|</code>.</p> <p><strong><code>header</code></strong></p> <p>(required, string) Header text to be sent in the UDP datagram.</p> <p><strong><code>keep_raw_field</code></strong></p> <p>(optional, boolean) Whether to keep <code>raw</code> field. Defaults to false.</p> <p><strong><code>udp_host</code></strong></p> <p>(optional, string) Hostname of the destination server.</p> <p><strong><code>udp_port</code></strong></p> <p>(required, integer) Port of the destination server.</p> <p><strong>Examples of usage</strong></p> <p>Consider the following event:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-104-1 name=__codelineno-104-1 href=#__codelineno-104-1></a><span class=p>{</span>
<a id=__codelineno-104-2 name=__codelineno-104-2 href=#__codelineno-104-2></a><span class=w>  </span><span class=nt>&quot;raw&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;MjAxNi8wNC8yNV8xMTozOSxzY2hpenppbm8ub21hcmF0aG9uLmNvbS9na0NDSnVUSE0vRFBlQ1pFay9XdFZOSERLbC1tWFllRk5Iai8sODUuMjUuMTYwLjExNCxzdGF0aWMtaXAtODUtMjUtMTYwLTExNC5pbmFkZHIuaXAtcG9vbC5jb20uLEFuZ2xlciBFSywtLDg5NzI=&quot;</span><span class=p>,</span>
<a id=__codelineno-104-3 name=__codelineno-104-3 href=#__codelineno-104-3></a><span class=w>  </span><span class=nt>&quot;source.asn&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>8972</span><span class=p>,</span>
<a id=__codelineno-104-4 name=__codelineno-104-4 href=#__codelineno-104-4></a><span class=w>  </span><span class=nt>&quot;source.ip&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;85.25.160.114&quot;</span><span class=p>,</span>
<a id=__codelineno-104-5 name=__codelineno-104-5 href=#__codelineno-104-5></a><span class=w>  </span><span class=nt>&quot;source.url&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;http://schizzino.omarathon.com/gkCCJuTHM/DPeCZEk/WtVNHDKl-mXYeFNHj/&quot;</span><span class=p>,</span>
<a id=__codelineno-104-6 name=__codelineno-104-6 href=#__codelineno-104-6></a><span class=w>  </span><span class=nt>&quot;source.reverse_dns&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;static-ip-85-25-160-114.inaddr.ip-pool.com&quot;</span><span class=p>,</span>
<a id=__codelineno-104-7 name=__codelineno-104-7 href=#__codelineno-104-7></a><span class=w>  </span><span class=nt>&quot;classification.type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;malware-distribution&quot;</span><span class=p>,</span>
<a id=__codelineno-104-8 name=__codelineno-104-8 href=#__codelineno-104-8></a><span class=w>  </span><span class=nt>&quot;event_description.text&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Angler EK&quot;</span><span class=p>,</span>
<a id=__codelineno-104-9 name=__codelineno-104-9 href=#__codelineno-104-9></a><span class=w>  </span><span class=nt>&quot;feed.url&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;http://www.malwaredomainlist.com/updatescsv.php&quot;</span><span class=p>,</span>
<a id=__codelineno-104-10 name=__codelineno-104-10 href=#__codelineno-104-10></a><span class=w>  </span><span class=nt>&quot;feed.name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Malware Domain List&quot;</span><span class=p>,</span>
<a id=__codelineno-104-11 name=__codelineno-104-11 href=#__codelineno-104-11></a><span class=w>  </span><span class=nt>&quot;feed.accuracy&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-104-12 name=__codelineno-104-12 href=#__codelineno-104-12></a><span class=w>  </span><span class=nt>&quot;time.observation&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2016-04-29T10:59:34+00:00&quot;</span><span class=p>,</span>
<a id=__codelineno-104-13 name=__codelineno-104-13 href=#__codelineno-104-13></a><span class=w>  </span><span class=nt>&quot;time.source&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2016-04-25T11:39:00+00:00&quot;</span>
<a id=__codelineno-104-14 name=__codelineno-104-14 href=#__codelineno-104-14></a><span class=p>}</span>
</code></pre></div> <p>With the following parameters:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-105-1 name=__codelineno-105-1 href=#__codelineno-105-1></a><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<a id=__codelineno-105-2 name=__codelineno-105-2 href=#__codelineno-105-2></a><span class=nt>header</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">header example</span>
<a id=__codelineno-105-3 name=__codelineno-105-3 href=#__codelineno-105-3></a><span class=nt>keep_raw_field</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id=__codelineno-105-4 name=__codelineno-105-4 href=#__codelineno-105-4></a><span class=nt>ip</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
<a id=__codelineno-105-5 name=__codelineno-105-5 href=#__codelineno-105-5></a><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">514</span>
</code></pre></div> <p>Resulting line in syslog:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-106-1 name=__codelineno-106-1 href=#__codelineno-106-1></a>Apr 29 11:01:29 header example {&quot;raw&quot;: &quot;MjAxNi8wNC8yNV8xMTozOSxzY2hpenppbm8ub21hcmF0aG9uLmNvbS9na0NDSnVUSE0vRFBlQ1pFay9XdFZOSERLbC1tWFllRk5Iai8sODUuMjUuMTYwLjExNCxzdGF0aWMtaXAtODUtMjUtMTYwLTExNC5pbmFkZHIuaXAtcG9vbC5jb20uLEFuZ2xlciBFSywtLDg5NzI=&quot;, &quot;source&quot;: {&quot;asn&quot;: 8972, &quot;ip&quot;: &quot;85.25.160.114&quot;, &quot;url&quot;: &quot;http://schizzino.omarathon.com/gkCCJuTHM/DPeCZEk/WtVNHDKl-mXYeFNHj/&quot;, &quot;reverse_dns&quot;: &quot;static-ip-85-25-160-114.inaddr.ip-pool.com&quot;}, &quot;classification&quot;: {&quot;type&quot;: &quot;malware-distribution&quot;}, &quot;event_description&quot;: {&quot;text&quot;: &quot;Angler EK&quot;}, &quot;feed&quot;: {&quot;url&quot;: &quot;http://www.malwaredomainlist.com/updatescsv.php&quot;, &quot;name&quot;: &quot;Malware Domain List&quot;, &quot;accuracy&quot;: 100.0}, &quot;time&quot;: {&quot;observation&quot;: &quot;2016-04-29T10:59:34+00:00&quot;, &quot;source&quot;: &quot;2016-04-25T11:39:00+00:00&quot;}}
</code></pre></div> <p>With the following Parameters:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-107-1 name=__codelineno-107-1 href=#__codelineno-107-1></a><span class=nt>field_delimiter</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
<a id=__codelineno-107-2 name=__codelineno-107-2 href=#__codelineno-107-2></a><span class=nt>format</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">delimited</span>
<a id=__codelineno-107-3 name=__codelineno-107-3 href=#__codelineno-107-3></a><span class=nt>header</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">IntelMQ-event</span>
<a id=__codelineno-107-4 name=__codelineno-107-4 href=#__codelineno-107-4></a><span class=nt>keep_raw_field</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id=__codelineno-107-5 name=__codelineno-107-5 href=#__codelineno-107-5></a><span class=nt>ip</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
<a id=__codelineno-107-6 name=__codelineno-107-6 href=#__codelineno-107-6></a><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">514</span>
</code></pre></div> <p>Resulting line in syslog:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-108-1 name=__codelineno-108-1 href=#__codelineno-108-1></a>Apr 29 11:17:47 localhost IntelMQ-event|source.ip: 85.25.160.114|time.source:2016-04-25T11:39:00+00:00|feed.url:http://www.malwaredomainlist.com/updatescsv.php|time.observation:2016-04-29T11:17:44+00:00|source.reverse_dns:static-ip-85-25-160-114.inaddr.ip-pool.com|feed.name:Malware Domain List|event_description.text:Angler EK|source.url:http://schizzino.omarathon.com/gkCCJuTHM/DPeCZEk/WtVNHDKl-mXYeFNHj/|source.asn:8972|classification.type:malware-distribution|feed.accuracy:100.0
</code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/certtools/intelmq target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://pypi.org/project/intelmq/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> </a> <a href=https://hub.docker.com/u/certat target=_blank rel=noopener title=hub.docker.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.copy", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.af256bd8.min.js></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>